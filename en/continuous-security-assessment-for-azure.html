<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Continuous Security Assessment for Azure</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="configure-microsoft-azure.html" title="Configure Microsoft Azure"></link><link rel="next" href="configure-azure-blob-storage-for-dlp-scanning-and-threat-protection.html" title="Configure Azure Blob Storage for DLP Scanning and Threat Protection"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script async="" src="https://www.googletagmanager.com/gtag/js?id=256425220"></script><script type="text/javascript">var propertyid = '256425220';

						window.dataLayer = window.dataLayer || [];
						function gtag(){dataLayer.push(arguments)};
						gtag('js', new Date());
						
						gtag('config', propertyid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link">Â <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="network-security.html">Network Security</a></li><li class="breadcrumb-link"><a href="netskope-public-cloud-security.html"><span class="phrase">Netskope Public Cloud Security</span></a></li><li class="breadcrumb-link"><a href="continuous-security-assessment-for-microsoft-azure.html">Continuous Security Assessment for Microsoft Azure</a></li><li class="breadcrumb-node">Continuous Security Assessment for Azure</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="configure-microsoft-azure.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="configure-azure-blob-storage-for-dlp-scanning-and-threat-protection.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-2e38c19d-601d-ef3e-9c90-13028e858d00" data-permalink="continuous-security-assessment-for-azure.html" data-topic-level="1" data-relative-prefix="" data-time-modified="February 10, 2021" data-publication-date="" id="UUID-1198ddb5-fdb1-f890-6bcf-c01d24df3d9a"><div class="titlepage"><div><div class="title"><h5 class="title">Continuous Security Assessment for Azure</h5></div></div></div><p>Netskope provides a security assessment framework which accesses and analyzes the posture of the Azure resources and alerts the administrator for risk and possible remediation.</p><div class="mediaobject image-left" style="text-align:left;"><img src="image/uuid-b9189027-154b-bed3-a181-001db371d7d9-en.png" style="" alt="Azure_SA_Block_Diagram.png"></img></div><p>Netskope continuously monitors your Azure environment so you have a picture of your cloud security posture. Netskope assesses your environment and measures against custom profiles and rules. Netskope securely audits your cloud services continuously so you can determine if there are any potentially exploitable misconfigurations. You have an easy way to monitor and report on the security of your IaaS ecosystem, run a report for auditors and be able to remediate and address gaps that are found.</p><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-be865aa8-d945-c9b5-cd5e-009cb1b91e92" data-time-modified="October 3, 2019" data-publication-date="" id="UUID-0db83ac9-e2da-4416-a8c8-0d2dcc8101c2"><div class="titlepage"><div><div class="title"><h6 class="title">CIS Benchmarks for Azure</h6></div></div></div><p>Center for Internet Security (CIS) is a nonprofit organization that identifies, develops, validates, promotes, and sustains best practice solutions for cyber defense and build and lead communities to enable an environment of trust in cyberspace.Â CIS BenchmarksÂ provide global standards for internet security and are a recognized global standard and best practices for securing IT systems and data against attacks. CIS Benchmarks consist of a set of rules for a subset of Azure with an emphasis on foundation, testable, and architecture agnostic settings. Specific Azure scope of this benchmark include:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Identity and Access Management (IAM)</p></li><li class="listitem"><p>Security Center</p></li><li class="listitem"><p>Storage Accounts</p></li><li class="listitem"><p>SQL Services</p></li><li class="listitem"><p>Logging and Monitoring</p></li><li class="listitem"><p>Networking</p></li><li class="listitem"><p>Virtual Machines</p></li><li class="listitem"><p>Other Security Considerations</p></li></ul></div><p>Netskope assesses your Azure data center and measures against the above mentioned CIS Benchmarks.</p><p>The following page provides a complete list of PCI-DSS checks for Azure. Click,</p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-a8b68dce-72c4-738f-3643-e27b450a9d23" data-time-modified="October 3, 2019" data-publication-date="" id="UUID-a210266d-ad40-4077-f90e-0c3178490b9b"><div class="titlepage"><div><div class="title"><h6 class="title">Payment Card Industry Data Security Standard</h6></div></div></div><p>The Payment Card Industry Data Security Standard (PCI-DSS) was developed to encourage and enhance cardholder data security and facilitate the broad adoption of consistent data security measures globally. PCI-DSS provides a baseline of technical and operational requirements designed to protect account data. PCI-DSS applies to all entities involved in payment card processingâincluding merchants, processors, acquirers, issuers, and service providers. PCI-DSS also applies to all other entities that store, process or transmit cardholder data (CHD) and/or sensitive authentication data (SAD).</p><p><span class="phrase">Netskope Public Cloud Security</span> delivers an out of the box profile to verify configuration check for PCI-DSS 3.2.1 compliance. The out of the box rules in the profile can be used as is for PCI compliance assessment. Customers may also choose to customize these rules to tailor to theirÂ security objectives.</p><div dir="ltr" class="note" id="UUID-a210266d-ad40-4077-f90e-0c3178490b9b_note-idm43079314005668"><h3 class="title">Note</h3><p>The PCI-DSS 3.2.1 profile is supported for Microsoft Azure.</p></div><p>The following page provides a complete list of PCI-DSS checks for Azure. Click,</p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-f2efa66d-8cbe-450a-59e0-9a0060b5b928" data-time-modified="July 8, 2020" data-publication-date="" id="UUID-bab9eaad-6b4c-a2a9-8b17-588b5a8ca0cb"><div class="titlepage"><div><div class="title"><h6 class="title">Configure an Azure Subscription for Security Assessment</h6></div></div></div><p>To configure an Azure subscription for Security Assessment:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Configure an Azure Active Directory Application.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>You can configure multiple subscriptions for Security Assessment with the same Azure Active Directory Application.</p></div></li><li class="listitem"><p>Add the Azure Subscription in Netskope <span class="phrase">API-enabled Protection</span>.</p></li></ol></div><p>See the instructions below for more information.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>Netskope normalizesÂ the term "Account"Â to help with cross CSP summaries. Netskope normalized âAccountâ field maps to Azure Subscription.</p></div><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-d605fe6a-3b2a-6eeb-d9bb-432e2e0ddcc2" data-time-modified="February 10, 2021" data-publication-date="" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d"><div class="titlepage"><div><div class="title"><h6 class="title">Configure an Azure AD Application for CSA</h6></div></div></div><p>To configure Azure for Security Assessment, you must log in to the Azure portal as a subscription owner or global administrator and configure the following tasks:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><a class="xref" href="continuous-security-assessment-for-azure.html#UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc6bb1bb761d-idm45894348648896" title="Step-1: Create an Azure AD Application"><span class="xreftitle">Step-1: Create an Azure AD Application</span></a></p></li><li class="listitem"><p><a class="xref" href="continuous-security-assessment-for-azure.html#UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc6bb84836e8-idm45444644154800" title="Step-2: Get the Application ID and Directory ID"><span class="xreftitle">Step-2: Get the Application ID and Directory ID</span></a></p></li><li class="listitem"><p><a class="xref" href="continuous-security-assessment-for-azure.html#UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc6bc1c76681-idm46399448767440" title="Step-3: Get the Authentication Key"><span class="xreftitle">Step-3: Get the Authentication Key</span></a></p></li><li class="listitem"><p><a class="xref" href="continuous-security-assessment-for-azure.html#UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc6bc9b68ca2-idm45444644185600" title="Step-4: Assign a Role to the Azure AD Application"><span class="xreftitle">Step-4: Assign a Role to the Azure AD Application</span></a></p></li><li class="listitem"><p><a class="xref" href="continuous-security-assessment-for-azure.html#UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cf0a38ad29d5-idm45390834661792" title="Step-5: List AD Users (CSA only)"><span class="xreftitle">Step-5: List AD Users (CSA only)</span></a></p></li><li class="listitem"><p><a class="xref" href="continuous-security-assessment-for-azure.html#UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc12107bbfbb-idm45848591098416" title="Step-6: Assess Key Vault (CSA only)"><span class="xreftitle">Step-6: Assess Key Vault (CSA only)</span></a></p></li></ol></div><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc6bb1bb761d-idm45894348648896"><div class="titlepage"><div><div class="title"><h6 class="title">Step-1: Create an Azure AD Application</h6></div></div></div><p>To create an Azure AD application, follow the steps below:</p><div class="orderedlist" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_orderedlist-idm43113055913840"><ol class="orderedlist" type="1"><li class="listitem"><p>Log in to <a class="link" href="https://portal.azure.com" target="_blank" rel="noopener">portal.azure.com</a>.</p></li><li class="listitem"><p>Navigate to <span class="bold bold"><strong>All services &gt; Identity &gt; Azure Active Directory</strong></span>.</p></li><li class="listitem"><p>Click <span class="bold bold"><strong>App registrations</strong></span>.</p><div class="mediaobject"><img src="image/uuid-05da48c1-526c-3697-2b9a-ab7b2374612a-en.png" style="" alt="Azure-AD-App_App-Regis.png"></img></div></li><li class="listitem"><p>Click <span class="bold bold"><strong>+ New registration</strong></span> and enter the following details:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p><span class="bold bold"><strong>Name</strong></span>: Enter the name of the application.</p></li><li class="listitem"><p><span class="bold bold"><strong>Supported account types</strong></span>: Keep the default selection to <span class="bold bold"><strong>Accounts in this organizational directory only</strong></span>.</p></li><li class="listitem"><p><span class="bold bold"><strong>Redirect URL (optional)</strong></span>: Leave this blank.</p></li></ol></div><div class="mediaobject"><img src="image/uuid-b0217994-a448-5584-5bde-12068ced407c-en.png" style="" alt="Azure_Regis-App.png"></img></div></li><li class="listitem"><p>Click <span class="bold bold"><strong>Register</strong></span>.</p></li></ol></div><p id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_para-idm43113055985206">For additional information, refer to the Microsoft Azure documentation located <a class="link" href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app#register-a-new-application-using-the-azure-portal" target="_blank" rel="noopener">here</a>.</p></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc6bb84836e8-idm45444644154800"><div class="titlepage"><div><div class="title"><h6 class="title">Step-2: Get the Application ID and Directory ID</h6></div></div></div><p>After registering the Azure AD application, the page redirects you to the Azure AD application <span class="bold bold"><strong>Overview</strong></span> page. Note down the <span class="bold bold"><strong>Application (client) ID</strong></span> and <span class="bold bold"><strong>Directory (tenant) ID</strong></span>.</p><div class="mediaobject" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_mediaobject-idm43113056236606"><img src="image/uuid-8ed962c4-4920-d312-8457-bdb7391c56c1-en.png" style="" alt="Azure_App-ID_Dir-ID.png"></img></div><div dir="ltr" class="note" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_note-idm43113056290206"><h3 class="title">Note</h3><p>These values will be required when you set up the Azure application instance in the Netskope UI.</p></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc6bc1c76681-idm46399448767440"><div class="titlepage"><div><div class="title"><h6 class="title">Step-3: Get the Authentication Key</h6></div></div></div><p>To get the authentication key, follow the steps below:</p><div class="orderedlist" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_orderedlist-idm43113056422296"><ol class="orderedlist" type="1"><li class="listitem"><p>On the left navigation bar of the Azure AD application page, click <span class="bold bold"><strong>Certificates &amp; secrets</strong></span>.</p></li><li class="listitem"><p>Under <span class="bold bold"><strong>Client secrets</strong></span>, click <span class="bold bold"><strong>+ New client secret</strong></span> and enter the following details:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p><span class="bold bold"><strong>Description</strong></span>: Provide a description of the key.</p></li><li class="listitem"><p><span class="bold bold"><strong>Expires</strong></span>: Set a duration for the key.</p></li></ol></div></li><li class="listitem"><p>Click <span class="bold bold"><strong>Add</strong></span>.</p><div class="mediaobject"><img src="image/uuid-fee6d689-83ec-0442-a8f8-15e47f3b0263-en.png" style="" alt="Azure_Setup-Auth-Key.png"></img></div></li><li class="listitem"><p>After you save the configuration changes, under <span class="bold bold"><strong>Client secrets</strong></span>, the right-most column contains the authentication key.Â Copy the key value.</p><div class="mediaobject"><img src="image/uuid-0ef58e1d-8625-a958-bd8b-f7260a2e08d9-en.png" style="" alt="Azure_Copy-Key-Value.png"></img></div><div dir="ltr" class="important"><h3 class="title">Important</h3><p>Ensure that you copy the key valueÂ as it is not accessible once you leave this page. The key value will be required when you set up the Azure application instance in the Netskope UI.</p></div></li></ol></div><p id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_para-idm43113056535660">For additional information, refer to the Microsoft Azure documentation located <a class="link" href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-access-web-apis#add-credentials-to-your-web-application" target="_blank" rel="noopener">here</a>.</p></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc6bc9b68ca2-idm45444644185600"><div class="titlepage"><div><div class="title"><h6 class="title">Step-4: Assign a Role to the Azure AD Application</h6></div></div></div><p>To assign a role, follow the steps below:</p><div class="orderedlist" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_orderedlist-idm43113056654800"><ol class="orderedlist" type="1"><li class="listitem"><p>Log in to <a class="link" href="https://portal.azure.com" target="_blank" rel="noopener">portal.azure.com</a>.</p></li><li class="listitem"><p>Navigate to <span class="bold bold"><strong>All services &gt; General &gt; Subscriptions</strong></span>.</p><div class="mediaobject"><img src="image/uuid-b39af53e-da81-5022-d5e2-6bf93337fd23-en.png" style="" alt="Azure_All-serv_General_Subscrip.png"></img></div></li><li class="listitem"><p>On the <span class="bold bold"><strong>Subscriptions</strong></span> page, click the appropriate subscription from the list.</p></li><li class="listitem"><p>Click <span class="bold bold"><strong>+ Add &gt; Add role assignment</strong></span>.</p><div class="mediaobject"><img src="image/uuid-aea11a7b-5d2d-6a0c-3fd1-3e89dd8f4f78-en.png" style="" alt="Azure_Subscrip_Assign-Role.png"></img></div><p>To perform continuous security assessment of your Azure infrastructure, create a custom role with the following permissions.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Microsoft.Network/networkWatchers/queryFlowLogStatus/action - This permission gets the status of flow logging on a resource.</p></li><li class="listitem"><p>Microsoft.Web/sites/config/list/action - This permission lists web apps' security sensitive settings, such as publishing credentials, app settings and connection strings.</p></li></ul></div><div dir="ltr" class="important"><h3 class="title">Important</h3><p>If you are configuring a combination of features such as CSA, DLP, Threat Protection, and Forensics in a single instance, then you must create separate custom roles for each feature. For a combination of feature support, assign the roles based on the table below:</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><thead><tr><th class="th" data-priority="1"><p>Feature/Role</p></th><th class="th" data-priority="1"><p>Reader + Custom</p></th><th class="th" data-priority="1"><p>Inbuilt Contributor</p></th><th class="th" data-priority="1"><p>Storage Account Contributor</p></th></tr></thead><tbody><tr><td class="td"><p>DLP</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr><tr><td class="td"><p>Threat Protection</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr><tr><td class="td"><p>Security Assessment</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr><tr><td class="td"><p>Forensic</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td></tr><tr><td class="td"><p>DLP, Security Assessment</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr><tr><td class="td"><p>DLP, Forensic</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr><tr><td class="td"><p>Threat Protection, Security Assessment</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr><tr><td class="td"><p>Threat Protection, Forensic</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr><tr><td class="td"><p>Security Assessment, Forensic</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr><tr><td class="td"><p>DLP, Threat Protection, Security Assessment, Forensic</p></td><td class="td"><p>X</p></td><td class="td"><p>X</p></td><td class="td"></td></tr></tbody></table></div></div><p>To create a custom role,</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>Create a JSON file with the following script and save the file as <span class="emphasis"><em>NetskopeCSA.json</em></span>.</p><pre class="programlisting">{
  "Name": "Netskope CSA Custom Role",
  "IsCustom": true,
  "Description": "Netskope CSA",
  "Actions": ["Microsoft.Web/sites/config/list/action", "Microsoft.Network/networkWatchers/queryFlowLogStatus/action"],
  "NotActions": [],
  "DataActions": [],
  "NotDataActions": [],
  "AssignableScopes": ["/subscriptions/&lt;subscription-id&gt;"]
}</pre><p>To get the <span class="emphasis"><em>&lt;subscription-id&gt;</em></span>:</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p>Navigate to <span class="bold bold"><strong>All services &gt; General &gt; Subscriptions</strong></span>.</p></li><li class="listitem"><p>Copy the subscription ID and replace the <span class="emphasis"><em>&lt;subscription-id&gt;</em></span> parameter with the copied ID.</p></li></ol></div></li><li class="listitem"><p>Next, use the Azure PowerShell. Click the Cloud Shell icon on the top-center bar of the Azure portal page.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>The shell may prompt you to create and mount a storage account.</p></div></li><li class="listitem"><p>On the PowerShell top navigation, select the <span class="bold bold"><strong>Upload/Download files</strong></span> icon and then <span class="bold bold"><strong>Upload</strong></span>.</p><div class="mediaobject"><img src="image/uuid-8105af7f-e681-fcef-c6d4-b453384c1cec-en.png" style="" alt="Azure_PowerShell.png"></img></div></li><li class="listitem"><p>Upload the <span class="emphasis"><em>NetskopCSA.json</em></span> file. Then, on the PowerShell prompt, enter the following command:</p><pre class="programlisting">New-AzRoleDefinition -InputFile "NetskopeCSA.json"</pre><p>When you run this command, Azure creates a custom role <span class="emphasis"><em>Netskope CSA Custom Role</em></span> with the <span class="emphasis"><em>Microsoft.Network/networkWatchers/queryFlowLogStatus/action</em></span> and <span class="emphasis"><em>Microsoft.Web/sites/config/list/action</em></span> permissions.</p></li><li class="listitem"><p>Under <span class="bold bold"><strong>Roles</strong></span>, assign the <span class="emphasis"><em>Reader</em></span> and <span class="emphasis"><em>Netskope CSA Custom Role</em></span>.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>If you have multiple subscriptions, you can group them under a Management Group and assign the role at the Management Group.</p></div><div dir="ltr" class="note"><h3 class="title">Note</h3><p>As part of continuous security assessment, if you need Netskope to assess Key Vault, read <a class="link" href="continuous-security-assessment-for-azure.html#UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc12107bbfbb-idm45848591098416" title="Step-6: Assess Key Vault (CSA only)">this</a>.</p></div></li><li class="listitem"><p>Keep the <span class="bold bold"><strong>Assign access to</strong></span> <span class="emphasis"><em>Azure AD user, group, or service principal</em></span>.</p></li><li class="listitem"><p>Under <span class="bold bold"><strong>Select</strong></span>, search for the newly created Azure AD application and select it.</p><div class="mediaobject"><img src="image/uuid-dac62f86-3551-54d3-9613-b11ff31a15e1-en.png" style="" alt="Azure_Add-Role.png"></img></div></li><li class="listitem"><p>Under <span class="bold bold"><strong>Select</strong></span>, search for the newly created Azure AD application and select it.</p></li><li class="listitem"><p>Click <span class="bold bold"><strong>Save</strong></span>.</p></li></ol></div></li><li class="listitem"><p>Click <span class="bold bold"><strong>Access control (IAM)</strong></span>.</p></li></ol></div><p id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_para-idm43113056771110">For additional information, refer to the Microsoft Azure documentation located <a class="link" href="https://docs.microsoft.com/en-in/azure/active-directory/develop/howto-create-service-principal-portal#assign-the-application-to-a-role" target="_blank" rel="noopener">here</a>.</p></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cf0a38ad29d5-idm45390834661792"><div class="titlepage"><div><div class="title"><h6 class="title">Step-5: List AD Users (CSA only)</h6></div></div></div><div dir="ltr" class="note"><h3 class="title">Note</h3><p>This procedure applies to continuous security assessment only.</p></div><p>For Netskope to list the AD users, you should grant the <span class="emphasis"><em>Directory.Read.All</em></span> permission. To do so, follow the instructions below:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Navigate to <span class="bold bold"><strong>All services &gt; Identity &gt; Azure Active Directory</strong></span>.</p></li><li class="listitem"><p>Click <span class="bold bold"><strong>App registrations</strong></span>.</p><div class="mediaobject" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_mediaobject-idm43118550297602"><img src="image/uuid-05da48c1-526c-3697-2b9a-ab7b2374612a-en.png" style="" alt="Azure-AD-App_App-Regis.png"></img></div></li><li class="listitem"><p>Locate the Azure AD application you created earlier and click it.</p></li><li class="listitem"><p>On the left navigation bar of the Azure AD application page, click <span class="bold bold"><strong>API permissions</strong></span>.</p></li><li class="listitem"><p>Under <span class="bold bold"><strong>API permissions</strong></span>, click <span class="bold bold"><strong>+ Add a permission</strong></span>.</p><div class="mediaobject"><img src="image/uuid-c9844344-9ea0-eed2-b187-5a0e1f5a2451-en.png" style="" alt="Azure_Add-API-Perm.png"></img></div></li><li class="listitem"><p>Under <span class="bold bold"><strong>Request API permissions,</strong></span> keep the <span class="bold bold"><strong>Microsoft APIs</strong></span> tab selected. Scroll down and under <span class="bold bold"><strong>Supported legacy APIs</strong></span>, select <span class="bold bold"><strong>Azure Active Directory Graph</strong></span>.</p><div class="mediaobject"><img src="image/uuid-cf56d66a-7b51-bc13-a7a8-28a3c00bedb5-en.png" style="" alt="Azure_AD-Graph-API.png"></img></div></li><li class="listitem"><p>Under <span class="bold bold"><strong>Azure Active Directory Graph</strong></span>, select <span class="bold bold"><strong>Application permissions</strong></span> and under <span class="bold bold"><strong>Directory</strong></span>, select <span class="bold bold"><strong>Directory.Read.All</strong></span> permission. Click <span class="bold bold"><strong>Add permissions</strong></span>.</p><div class="mediaobject"><img src="image/uuid-04fe4f87-85b7-9f6f-8900-9f9c2473c19e-en.png" style="" alt="Azure_Direc-Read-All.png"></img></div></li><li class="listitem"><p>On the <span class="bold bold"><strong>API permissions</strong></span> page, click <span class="bold bold"><strong>Grant admin consent for Default Directory</strong></span> and then click <span class="bold bold"><strong>Yes</strong></span>.</p><div class="mediaobject"><img src="image/uuid-13f3434b-602f-2cb3-b239-8ee2a43f9325-en.png" style="" alt="Azure_Grant-Admin-Cons.png"></img></div></li></ol></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cc12107bbfbb-idm45848591098416"><div class="titlepage"><div><div class="title"><h6 class="title">Step-6: Assess Key Vault (CSA only)</h6></div></div></div><div dir="ltr" class="note" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_note-idm43118562309842"><h3 class="title">Note</h3><p>This procedure applies to continuous security assessment only.</p></div><p>As part of continuous security assessment, if you need Netskope to assess Key Vault, follow the instructions below:</p><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d_section-5cf0b6894cf34-idm45390834923568"><div class="titlepage"><div><div class="title"><h6 class="title">Configure Access Policy on Key Vault</h6></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Navigate to <span class="bold bold"><strong>All services &gt; Security &gt; Key vaults</strong></span>.</p></li><li class="listitem"><p>For each key vault, do the following:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>Click on a key vault, navigate to <span class="bold bold"><strong>Access policies</strong></span>, and click <span class="bold bold"><strong>+ Add new</strong></span>.</p><div class="mediaobject"><img src="image/uuid-043e2a22-8819-6c9e-133a-28f0305cb118-en.png" style="" alt="Azure_Key-Vault-Access-Policy.png"></img></div></li><li class="listitem"><p>Under <span class="bold bold"><strong>Add access policy</strong></span>, enter the following:</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p><span class="bold bold"><strong>Select principal</strong></span>: Select the Azure AD application you created earlier.</p></li><li class="listitem"><p><span class="bold bold"><strong>Key permissions</strong></span>: Select <span class="bold bold"><strong>Key Management Operations &gt; List</strong></span>.</p></li><li class="listitem"><p><span class="bold bold"><strong>Secret permissions</strong></span>: Select <span class="bold bold"><strong>Secret Management Operations &gt; List</strong></span>.</p></li><li class="listitem"><p><span class="bold bold"><strong>Certificate permissions</strong></span>: Select <span class="bold bold"><strong>Certificate Management Permissions &gt; List</strong></span>.</p></li><li class="listitem"><p>Click <span class="bold bold"><strong>OK</strong></span>.</p></li></ol></div><div class="mediaobject"><img src="image/uuid-944b34f2-c52c-7a7c-b6f5-2569cffb251c-en.png" style="" alt="Azure_Key-Vault-Add-Access-Policy.png"></img></div></li><li class="listitem"><p>On the <span class="bold bold"><strong>Access policies</strong></span> page, click <span class="bold bold"><strong>Save</strong></span>.</p><div class="mediaobject"><img src="image/uuid-509ea7e3-2da4-5026-9764-823054ae12e6-en.png" style="" alt="Azure_Key-Vault-Access-Policy-Save.png"></img></div></li></ol></div></li></ol></div></section></section></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-aebce72f-0182-4397-1f76-9f5d3ec3ad96" data-time-modified="December 9, 2020" data-publication-date="" id="UUID-6d5c8868-12b7-80e0-9844-a381274e09db"><div class="titlepage"><div><div class="title"><h6 class="title">Add the Azure Subscription in Netskope <span class="phrase">API-enabled Protection</span></h6></div></div></div><p>Once you have created an Azure Active Directory application and assigned the relevant permissions/roles, you can now create an Azure app instance in the Netskope UI.</p><p>To create an Azure instance:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Log in to the Netskope tenant UI.</p></li><li class="listitem"><p>Navigate to <span class="bold bold"><strong>Settings &gt; <span class="phrase">API-enabled Protection</span> &gt; Cloud Infrastructure &gt; Microsoft Azure &gt; SETUP</strong></span>.</p><p>The <span class="bold bold"><strong>New Setup</strong></span> window opens.</p></li><li class="listitem"><p>In the <span class="bold bold"><strong>New Setup</strong></span> window, enter the following parameters:Â </p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>In the <span class="bold bold"><strong>Azure Subscription</strong></span> section, enter the following details:</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p>Azure Subscription Name: Enter a unique name for the Azure subscription.</p></li><li class="listitem"><p>Admin Email: Enter the email address of the administrator for email notification.</p></li><li class="listitem"><p>In the <span class="bold bold"><strong>Connection Type</strong></span>, select the appropriate connection type:</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>Few of the instance type options may be disabled. Contact your Netskope sales representative for additional information.</p></div><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem"><p>DLP: Select this option to scan Azure Blob Storage against DLP policies. On selecting this option, you need to create an <span class="phrase">API-enabled Protection</span> policy.</p></li><li class="listitem"><p>Threat Protection: Select this option to scan Azure Blob Storage for malware.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>The Threat Protection feature is optional. Select this option if you intend to scan Blob storage for malware. You can view the malware alerts in <span class="bold bold"><strong>SkopeIT &gt; Alerts</strong></span> and <span class="bold bold"><strong>Incidents &gt; Malware</strong></span> pages.</p></div></li><li class="listitem"><p>Security Assessment: Select this option to periodically assess the configuration of the Azure services to monitor risks in your infrastructure. You have the option to run the policy at intervals (30 minutes, 60 minutes, 2 hours, 6 hours, and 24 hours). On selecting this option, you need toÂ create a security assessment policy.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>Netskope recommends setting the interval to 60 minutes or more.</p></div></li><li class="listitem"><p>Forensic: Select this option for Netskope to store forensic-related logs in Blob storage.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>Once you set up the instance with forensic enabled, you should create a forensic profile in <span class="bold bold"><strong>Policies &gt; Profiles &gt; Forensic</strong></span>. Then, enable forensics in <span class="bold bold"><strong>Settings &gt; Incident Management</strong></span>.</p></div></li></ol></div></li></ol></div></li><li class="listitem"><p>In the <span class="bold bold"><strong>Cloud Provider Information</strong></span> section, enter the following details:</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p>Directory ID: Enter the directory ID you noted from "Step-2: Get the Application ID and Directory ID" of configuring an Azure AD application.</p></li><li class="listitem"><p>Application ID: Enter the application ID you noted from "Step-2: Get the Application ID and Directory ID" of configuring an Azure AD application.</p></li><li class="listitem"><p>Client Key: Enter the authentication key you noted from "Step-3: Get the Authentication Key" of configuring an Azure AD application.</p></li></ol></div></li></ol></div></li><li class="listitem"><p>ClickÂ <span class="bold bold"><strong>Save</strong></span>, then click <span class="bold bold"><strong>Grant Access</strong></span>Â for the Azure instance you just created.</p></li></ol></div><p>Refresh your browser, and you should see a green check icon next to the instance name. You can proceed to create a policy based on the instance connection type selected:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Blob Storage Scanning (<span class="phrase">API-enabled Protection</span>): Navigate to the <span class="bold bold"><strong>Policies &gt; <span class="phrase">API-enabled Protection</span></strong></span> page to create an Azure Blob Storage policy.</p></li><li class="listitem"><p>Security Assessment: Navigate to the <span class="bold bold"><strong>Polices &gt; Security Assessment</strong></span> page to create a security assessment policy, profile, and rule.</p></li></ul></div><p>For Blob Storage Scanning (<span class="phrase">API-enabled Protection</span>), Netskope carries out DLP scans on your Blob storage. You can view the DLP alerts in the <span class="bold bold"><strong>SkopeIT &gt; Alerts</strong></span>Â and <span class="bold bold"><strong>Incident &gt; DLP</strong></span> pages.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>Azure Blob storage scanning does not have a dedicated <span class="phrase">API-enabled Protection</span> dashboard; administrators and select users receive email alerts specified in the policy, as well as SkopeIT alerts and through Incident Management.</p></div><p>For malware, you can view the alerts in the <span class="bold bold"><strong>SkopeIT &gt; Alerts</strong></span> and <span class="bold bold"><strong>Incidents &gt; Malware</strong></span> pages.</p><p>For Security Assessment, Netskope accesses and analyzes the posture of the Azure resources and alerts the administrator for risk and possible remediation. You can view the Azure dashboard page by navigating to the <span class="bold bold"><strong>Cloud Infrastructure</strong></span> page.</p></section></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-1198ddb5-fdb1-f890-6bcf-c01d24df3d9a">Continuous Security Assessment for Azure</a></li><li><a href="#UUID-0db83ac9-e2da-4416-a8c8-0d2dcc8101c2">CIS Benchmarks for Azure</a></li><li><a href="#UUID-a210266d-ad40-4077-f90e-0c3178490b9b">Payment Card Industry Data Security Standard</a></li><li><a href="#UUID-bab9eaad-6b4c-a2a9-8b17-588b5a8ca0cb">Configure an Azure Subscription for Security Assessment</a><ul class="nav"><li><a href="#UUID-4da8dc86-10c4-90ff-6573-cc8c36c2349d">Configure an Azure AD Application for CSA</a><ul class="nav"></ul></li><li><a href="#UUID-6d5c8868-12b7-80e0-9844-a381274e09db">Add the Azure Subscription in Netskope API-enabled Protection</a></li></ul></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Continuous%20Security%20Assessment%20for%20Azure%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Continuous%20Security%20Assessment%20for%20Azure%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="configure-microsoft-azure.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="configure-azure-blob-storage-for-dlp-scanning-and-threat-protection.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> Â© 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">February 10, 2021</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
