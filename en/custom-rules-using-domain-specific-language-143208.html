<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Custom Rules using Domain Specific Language</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="build-custom-rules-for-security-assessment.html" title="Build Custom Rules for Security Assessment"></link><link rel="next" href="custom-rules-using-domain-specific-language-143208.html#idp145322" title="Entity"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script async="" src="https://www.googletagmanager.com/gtag/js?id=256425220"></script><script type="text/javascript">var propertyid = '256425220';

						window.dataLayer = window.dataLayer || [];
						function gtag(){dataLayer.push(arguments)};
						gtag('js', new Date());
						
						gtag('config', propertyid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="network-security.html">Network Security</a></li><li class="breadcrumb-link"><a href="netskope-public-cloud-security.html"><span class="phrase">Netskope Public Cloud Security</span></a></li><li class="breadcrumb-link"><a href="build-custom-rules-for-security-assessment.html">Build Custom Rules for Security Assessment</a></li><li class="breadcrumb-node">Custom Rules using Domain Specific Language</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="build-custom-rules-for-security-assessment.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="custom-rules-using-domain-specific-language-143208.html#idp145322">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-1453087a-692f-16ab-a317-a61db2436a10" data-permalink="custom-rules-using-domain-specific-language-143208.html" data-topic-level="1" data-relative-prefix="" data-time-modified="February 10, 2021" data-publication-date="" id="UUID-11becb82-eb8c-c656-2bc9-ad23ae4fc4e8"><div class="titlepage"><div><div class="title"><h5 class="title">Custom Rules using Domain Specific Language</h5></div></div></div><p>The following syntax diagram represents the general rule to write a DSL statement.</p><div class="mediaobject"><img src="image/uuid-fe348a79-f46a-edfd-2141-003798902e77-en.png" style="" alt="rule_should_not.png"></img></div><p>Rule Format: <code class="code">&lt;entity&gt; [where &lt;condition&gt;] should [not] have &lt;condition&gt;</code></p><p>For example,</p><pre class="programlisting">S3Bucket should not have any ACL in (10.0.0.0)</pre><pre class="programlisting">IAMUser where Name eq “root” should have Password.Enabled eq true and MFAActive eq true</pre><div class="mediaobject"><img src="image/uuid-846d5ddd-3d63-d015-1c49-a76b95bd355b-en.gif" style="" alt="custom_rule_dsl.gif"></img></div><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="idp145322"><div class="titlepage"><div><div class="title"><h6 class="title">Entity</h6></div></div></div><p>An entity defines what the rule is checking against. It can be used alone or with a condition to further specify the entity.</p><div class="mediaobject"><img src="image/uuid-7c377467-9991-aa06-b430-a2ad96fe6743-en.png" style="" alt="entity.png"></img></div><p>Here are some examples of using an entity.</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><tbody><tr><td class="td"><p>&lt;entity&gt; should have &lt;condition&gt;</p></td><td class="td"><p><span class="bold bold"><strong>S3Bucket</strong></span> should have LoggingEnabled</p><p><span class="bold bold"><strong>AADuser</strong></span> should not have Type eq "Guest"</p></td></tr><tr><td class="td"><p>&lt;entity&gt; where &lt;condition&gt;</p><p>The "where" condition further defines the entity to narrow down the result.</p></td><td class="td"><p><span class="bold bold"><strong>IAMUser</strong></span> where Name eq “root” and MFAActive eq true</p><p><span class="bold bold"><strong>AWS</strong></span> where CloudTrails with [ MultiRegionTrailEnabled eq true ]</p></td></tr></tbody></table></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "></ul></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="idp145350"><div class="titlepage"><div><div class="title"><h6 class="title">Condition</h6></div></div></div><p>A condition is a standard that the rule uses to check against an entity to narrow down the result.</p><div class="informalfigure"><div class="mediaobject"><img src="image/uuid-81641158-f169-dca9-50d4-82fba8843c9d-en.png" style="" alt="condition.png"></img></div></div><p>The following table provides examples of using a condition. The formats in this table are applicable to all properties.</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><tbody><tr><td class="td"><p>&lt;property&gt;</p></td><td class="td"><p>AWS should have <span class="bold bold"><strong>CloudTrails</strong></span></p></td></tr><tr><td class="td"><p>&lt;property&gt; [func()] &lt;operator&gt; &lt;value&gt;</p></td><td class="td"><p>IAMUser should have <span class="bold bold"><strong>Name eq “root”</strong></span></p><p>IAMUser should have <span class="bold bold"><strong>Policies.Managed len() eq 0</strong></span></p></td></tr><tr><td class="td"><p>&lt;property&gt; with/contain &lt;condition&gt;</p></td><td class="td"><p>AWS should have <span class="bold bold"><strong>IAMUsers with [ Name eq “root” ]</strong></span></p></td></tr><tr><td class="td"><p>&lt;property&gt; in/notin (&lt;value1&gt;, &lt;value2&gt;, &lt;value3&gt;)</p></td><td class="td"><p>IAMUser should have <span class="bold bold"><strong>Name in ( “root”, “name2” )</strong></span></p></td></tr><tr><td class="td"><p>use quantifiers for list and sequence properties</p></td><td class="td"><p>IAMUser should have <span class="bold bold"><strong>atleast one Password eq “1234”</strong></span></p></td></tr><tr><td class="td"><p>use and, or, not, ( ) for complex conditions</p></td><td class="td"><p>IAMUser should have <span class="bold bold"><strong>(Name eq “root”) and (MFAActive eq true)</strong></span></p></td></tr></tbody></table></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-11becb82-eb8c-c656-2bc9-ad23ae4fc4e8_section-idm232040457271219"><div class="titlepage"><div><div class="title"><h6 class="title">Function</h6></div></div></div><p>Use functions in rules to find specific information about entities. Functions use the following syntax,</p><p><code class="code">&lt;entity&gt; &lt;function&gt;(&lt;argument&gt;)</code></p><p>For example,</p><p><code class="literal">S3Bucket should have Tags len ( ) gt 0</code></p><p><code class="literal">Protocol in ("-1", "tcp")</code></p><p>The following table provides a complete list of functions available to use in rules.</p><div class="informaltable table-responsive"><table class="informaltable table-bordered"><thead><tr><th class="th" data-priority="1"><p>Function</p></th><th class="th" data-priority="1"><p>Property Types</p></th><th class="th" data-priority="1"><p>Arguments</p></th><th class="th" data-priority="1"><p>Returns property type</p></th><th class="th" data-priority="1"><p>Description</p></th></tr></thead><tbody><tr><td class="td"><p>len</p></td><td class="td"><p>list, string</p></td><td class="td"><p><span class="emphasis"><em>none</em></span></p></td><td class="td"><p>number</p></td><td class="td"><p>Returns the length of string or list.</p></td></tr><tr><td class="td"><p>numhosts</p></td><td class="td"><p>ip</p></td><td class="td"><p><span class="emphasis"><em>none</em></span></p></td><td class="td"><p>number</p></td><td class="td"><p>Number of hosts in subnet.</p></td></tr><tr><td class="td"><p>isPrivate</p></td><td class="td"><p>ip</p></td><td class="td"><p><span class="emphasis"><em>none</em></span></p></td><td class="td"><p>boolean</p></td><td class="td"><p>Whether IP is private (IPy).</p></td></tr><tr><td class="td"><p>isPublic</p></td><td class="td"><p>ip</p></td><td class="td"><p><span class="emphasis"><em>none</em></span></p></td><td class="td"><p>boolean</p></td><td class="td"><p>Whether IP is public (IPy).</p></td></tr><tr><td class="td"><p>divisibleby</p></td><td class="td"><p>number</p></td><td class="td"><p>number</p></td><td class="td"><p>boolean</p></td><td class="td"><p>Whether LHS number is divisible by argument.</p></td></tr><tr><td class="td"><p>in, notin</p></td><td class="td"><p>string, boolean, ip, number</p></td><td class="td"><p>list</p></td><td class="td"><p>boolean</p></td><td class="td"><p>Whether LHS value is in list (shortcut for long OR).</p></td></tr><tr><td class="td"><p>has</p></td><td class="td"><p>list</p></td><td class="td"><p>list</p></td><td class="td"><p>boolean</p></td><td class="td"><p>Whether LHS list contains any one of the lists passed in as argument.</p></td></tr><tr><td class="td"><p>isLaterThan</p></td><td class="td"><p>number (date)</p></td><td class="td"><p>number, units</p></td><td class="td"><p>boolean</p></td><td class="td"><p>Whether LHS number (date) is later than current time +/- number units (arguments). For example, isLaterThan ( -1, "days") means LHS is later than 1 day ago (from scan time). Units must be one of the following: seconds|minutes|hours|days|weeks.</p><p>"days" is most common.</p></td></tr><tr><td class="td"><p>isEarlierThan</p></td><td class="td"><p>number (date)</p></td><td class="td"><p>number, units</p></td><td class="td"><p>boolean</p></td><td class="td"><p>Whether LHS number (date) is earlier than current time +/- number units (arguments). For example, Password.LastUsedTime isEarlierThan ( -90, "days")). Units must be one of the following: seconds|minutes|hours|days|weeks.</p><p>"days" is most common.</p></td></tr></tbody></table></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="idp145528"><div class="titlepage"><div><div class="title"><h6 class="title">Property</h6></div></div></div><p>Property is used to define the condition the rule is checking as well as to narrow down the entity the rule is checking against. Property can be nested using “.” such as, <code class="code">MFADevices.Virtual</code> where the rule checks for all the virtual devices.</p><p>The following is the syntax format.</p><p><code xml:lang="en" lang="en" dir="ltr" class="code">&lt;entity&gt; should [not] have &lt;property&gt;...</code></p><p><code xml:lang="en" lang="en" dir="ltr" class="code">&lt;entity&gt; where &lt;property&gt;...</code></p><p>The following table provides the list of property types and the functions they support.</p><div class="informaltable table-responsive"><table class="informaltable table-bordered"><thead><tr><th class="th" data-priority="1"><p>Property Type</p></th><th class="th" data-priority="1"><p>Operators and Functions</p></th><th class="th" data-priority="1"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p>list</p></td><td class="td"><p>in, notin, contain, with, len()</p></td><td class="td"><p>IAMUsers with [ Name eq “root” ]</p></td></tr><tr><td class="td"><p>sequence</p></td><td class="td"><p>in, notin</p></td><td class="td"><p>MFADevices in ( “ID1”, “ID2” )</p></td></tr><tr><td class="td"><p>string</p></td><td class="td"><p>eq, neq, like, not like, len()</p></td><td class="td"><p>Name eq “root”</p></td></tr><tr><td class="td"><p>number</p></td><td class="td"><p>eq (=), neq (!=), gt (&gt;), gte (&gt;=), lt (&lt;), lte (&lt;=)</p></td><td class="td"><p>Topic.Subscriptions len() &gt; 0</p></td></tr><tr><td class="td"><p>boolean</p></td><td class="td"><p>eq, neq</p></td><td class="td"><p>Password.Enabled eq true</p></td></tr><tr><td class="td"><p>ip</p></td><td class="td"><p>eq, neq</p></td><td class="td"><p>IPRanges with [ ip eq 0.0.0.0/0 ]</p></td></tr></tbody></table></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-11becb82-eb8c-c656-2bc9-ad23ae4fc4e8_section-5c17fe81d3d7c-idm45824927535024"><div class="titlepage"><div><div class="title"><h6 class="title">Compliance Rules</h6></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "></ul></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-11becb82-eb8c-c656-2bc9-ad23ae4fc4e8_section-idm232045414525009"><div class="titlepage"><div><div class="title"><h6 class="title">Common elements used to write a DSL rule</h6></div></div></div><p>The following elements are commonly used in a DSL rule.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">with</code> - To access the elements in any list.</p></li><li class="listitem"><p>"<span class="bold bold"><strong>.</strong></span>"</p></li><li class="listitem"><p><code class="literal">where</code> - To restrict evaluated assets.</p></li><li class="listitem"><p>Operators - Such as, eq, gte, gt, lt, lte, neq.</p></li><li class="listitem"><p>Functions - Such as, like, has, in, len, isEarlierThan, isLaterThan, len.</p></li><li class="listitem"><p>Numeric range syntax - For example, to check for port 137 and port 138, include the following in the syntax.</p><pre class="programlisting">FromPort lte 138 and ToPort gte 13</pre><div dir="ltr" class="note"><h3 class="title">Note</h3><p>Will match any security group or firewall ruleset that has a port range including 137, 138 or both.</p></div></li></ul></div></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-11becb82-eb8c-c656-2bc9-ad23ae4fc4e8">Custom Rules using Domain Specific Language</a></li><li><a href="#idp145322">Entity</a></li><li><a href="#idp145350">Condition</a></li><li><a href="#UUID-11becb82-eb8c-c656-2bc9-ad23ae4fc4e8_section-idm232040457271219">Function</a></li><li><a href="#idp145528">Property</a></li><li><a href="#UUID-11becb82-eb8c-c656-2bc9-ad23ae4fc4e8_section-5c17fe81d3d7c-idm45824927535024">Compliance Rules</a></li><li><a href="#UUID-11becb82-eb8c-c656-2bc9-ad23ae4fc4e8_section-idm232045414525009">Common elements used to write a DSL rule</a></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Custom%20Rules%20using%20Domain%20Specific%20Language%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Custom%20Rules%20using%20Domain%20Specific%20Language%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="build-custom-rules-for-security-assessment.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="custom-rules-using-domain-specific-language-143208.html#idp145322">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">February 10, 2021</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
