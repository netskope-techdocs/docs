<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>URL List Best Practices</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/jquery.paligocode.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="url-lists.html" title="URL Lists"></link><link rel="next" href="report-miscategorization.html" title="Report Miscategorization"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script type="text/javascript">var containerid = 'GTM-W56WJ8S';

						(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
						new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
						j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
						'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
						})(window,document,'script','dataLayer',containerid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="network-security.html">Network Security</a></li><li class="breadcrumb-link"><a href="real-time-protection.html"><span class="phrase">Real-time Protection</span></a></li><li class="breadcrumb-link"><a href="custom-category.html">Custom Category</a></li><li class="breadcrumb-node">URL List Best Practices</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="url-lists.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="report-miscategorization.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-12756954-dc1e-82e3-5b86-f0b1a7b48d9e" data-permalink="url-list-best-practices.html" data-topic-level="1" data-relative-prefix="" data-time-modified="September 3, 2021" data-publication-date="" id="UUID-649d53e9-8fe5-01cd-9d57-594f7e57cbb6"><div class="titlepage"><div><div class="title"><h5 class="title">URL List Best Practices</h5></div></div></div><p>The following sections describe the supported formats for the URL lists. <span class="phrase">Admins can specify list type (regex or exact) when calling the <a class="link" href="rest-api-v2-overview.html" title="REST API v2 Overview">Netskope REST API V2</a> to upload URL lists.</span></p><p><span class="bold bold"><strong>URL Supported Formats</strong></span></p><p>This section provides examples of syntax allowed in URL lists such as supported characters or spaces in URLs. In addition, validation using exact match or wildcard URLs. Specific error messages display for any validation failures.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Malformed URL (spaces, non-ASCII characters) are not allowed. URL containing non-ASCII characters must be properly percent-encoded ("%" followed by two hexadecimal digits).</p></li><li class="listitem"><p>Percent-encoding is not allowed in the host name. Punycode should be used instead.</p></li><li class="listitem"><p>TLD (*.gov) are allowed.</p></li><li class="listitem"><p>Error if more than one ‘*’ is present. If ‘*’ is present, it must be the first character. And it must be followed by ‘.’ (dot). This will allow matching all subdomains of a specified domain. Thus “*.google.com” is ok but “*google.com” or “www.google.*” are not.</p></li><li class="listitem"><p>We encourage users NOT to add scheme (http/https) to the URLs since they are ignored. </p></li><li class="listitem"><p>user:password@host is not supported</p></li><li class="listitem"><p>Empty/Blank lines are ignored</p></li><li class="listitem"><p>Lines beginning with comment characters ([#;]) are ignored.</p></li><li class="listitem"><p>Hostname: constructed only from letters, digits and dashes, cannot start or end with dash, percent encoding not allowed, puny code accepted</p></li><li class="listitem"><p>path, query and fragment: Any combination of unreserved ([a-z0-9-._~]), percent encoding (%[0-9a-f]{2} and delimiters ([!$&amp;amp;'()*+,;=]) allowed</p></li><li class="listitem"><p>*.foo.com does not automatically take foo.com as well. Include a separate entry for foo.com</p></li></ul></div><p><span class="bold bold"><strong>Valid URL Examples</strong></span></p><pre class="programlisting">    "# wildcard",
    "*.google.com",
    
    "# punycode",
    "xn--jp-cd2fp15c.xn--fsq.jp",
    
    "# percent encoded space",
    "www.apple.com/i%20mac",
    
    "https://onedrive.live.com/?authkey=%21AKD9vi-K9pXhFlw&amp;cid=F3CDA5103641D53D&amp;id=F3CDA5103641D53D%21157&amp;parId=F3CDA5103641D53D%21110&amp;o=OneUp",
</pre><p><span class="bold bold"><strong>Invalid URL Examples</strong></span></p><pre class="programlisting"># url with space
"www.domain with space.com/some/path",
"www.acme.com/path with space",
"www.acme.com/some/path/foo.bar?q=query with space",

# percent-encoding not allowed in domain; must use punycode
"www.domain%20with%20space.com/some/path",

# Invalid ip addresses
"http://0.0.0.0",
"http://1.2.3/some/path",
"http://1.1.1.1.1/foo/bar",
"http://123456789",

# invalid port
"WWW1.PYTHON2.ORG:65536/doc/#frag",
"www.example.net:foo",
"www.example.net:0",

# invalid wildard
"www.google.*",
"*google.com",

# empty host
"?param=1",

# username/password in host
"https://user:password@www.acme.com:8080/path/to/search?P1=foo&amp;P2=bar#Results"</pre><p><span class="bold bold"><strong>IP address ranges and CIDR Validation</strong></span></p><p>The following are considerations to make for IP/CIDR ranges and examples are provided.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>IP address range is specified as A.B.C.D-W.X.Y.Z. IP address with CIDR is specified as A.B.C.D/&lt;bits&gt;</p></li><li class="listitem"><p>Error is flagged if IP range is followed by other URL components such as path and query. If IP address/CIDR is followed by path/query, it will be interpreted as exact URL.</p></li><li class="listitem"><p>IP address cannot be 0.0.0.0. In an IP address range, start address must be less than end address. IP address in CIDR notation must have host portion zero.</p></li><li class="listitem"><p>Overlapping ranges are supported. If such ranges are associated with different categories, lookup of IP address in overlapping range would result in multiple categories. For example considering the following two ranges, a lookup of 192.186.1.2 would result in deriving “Category A” and “Category B”.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>192.186.1.1 - 192.168.1.4 (Category A)</p></li><li class="listitem"><p>192.186.1.1 - 192.168.1.20 (Category B)</p></li></ul></div></li></ul></div><p><span class="bold bold"><strong>Valid Ranges and CIDR Examples</strong></span></p><pre class="programlisting"># Range ok
192.168.1.10-192.168.1.20

# CIDR ok
192.168.1.0/24</pre><p><span class="bold bold"><strong>Invalid Ranges and CIDR Examples</strong></span></p><pre class="programlisting"># Invalid ip ranges and CIDR
"http://1.2.3.20-1.2.3.10
"http://1.2.3.10-1.2.3.20/some/path"
"http://1.2.3.4/24"</pre><p>The following is treated as an exact URL instead of IP address and CIDR because the URL path can start with a number.</p><p><code class="literal">"http://1.2.3.4/24/some/path"</code></p><p><span class="bold bold"><strong>Supported Regex</strong></span></p><p>The following are considerations to make for regex lists and in addition this section shows regex examples and supported formats.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Our allowed set is PCRE (without lookahead/lookbehind).</p></li><li class="listitem"><p>Schema (http/https) in the regex is not supported. For example “https://\.google.com” will not match incoming URL “travel.google.com”</p></li><li class="listitem"><p>URL path and query parameters are allowed in regex and are available for matching</p></li><li class="listitem"><p>Back-reference and capturing subexpressions are not supported</p></li><li class="listitem"><p>Literal characters and strings</p></li><li class="listitem"><p>Character classes such as . (dot), [abc], and [^abc], as well as the predefined character classes \s, \d, \w, \v, and \h and their negated counterparts (\S, \D, \W, \V, and \H).</p></li><li class="listitem"><p>Quantifiers:</p><p>Quantifiers such as ?, * and + are supported when applied to arbitrary supported sub-expressions.</p><p>Bounded repeat qualifiers such as {n}, {m,n}, {n,} are supported with limitations. For arbitrary repeated sub-patterns: n and m should be either small or infinite, e.g. (a|b){4}, (ab?c?d){4,10} or (ab(cd)*){6,}.</p></li><li class="listitem"><p>Parenthesization, including the named and unnamed capturing and non-capturing forms. However, capturing is ignored.</p></li><li class="listitem"><p>Alternation with the | symbol, as in foo|bar.</p></li><li class="listitem"><p>The anchors ^, $, \A, \Z and \z.</p></li><li class="listitem"><p>Option modifiers - These allow behavior to be switched on (with (?&lt;option&gt;)) and off (with (?-&lt;option&gt;)) for a sub-pattern.</p><p>The supported options are:</p><p>Case-insensitive matching</p><p>Multi-line matching</p><p>Interpret . as “any character”</p><p>Extended syntax, which will ignore most whitespace in the pattern</p><p>For example, the expression foo(?i)bar(?-i)baz will switch on case-insensitive matching <span class="emphasis"><em>only</em></span> for the bar portion of the match.</p></li></ul></div><p><span class="bold bold"><strong>Unsupported Regex</strong></span></p><p>The following regex constructs are not supported:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Backreferences and capturing sub-expressions</p></li><li class="listitem"><p>Backtracking control verbs such as (*SKIP) and (*PRUNE)</p></li><li class="listitem"><p>Subroutine references such as (?1) where 1 is the number of capturing group.</p></li><li class="listitem"><p>Recursive patterns (?R), (?0) etc</p></li></ul></div><p><span class="bold bold"><strong>Valid Regex Examples</strong></span></p><pre class="programlisting">"^client[0-9]\.google\.com"    # match client1.google.com, client2.google.com ...
"^app\.slack\.com/.*/netskope" # app.slack.com/foobar/netskope etc.
"^google.com"                  # match google.com
"^([^.]+\.)+google.com"        # match google.com subdomains
"^www.foobar.com/api?action=create" # Match specific query parameter and value
"^sgr[\d]{1,3}.apple.com"       # match sgr0.apple.com through sgr999.apple.com</pre><p><span class="bold bold"><strong>Invalid Regex Examples</strong></span></p><pre class="programlisting">"((foo|bar)"    # Missing close parenthesis for group started at index 0
"http://beginwith^[/]*/path"  #Embedded start anchors not supported </pre><div dir="ltr" class="tip"><h3 class="title">Tip</h3><p>Minimize the use of asterisks (*) in your regex because it can cause backtracking and impact the performance.</p></div><p><span class="bold bold"><strong>URL List Limits </strong></span></p><p>Currently, the total URL List limit per tenant across all URL lists is 300K. The URL List limit using Regex across all URL lists in that tenant is 1K (this 1K count includes only the regex written not the expanded format).</p><p>There is a per-upload limit of 8MB (file size) along with the above limit of URL and Regex count enforced for uploads through the Web UI and REST API V2. You can upload multiple files of 8MB size as long as the URL List count limit per tenant is not exceeded. </p><p><span class="bold bold"><strong>Validation Errors</strong></span></p><p>For any validation failures, a specific error message is returned. For example:</p><pre class="programlisting">"errors": [    
[      
"www.domain with space.com/some/path",      
"Invalid host"    
],    
[      
"www.acme.com/path with space",      
"Invalid Path"    
],</pre></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22URL%20List%20Best%20Practices%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22URL%20List%20Best%20Practices%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="url-lists.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="report-miscategorization.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">September 3, 2021</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div><!--Google Tag Manager (noscript)--><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W56WJ8S" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!--End Google Tag Manager (noscript)--></body></html>
