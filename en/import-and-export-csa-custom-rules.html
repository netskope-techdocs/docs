<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Import and Export CSA Custom Rules</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="evaluate-custom-rules.html" title="Evaluate Custom Rules"></link><link rel="next" href="start-a-csa-scan.html" title="Start a CSA Scan"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script type="text/javascript">var containerid = 'GTM-W56WJ8S';

						(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': 
						new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
						j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 
						'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); 
						})(window,document,'script','dataLayer',containerid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="network-security.html">Network Security</a></li><li class="breadcrumb-link"><a href="netskope-public-cloud-security.html"><span class="phrase">Netskope Public Cloud Security</span></a></li><li class="breadcrumb-link"><a href="public-cloud-rest-apis.html">Public Cloud REST APIs</a></li><li class="breadcrumb-link"><a href="public-cloud-api-endpoints.html">Public Cloud API Endpoints</a></li><li class="breadcrumb-node">Import and Export CSA Custom Rules</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="evaluate-custom-rules.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="start-a-csa-scan.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-37b0a460-80e0-3250-679c-e79aa58ce60e" data-permalink="import-and-export-csa-custom-rules.html" data-topic-level="1" data-relative-prefix="" data-time-modified="May 4, 2020" data-publication-date="" id="UUID-82eda397-113f-0eb0-0b16-04895853d41a"><div class="titlepage"><div><div class="title"><h6 class="title">Import and Export CSA Custom Rules</h6></div></div></div><p>Use this endpoint to manage the custom rules for CSA. Custom rules are the rules defined by domain specific language (DSL) specifications. This endpoint enables you to import and export your custom rules to and from the Netskope UI for use in profiles and policies. Whenever you change a rule, be sure to click <span class="bold bold"><strong>Apply Changes</strong></span> in the Netskope UI. You can import or export up to 500 custom rules in one API call.</p><h7 id="idm46244315424912" class="bridgehead">Request Endpoint</h7><pre class="programlisting">https://<span class="emphasis"><em>&lt;tenant-name&gt;</em></span>.goskope.com/api/v1/public_cloud/rules?token=<span class="emphasis"><em>&lt;token&gt;</em></span>&amp;<span class="emphasis"><em>&lt;parameters&gt;</em></span></pre><h7 id="UUID-82eda397-113f-0eb0-0b16-04895853d41a_bridgehead-idm4646117288982431655389605636" class="bridgehead">Import Custom Rules</h7><p>Valid parameters include:</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><colgroup><col style="width:25%;"></col><col style="width:10%;"></col><col style="width:25%;"></col><col style="width:40%;"></col></colgroup><thead><tr><th class="th" data-priority="1"><p>Key</p></th><th class="th" data-priority="1"><p>Type</p></th><th class="th" data-priority="1"><p>Value</p></th><th class="th" data-priority="1"><p>Description</p></th></tr></thead><tbody><tr><td class="td"><p><code class="literal">op</code></p></td><td class="td"><p>string</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">import</code></p></td><td class="td"><p>Operation performed.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">rules</code></p></td><td class="td"><p>JSON array of object</p></td><td class="td"><pre class="programlisting">{
"rule_name": "<span class="emphasis"><em>&lt;rule_name&gt;</em></span>",
"description": "<span class="emphasis"><em>&lt;description_optional&gt;</em></span>",
"remediation_steps": "<span class="emphasis"><em>&lt;remediation_optional&gt;</em></span>",
"severity": "&lt;Critical|High|Medium|Low&gt;",
"code": "<span class="emphasis"><em>&lt;code&gt;</em></span>",
"cloud_provider": "&lt;aws|googlecloud|azure&gt;"
}</pre></td><td class="td"><p>List of rules to import.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">cloud_provider</code></p></td><td class="td"><p>string</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">azure | aws | googlecloud</code></p></td><td class="td"><p>The IaaS platform provider.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">rule_name</code></p></td><td class="td"><p>string</p></td><td class="td"><p>Required</p></td><td class="td"><p>Name of the custom rule.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">description</code></p></td><td class="td"><p>string</p></td><td class="td"><p>Optional</p></td><td class="td"><p>Description of the custom rule.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">remediation_steps</code></p></td><td class="td"><p>string</p></td><td class="td"><p>Optional</p></td><td class="td"><p>Remediation text for the rule.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">severity</code></p></td><td class="td"><p>string</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">Critical | High | Low | Medium</code></p></td><td class="td"><p>Severity of the custom rule.</p></td></tr><tr><td class="td"><p><code class="literal">code</code></p></td><td class="td"><p>string</p></td><td class="td"><p>Ex: <code class="literal">RedShiftCluster should have LoggingEnabled eq true</code></p></td><td class="td"><p>DSL specification code.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">modify_by</code></p></td><td class="td"><p>string</p></td><td class="td"><p>Ex: <code class="literal">admin@netskope.com</code></p></td><td class="td"><p>Email address</p></td></tr></tbody></table></div><h7 id="UUID-82eda397-113f-0eb0-0b16-04895853d41a_bridgehead-idm4479625699472031655459159325" class="bridgehead">Example Import Request</h7><pre class="programlisting">POST 'https://<span class="emphasis"><em>&lt;tenant-name&gt;</em></span>.goskope.com/api/v1/public_cloud/rules?token=f39866cb86ab84a0208e9e1ee&amp;op=import' --header 'Content-Type: application/json' --data-raw '{
    "rules": [
        {
            "rule_name": "AWS_C3",
            "description": "",
            "remediation_steps": "",
            "severity": "High",
            "code": "RedShiftCluster should have LoggingEnabled eq true",
            "cloud_provider": "aws"
        },
        {
            "rule_name": "AWS_C4",
            "description": "",
            "remediation_steps": "",
            "severity": "High",
            "code": "RedShiftCluster should have LoggingEnabled eq true",
            "cloud_provider": "aws"
        }
    ],
    "modify_by": "admin@netskope.com"
}'</pre><h7 id="idm46244315390016" class="bridgehead">Export Custom Rules</h7><p>Valid parameters include:</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><colgroup><col style="width:25%;"></col><col style="width:10%;"></col><col style="width:25%;"></col><col style="width:40%;"></col></colgroup><thead><tr><th class="th" data-priority="1"><p>Key</p></th><th class="th" data-priority="1"><p>Type</p></th><th class="th" data-priority="1"><p>Value</p></th><th class="th" data-priority="1"><p>Description</p></th></tr></thead><tbody><tr><td class="td"><p><code class="literal">op</code></p></td><td class="td"><p>string</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">export</code></p></td><td class="td"><p>Operation performed.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">cloud_provider</code></p></td><td class="td"><p>string</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">azure | aws | googlecloud</code></p></td><td class="td"><p>The IaaS platform provider.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">severity</code></p></td><td class="td"><p>string</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">Critical | High | Low | Medium</code></p></td><td class="td"><p>Severity of the custom rule.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">state</code></p></td><td class="td"><p>string</p></td><td class="td"><p>Ex: <code class="literal">deployed</code></p></td><td class="td"><p>Filter with deployed rules.</p></td></tr></tbody></table></div><h7 id="UUID-82eda397-113f-0eb0-0b16-04895853d41a_bridgehead-idm464611736249603165546380536" class="bridgehead">Example Export Request</h7><pre class="programlisting">GET 'https://<span class="emphasis"><em>&lt;tenant-name&gt;</em></span>.goskope.com/api/v1/public_cloud/rules?token=f39866cb86ab84a0208e9e1ee&amp;op=export&amp;severity=Critical|High&amp;cloud_provider=aws'
</pre></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Import%20and%20Export%20CSA%20Custom%20Rules%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Import%20and%20Export%20CSA%20Custom%20Rules%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="evaluate-custom-rules.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="start-a-csa-scan.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">May 4, 2020</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div><!--Google Tag Manager (noscript)--><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W56WJ8S" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!--End Google Tag Manager (noscript)--></body></html>
