<html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!--
<script src="jquery-3.3.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="rules_styles.css"> 
-->
<style>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
*/
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}

/* Start Netskope styles */

h1 {font-size: 1.8em; font-family: Arial,sans-serif; margin: 1.2rem}
h2 {font-size: 1.6em; font-family: Arial,sans-serif; margin: 1.2rem}
body {font-family: Arial,sans-serif;}

table.rule_table {font-size: 90%}
td.code {font-family: monospace}
th {font-weight: bold; cursor: pointer; }
input { margin-left: 2px; margin-bottom: 5px; padding: 2px 3px; width: 300; }
.headerSortDown:after,
.headerSortUp:after{
    content: ' ';
    position: relative;
    left: 10px;
    border: 7px solid transparent;
}
.headerSortDown:after{
    top: 10px;
    border-top-color: silver;
}
.headerSortUp:after{
    bottom: 15px;
    border-bottom-color: silver;
}
.headerSortDown,
.headerSortUp{
    padding-left: 20px;
}

img[alt="Netskope"] {display:block; margin:1.2rem;}
.container {display: flex; flex-direction: row; padding: 1.5rem;}
._TAB{ display: inline-block; width: 0.4rem; height: 0.1rem; border-top: 0.5rem solid transparent; border-bottom: 0.5rem solid transparent; border-left: 0.5rem solid rgba(125,125,125,0.40); margin-left: 1.4rem; margin-right: 0.1rem;}
.rule_keys {display:inline-block; margin:0.4rem; margin-top:0; padding-right:0.5rem}
.rule_keys>.rule_category:first-child{margin-top:0;}
.rule_keys ul {list-style: none;}
.rule_keys li {cursor: pointer;}
.rule_keys li:hover {background-color: rgba(255,131,0,0.39); }

.rule_keys {position: fixed; top:135; width: 350px}
img {position: fixed; top: 0}
h1 {position: fixed; top: 75}

.rule_tables {flex:3 1 0px;display:inline-block;}
.rule_tables table, .rule_tables th, .rule_tables td { border: 1px solid rgba(150,150,100,0.5);  }
.rule_tables table {table-layout: fixed; width:100%;}
.rule_tables th {background-color: rgba(180,180,180,0.2); padding:0.2rem;}
.rule_tables td {padding: 0.2rem;}
.rule_tables {position: absolute; left: 400; top: 135}

/* rule styles */
.rule_category, .rule_name {display:inline-block;float:none; padding-right:0.2rem;}
.rule_category {font-size:1.3em;width: 100%;background-color: rgba(180,180,180,0.2); margin:0.5rem 0 0.2rem 0;padding:0;}
.rule_category:before, .rule_category:after {display:inline-block; content:''; width:0.4rem;}
.rule_key {padding:0.3rem;padding-left: 1.5rem;}
.rule_key.active {background-color: #ff8300; color:#ffffff;}
.rule_name {width:100%; text-align: left;}
</style>

<title>googlecloud Predefined Rules</title>
</head>
<body>
  <img src="logo.png" alt="Netskope"/>
  <h1>googlecloud Predefined Rules</h1>
  <div class="container">
    <div class="rule_keys">
        <ul>
            
            <li class="rule_key" data-profile-name="BPR">
              <span class="rule_name">GCP Best Practices v1.0.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CCM">
              <span class="rule_name">CSA CCM v3.0.1</span>
            </li>
            
            <li class="rule_key" data-profile-name="CIS">
              <span class="rule_name">CIS GCP Foundations Benchmark v1.0.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CISv1.2">
              <span class="rule_name">CIS GCP Foundations Benchmark v1.2.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CISv1.3">
              <span class="rule_name">CIS GCP Foundations Benchmark v1.3.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="GCP-IAM-advanced">
              <span class="rule_name">Netskope Advanced Security profile for GCP IAM</span>
            </li>
            
            <li class="rule_key" data-profile-name="GCP-IAM-essentials">
              <span class="rule_name">Netskope Essential Security profile for GCP IAM</span>
            </li>
            
            <li class="rule_key" data-profile-name="GCP-compute-advanced">
              <span class="rule_name">Netskope Advanced Security profile for GCP Compute</span>
            </li>
            
            <li class="rule_key" data-profile-name="GCP-compute-essentials">
              <span class="rule_name">Netskope Essential Security profile for GCP Compute</span>
            </li>
            
            <li class="rule_key" data-profile-name="GCP-data-storage-advanced">
              <span class="rule_name">Netskope Advanced Security profile for GCP Storage</span>
            </li>
            
            <li class="rule_key" data-profile-name="GCP-data-storage-essentials">
              <span class="rule_name">Netskope Essential Security profile for GCP Storage</span>
            </li>
            
            <li class="rule_key" data-profile-name="GCP-network-advanced">
              <span class="rule_name">Netskope Advanced Security profile for GCP Networking</span>
            </li>
            
            <li class="rule_key" data-profile-name="GCP-network-essentials">
              <span class="rule_name">Netskope Essential Security profile for GCP Networking</span>
            </li>
            
            <li class="rule_key" data-profile-name="GDPR">
              <span class="rule_name">GDPR 1996/679 (GCP)</span>
            </li>
            
            <li class="rule_key" data-profile-name="GKE-CISv1.1.0">
              <span class="rule_name">CIS GKE Benchmark v1.1.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="HIPAA">
              <span class="rule_name">HIPAA 1996 (GCP)</span>
            </li>
            
            <li class="rule_key" data-profile-name="ISO27K">
              <span class="rule_name">ISO 27002 (GCP)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST">
              <span class="rule_name">NIST CSF v1.1 (GCP)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST800-53">
              <span class="rule_name">NIST 800-53 r4 (GCP)</span>
            </li>
            
            <li class="rule_key" data-profile-name="PCI">
              <span class="rule_name">PCI-DSS v3.2.1 (GCP)</span>
            </li>
            
            <li class="rule_key" data-profile-name="SOC2">
              <span class="rule_name">AICPA SOC2 TSC 2017 (GCP)</span>
            </li>
            
            <!--
            <li class="rule_key" data-profile-name="ALL">
              <span class="rule_name">All Rules</span>
            </li>
            -->
        </ul>
        <br><br>
        <!-- 
        -->
        &#x1F50D;<input type="text" id="search" placeholder="Type to search"> 
    </div>
    <div class="rule_tables">
      
        <table id="table" class="rule_table" data-profile-name="BPR">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="1">
            <!-- <td>1</td> -->
            <td>Communications and control network protection: Ensure FirewallRule doesn't have any rule that allows incoming traffic on all ports</td>
            <td>Exposing all ports adds risk of exposure or compromise for all current and future network services running on the instance. Change firewall rule to only expose required ports.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Ports with [ FromPort eq 0 and ToPort eq 65535 ] ] </td>
          </tr>
          
          <tr num="2">
            <!-- <td>2</td> -->
            <td>Identities and credentials: Ensure BigQuery does not have Dataset ACL which is open to all authenticated users</td>
            <td>A cloud data warehouse should not allow access to all authenticated users. Verify that the permissions applied are in line with your business use case.This could expose sensitive data to users outside of your organization.</td>
            <td>
            
              BigQuery<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ SpecialGroup eq "allAuthenticatedUsers" ] </td>
          </tr>
          
          <tr num="3">
            <!-- <td>3</td> -->
            <td>Identities and credentials: Ensure BigQuery does not have Dataset ACL which grants permission to a Gmail account</td>
            <td>A cloud data warehouse should not allow access to Gmail accounts. Verify that the permissions applied are in line with your business use case.This could expose sensitive data to users outside of your organization.</td>
            <td>
            
              BigQuery<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ UserEmail like "@gmail\.com" ] </td>
          </tr>
          
          <tr num="4">
            <!-- <td>4</td> -->
            <td>Backups of information: Ensure SQL Instances have Backup enabled</td>
            <td>Enable database backups on mission-critical systems.Lack of backups can result in permanent data loss if database is lost or corrupted.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . BackupConfiguration . Enabled eq false </td>
          </tr>
          
          <tr num="5">
            <!-- <td>5</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens DNS port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "udp") and Ports with [ ( FromPort lte 53 and ToPort gte 53 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="6">
            <!-- <td>6</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens FTP port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( ( FromPort lte 20 and ToPort gte 20 ) or ( FromPort lte 21 and ToPort gte 21 ) ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="7">
            <!-- <td>7</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens MongoDB port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( ( FromPort lte 27017 and ToPort gte 27017 ) or ( FromPort lte 27018 and ToPort gte 27018 ) ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="8">
            <!-- <td>8</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens MsSQL port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 1434 and ToPort gte 1434 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="9">
            <!-- <td>9</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens MySQL port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 3306 and ToPort gte 3306 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="10">
            <!-- <td>10</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens NFS port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "udp", "tcp") and Ports with [ ( ( FromPort lte 111 and ToPort gte 111 ) or ( FromPort lte 2049 and ToPort gte 2049 ) ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="11">
            <!-- <td>11</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens OracleDB port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( ( FromPort lte 1521 and ToPort gte 1521 ) or ( FromPort lte 1630 and ToPort gte 1630 ) ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="12">
            <!-- <td>12</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens PostGreSQL port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 5432 and ToPort gte 5432 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="13">
            <!-- <td>13</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens RDP port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "udp", "tcp") and Ports with [ ( FromPort lte 3389 and ToPort gte 3389 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="14">
            <!-- <td>14</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens SMTP port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 25 and ToPort gte 25 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="15">
            <!-- <td>15</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens SSH port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 22 and ToPort gte 22 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="16">
            <!-- <td>16</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens Telnet port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 23 and ToPort gte 23 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="17">
            <!-- <td>17</td> -->
            <td>Ensure Virtual Machine Instances are not exposed to the internet</td>
            <td>Virtual Machine should not have the public IP address. If it is public is have exposure to the Internet which can increase the likelihood of data exfiltration or compromise for this virtual machine. To prevent this remove the public IP address from the access configuration for this virtual machine.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have NetworkInterfaces with [ AccessConfigs with [ NatIP ] ] </td>
          </tr>
          
          <tr num="18">
            <!-- <td>18</td> -->
            <td>Ensure VPC does not have any route to the internet</td>
            <td>If VPC has a route to the Internet, then Exposure to the internet can lead to data exfiltration or compromise for resources in this VPC. Change the configuration of VPC to prevent this.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">Route should not have Network . Mode len () gt 0 and ( DestinationCIDR isPublic ( ) or DestinationCIDR eq 0.0.0.0/0 ) </td>
          </tr>
          
          <tr num="19">
            <!-- <td>19</td> -->
            <td>Ensure that Load Balancers do not have public IP address</td>
            <td>If Load Balancer has a public IP address, then it can have exposure to the Internet. It can increase the likelihood of data exfiltration or compromise for the resources behind this load balancer. Modify the Load Balancer public IP to internal IP.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">ForwardingRule should not have Type eq "INTERNAL" and IP isPublic() </td>
          </tr>
          
          <tr num="20">
            <!-- <td>20</td> -->
            <td>Ensure that project's IAM does not have primitive roles</td>
            <td>The Wide-ranging permissions roles should not provide to any account. It is the best practice to give the least privilege needed to limit the impact of a security incident. Apply more granular permissions to the account.</td>
            <td>
            
              ProjectIAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Role . InbuiltRole and Role . Name in ( "editor", "viewer", "owner" ) </td>
          </tr>
          
          <tr num="21">
            <!-- <td>21</td> -->
            <td>Ensure that 'Account' has 'services enabled'</td>
            <td>Ensure that Account has services enabled </td>
            <td>
            
              Project<br>
            
            </td>
            <td class="code">Project should have Services len ( ) gt 0 </td>
          </tr>
          
          <tr num="22">
            <!-- <td>22</td> -->
            <td>Ensure that DataProc Cluster has a customer managed encryption key</td>
            <td>Ensure that DataProc Cluster has a customer managed encryption key</td>
            <td>
            
              Dataproc<br>
            
            </td>
            <td class="code">DataprocCluster should have Config . EncryptionConfig . GcePdKmsKeyName </td>
          </tr>
          
          <tr num="23">
            <!-- <td>23</td> -->
            <td>Ensure that 'Bucket' has a 'customer managed encryption key'</td>
            <td>Ensure that Bucket' has a customer managed encryption key</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Encryption eq "Customer-managed key" </td>
          </tr>
          
          <tr num="24">
            <!-- <td>24</td> -->
            <td>Ensure that 'Virtual Machine Instance Disk' has a 'customer managed encryption key'</td>
            <td>Ensure that Virtual Machine Instance Disk has a customer managed encryption key</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Volume should have DiskEncryptionKey . KMSKey . State eq "ENABLED" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CCM">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="25">
            <!-- <td>25</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="26">
            <!-- <td>26</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="27">
            <!-- <td>27</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="28">
            <!-- <td>28</td> -->
            <td>Baseline security configuration of systems: Ensure Kubernetes Clusters are configured with Labels</td>
            <td>Labels enable users to map their own organizational structures onto system objects in a loosely coupled fashion, without requiring clients to store these mappings. Labels can also be used to apply specific security settings and 'auto configure' objects at creation.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="29">
            <!-- <td>29</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="30">
            <!-- <td>30</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="31">
            <!-- <td>31</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="32">
            <!-- <td>32</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="33">
            <!-- <td>33</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="34">
            <!-- <td>34</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="35">
            <!-- <td>35</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="36">
            <!-- <td>36</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="37">
            <!-- <td>37</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="38">
            <!-- <td>38</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="39">
            <!-- <td>39</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="40">
            <!-- <td>40</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="41">
            <!-- <td>41</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="42">
            <!-- <td>42</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="43">
            <!-- <td>43</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="44">
            <!-- <td>44</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="45">
            <!-- <td>45</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="46">
            <!-- <td>46</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="47">
            <!-- <td>47</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="48">
            <!-- <td>48</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="49">
            <!-- <td>49</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="50">
            <!-- <td>50</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="51">
            <!-- <td>51</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="52">
            <!-- <td>52</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="53">
            <!-- <td>53</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="54">
            <!-- <td>54</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="55">
            <!-- <td>55</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="56">
            <!-- <td>56</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="57">
            <!-- <td>57</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="58">
            <!-- <td>58</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="59">
            <!-- <td>59</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="60">
            <!-- <td>60</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="61">
            <!-- <td>61</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="62">
            <!-- <td>62</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="63">
            <!-- <td>63</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="64">
            <!-- <td>64</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="65">
            <!-- <td>65</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="66">
            <!-- <td>66</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="67">
            <!-- <td>67</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="68">
            <!-- <td>68</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="69">
            <!-- <td>69</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="70">
            <!-- <td>70</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="71">
            <!-- <td>71</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="72">
            <!-- <td>72</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
          <tr num="73">
            <!-- <td>73</td> -->
            <td>Backups of information: Ensure `Automatic node repair` is enabled for Kubernetes Clusters</td>
            <td>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node. If you disable node auto-repair at any time during the repair process, the in-progress repairs are not cancelled and still complete for any node currently under repair.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoRepair eq True ] </td>
          </tr>
          
          <tr num="74">
            <!-- <td>74</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="75">
            <!-- <td>75</td> -->
            <td>Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image</td>
            <td>Container-Optimized OS is an operating system image for your Compute Engine VMs that is optimized for running Docker containers. With Container-Optimized OS, you can bring up your Docker containers on Google Cloud Platform quickly, efficiently, and securely.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodeConfig . ImageType eq "COS" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CIS">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="76">
            <!-- <td>76</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="77">
            <!-- <td>77</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="78">
            <!-- <td>78</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="79">
            <!-- <td>79</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="80">
            <!-- <td>80</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="81">
            <!-- <td>81</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="82">
            <!-- <td>82</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="83">
            <!-- <td>83</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="84">
            <!-- <td>84</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="85">
            <!-- <td>85</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="86">
            <!-- <td>86</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="87">
            <!-- <td>87</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="88">
            <!-- <td>88</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="89">
            <!-- <td>89</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="90">
            <!-- <td>90</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="91">
            <!-- <td>91</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="92">
            <!-- <td>92</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="93">
            <!-- <td>93</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="94">
            <!-- <td>94</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="95">
            <!-- <td>95</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="96">
            <!-- <td>96</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="97">
            <!-- <td>97</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="98">
            <!-- <td>98</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="99">
            <!-- <td>99</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="100">
            <!-- <td>100</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="101">
            <!-- <td>101</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="102">
            <!-- <td>102</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="103">
            <!-- <td>103</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="104">
            <!-- <td>104</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="105">
            <!-- <td>105</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="106">
            <!-- <td>106</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="107">
            <!-- <td>107</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="108">
            <!-- <td>108</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="109">
            <!-- <td>109</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="110">
            <!-- <td>110</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="111">
            <!-- <td>111</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="112">
            <!-- <td>112</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="113">
            <!-- <td>113</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="114">
            <!-- <td>114</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="115">
            <!-- <td>115</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="116">
            <!-- <td>116</td> -->
            <td>Baseline security configuration of systems: Ensure Kubernetes Clusters are configured with Labels</td>
            <td>Labels enable users to map their own organizational structures onto system objects in a loosely coupled fashion, without requiring clients to store these mappings. Labels can also be used to apply specific security settings and 'auto configure' objects at creation.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="117">
            <!-- <td>117</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="118">
            <!-- <td>118</td> -->
            <td>Backups of information: Ensure `Automatic node repair` is enabled for Kubernetes Clusters</td>
            <td>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node. If you disable node auto-repair at any time during the repair process, the in-progress repairs are not cancelled and still complete for any node currently under repair.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoRepair eq True ] </td>
          </tr>
          
          <tr num="119">
            <!-- <td>119</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="120">
            <!-- <td>120</td> -->
            <td>Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image</td>
            <td>Container-Optimized OS is an operating system image for your Compute Engine VMs that is optimized for running Docker containers. With Container-Optimized OS, you can bring up your Docker containers on Google Cloud Platform quickly, efficiently, and securely.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodeConfig . ImageType eq "COS" </td>
          </tr>
          
          <tr num="121">
            <!-- <td>121</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="122">
            <!-- <td>122</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="123">
            <!-- <td>123</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="124">
            <!-- <td>124</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="125">
            <!-- <td>125</td> -->
            <td>Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled </td>
            <td>Disable access to the Kubernetes API from outside the node network if it is not required.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PrivateClusterConfig . EnablePrivateEndpoint and Endpoint isPrivate () </td>
          </tr>
          
          <tr num="126">
            <!-- <td>126</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
          <tr num="127">
            <!-- <td>127</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="128">
            <!-- <td>128</td> -->
            <td>Ensure VM disks for critical VMs are encrypted with Customer-Supplied Encryption Keys (CSEK)</td>
            <td>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. If you supply your own encryption keys, Google uses your key to protect the Google-generated keys used to encrypt and decrypt your data. By default, Google Compute Engine encrypts all data at rest. Compute Engine handles and manages this encryption for you without any additional actions on your part. However, if you wanted to control and manage this encryption yourself, you can provide your own encryption keys</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Volume where Name notlike "^gke-" should have DiskEncryptionKey . Sha256 len ( ) gt 0 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CISv1.2">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="129">
            <!-- <td>129</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="130">
            <!-- <td>130</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="131">
            <!-- <td>131</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="132">
            <!-- <td>132</td> -->
            <td>Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level</td>
            <td>It is recommended to assign the Service Account User (iam.serviceAccountUser) and Service Account Token Creator (iam.serviceAccountTokenCreator) roles to a user for a specific service account rather than assigning the role to a user at project level.</td>
            <td>
            
              Identity<br>
            
            </td>
            <td class="code">IAMPolicy where Name eq "iam.serviceAccountUser" or Name eq "iam.serviceAccountTokenCreator" should have Members . UserEmails len() eq 0 </td>
          </tr>
          
          <tr num="133">
            <!-- <td>133</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="134">
            <!-- <td>134</td> -->
            <td>Ensure that Cloud KMS cryptokeys are not anonymously or publicly accessible</td>
            <td>It is recommended that the IAM policy on Cloud KMS cryptokeys should restrict anonymous and/or public access</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should not have Bindings with [ Members has ("allAuthenticatedUsers") or Members has ("allUsers") ] </td>
          </tr>
          
          <tr num="135">
            <!-- <td>135</td> -->
            <td>Ensure KMS encryption keys are rotated within a period of 90 days</td>
            <td>It is recommended that the KMS encryption keys are rotated within a period of 90 days</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 7776000 and NextRotationTime isEarlierThan (90, "days") </td>
          </tr>
          
          <tr num="136">
            <!-- <td>136</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="137">
            <!-- <td>137</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="138">
            <!-- <td>138</td> -->
            <td>Ensure that retention policies on log buckets are configured using Bucket Lock</td>
            <td>Enabling retention policies on log buckets will protect logs stored in cloud storage buckets from being overwritten or accidentally deleted. It is recommended to set up retention policies and configure Bucket Lock on all storage buckets that are used as log sinks.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">LoggingSink where Destination . Bucket . Type len() gt 0 should have Destination . Bucket . RetentionPolicy . IsLocked </td>
          </tr>
          
          <tr num="139">
            <!-- <td>139</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="140">
            <!-- <td>140</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="141">
            <!-- <td>141</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="142">
            <!-- <td>142</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="143">
            <!-- <td>143</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="144">
            <!-- <td>144</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="145">
            <!-- <td>145</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="146">
            <!-- <td>146</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="147">
            <!-- <td>147</td> -->
            <td>Ensure that Cloud DNS logging is enabled for all VPC networks</td>
            <td>Cloud DNS logging records the queries from the name servers within your VPC to Stackdriver. Logged queries can come from Compute Engine VMs, GKE containers, or other GCP resources provisioned within the VPC</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VPC should have DNSPolicy . enableLogging </td>
          </tr>
          
          <tr num="148">
            <!-- <td>148</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="149">
            <!-- <td>149</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="150">
            <!-- <td>150</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="151">
            <!-- <td>151</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="152">
            <!-- <td>152</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="153">
            <!-- <td>153</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="154">
            <!-- <td>154</td> -->
            <td>Ensure that instances are not configured to use the default service account</td>
            <td>It is recommended to configure your instance to not use the default Compute Engine service account because it has the Editor role on the project.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Email like "compute@developer\.gserviceaccount\.com$"] </td>
          </tr>
          
          <tr num="155">
            <!-- <td>155</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="156">
            <!-- <td>156</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="157">
            <!-- <td>157</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="158">
            <!-- <td>158</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="159">
            <!-- <td>159</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="160">
            <!-- <td>160</td> -->
            <td>Ensure VM disks for critical VMs are encrypted with Customer-Supplied Encryption Keys (CSEK)</td>
            <td>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. If you supply your own encryption keys, Google uses your key to protect the Google-generated keys used to encrypt and decrypt your data. By default, Google Compute Engine encrypts all data at rest. Compute Engine handles and manages this encryption for you without any additional actions on your part. However, if you wanted to control and manage this encryption yourself, you can provide your own encryption keys</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Volume where Name notlike "^gke-" should have DiskEncryptionKey . Sha256 len ( ) gt 0 </td>
          </tr>
          
          <tr num="161">
            <!-- <td>161</td> -->
            <td>Ensure Compute instances are launched with Shielded VM enabled</td>
            <td>To defend against advanced threats and ensure that the boot loader and firmware on your VMs are signed and untampered, it is recommended that Compute instances are launched with Shielded VM enabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should have ShieldedVM </td>
          </tr>
          
          <tr num="162">
            <!-- <td>162</td> -->
            <td>Ensure that Compute instances do not have public IP addresses</td>
            <td>Compute instances should not be configured to have external IP addresses.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have NetworkInterfaces with [ AccessConfigs len ( ) gt 0 ] </td>
          </tr>
          
          <tr num="163">
            <!-- <td>163</td> -->
            <td>Ensure that Compute instances have Confidential Computing enabled</td>
            <td>Google Cloud encrypts data at-rest and in-transit, but customer data must be decrypted for processing. Confidential Computing is a breakthrough technology which encrypts data in use while it is being processed. Confidential Computing environments keep data encrypted in memory and elsewhere outside the central processing unit (CPU).</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should have ConfidentialComputing </td>
          </tr>
          
          <tr num="164">
            <!-- <td>164</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="165">
            <!-- <td>165</td> -->
            <td>Ensure that Cloud Storage buckets have uniform bucket-level access enabled</td>
            <td>It is recommended that uniform bucket-level access is enabled on Cloud Storage buckets.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have IAMConfiguration.UniformBucketLevelAccess </td>
          </tr>
          
          <tr num="166">
            <!-- <td>166</td> -->
            <td>Ensure 'skip_show_database' database flag for Cloud SQL Mysql instance is set to 'on'</td>
            <td>It is recommended to set skip_show_database database flag for Cloud SQL Mysql instance to on</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should have Settings . DatabaseFlags with [ Name eq "skip_show_database" and Value eq "on" ] </td>
          </tr>
          
          <tr num="167">
            <!-- <td>167</td> -->
            <td>Ensure that the 'local_infile' database flag for a Cloud SQL Mysql instance is set to 'off'</td>
            <td>It is recommended to set the local_infile database flag for a Cloud SQL MySQL instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should have Settings . DatabaseFlags with [ Name eq "local_infile" and Value eq "off" ] </td>
          </tr>
          
          <tr num="168">
            <!-- <td>168</td> -->
            <td>Ensure that the 'log_checkpoints' database flag for Cloud SQL PostgreSQL instance is set to 'on'</td>
            <td>Ensure that the log_checkpoints database flag for the Cloud SQL PostgreSQL instance is set to on.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_checkpoints" and Value eq "on" ] </td>
          </tr>
          
          <tr num="169">
            <!-- <td>169</td> -->
            <td>Ensure 'log_error_verbosity' database flag for Cloud SQL PostgreSQL instance is set to 'DEFAULT' or stricter</td>
            <td>The log_error_verbosity flag controls the verbosity/details of messages logged. Valid values are: TERSE, DEFAULT, VERBOSE</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_error_verbosity" and Value in ( "default", "verbose" ) ] </td>
          </tr>
          
          <tr num="170">
            <!-- <td>170</td> -->
            <td>Ensure that the 'log_connections' database flag for Cloud SQL PostgreSQL instance is set to 'on'</td>
            <td>Enabling the log_connections setting causes each attempted connection to the server to be logged, along with successful completion of client authentication. This parameter cannot be changed after the session starts.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_connections" and Value eq "on" ] </td>
          </tr>
          
          <tr num="171">
            <!-- <td>171</td> -->
            <td>Ensure that the 'log_disconnections' database flag for Cloud SQL PostgreSQL instance is set to 'on'</td>
            <td>Enabling the log_disconnections setting logs the end of each session, including the session duration.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_disconnections" and Value eq "on" ] </td>
          </tr>
          
          <tr num="172">
            <!-- <td>172</td> -->
            <td>Ensure that the 'log_lock_waits' database flag for Cloud SQL PostgreSQL instance is set to 'on</td>
            <td>Enabling the log_lock_waits flag for a PostgreSQL instance creates a log for any session waits that take longer than the alloted deadlock_timeout time to acquire a lock.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_lock_waits" and Value eq "on" ] </td>
          </tr>
          
          <tr num="173">
            <!-- <td>173</td> -->
            <td>Ensure 'log_statement_stats' database flag for Cloud SQL PostgreSQL instance is set to 'off'</td>
            <td>The log_statement_stats flag controls the inclusion of end to end performance statistics of a SQL query in the PostgreSQL logs for each query. This cannot be enabled with other module statistics (log_parser_stats, log_planner_stats, log_executor_stats).</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_statement_stats" and Value eq "off" ] </td>
          </tr>
          
          <tr num="174">
            <!-- <td>174</td> -->
            <td>Ensure 'log_hostname' database flag for Cloud SQL PostgreSQL instance is set appropriately</td>
            <td>PostgreSQL logs only the IP address of the connecting hosts. The log_hostname flag controls the logging of hostnames in addition to the IP addresses logged. The performance hit is dependent on the configuration of the environment and the host name resolution setup.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_hostname" and Value eq "off" ] </td>
          </tr>
          
          <tr num="175">
            <!-- <td>175</td> -->
            <td>Ensure 'log_parser_stats' database flag for Cloud SQL PostgreSQL instance is set to 'off'</td>
            <td>The PostgreSQL planner/optimizer is responsible to parse and verify the syntax of each query received by the server. If the syntax is correct a parse tree is built up else an error is generated. The log_parser_stats flag controls the inclusion of parser performance statistics in the PostgreSQL logs for each query.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_parser_stats" and Value eq "off" ] </td>
          </tr>
          
          <tr num="176">
            <!-- <td>176</td> -->
            <td>Ensure 'log_planner_stats' database flag for Cloud SQL PostgreSQL instance is set to 'off'</td>
            <td>The same SQL query can be excuted in multiple ways and still produce different results. The PostgreSQL planner/optimizer is responsible to create an optimal execution plan for each query. The log_planner_stats flag controls the inclusion of PostgreSQL planner performance statistics in the PostgreSQL logs for each query..</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_planner_stats" and Value eq "off" ] </td>
          </tr>
          
          <tr num="177">
            <!-- <td>177</td> -->
            <td>Ensure 'log_executor_stats' database flag for Cloud SQL PostgreSQL instance is set to 'off'</td>
            <td>The PostgreSQL executor is responsible to execute the plan handed over by the PostgreSQL planner. The executor processes the plan recursively to extract the required set of rows. The log_executor_stats flag controls the inclusion of PostgreSQL executor performance statistics in the PostgreSQL logs for each query.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_executor_stats" and Value eq "off" ] </td>
          </tr>
          
          <tr num="178">
            <!-- <td>178</td> -->
            <td>Ensure 'log_min_error_statement' database flag for Cloud SQL PostgreSQL instance is set to 'Error' or stricter</td>
            <td>The log_min_error_statement flag defines the minimum message severity level that are considered as an error statement. Messages for error statements are logged with the SQL statement. Valid values include DEBUG5, DEBUG4, DEBUG3, DEBUG2, DEBUG1, INFO, NOTICE, WARNING, ERROR, LOG, FATAL, and PANIC. Each severity level includes the subsequent levels mentioned above. Ensure a value of ERROR or stricter is set.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_min_error_statement" and Value in ("debug5", "debug4", "debug3", "debug2", "debug1", "info", "notice", "warning", "error")] </td>
          </tr>
          
          <tr num="179">
            <!-- <td>179</td> -->
            <td>Ensure that the 'log_temp_files' database flag for Cloud SQL PostgreSQL instance is set to '0' (on)</td>
            <td>PostgreSQL can create a temporary file for actions such as sorting, hashing and temporary query results when these operations exceed work_mem. The log_temp_files flag controls logging names and the file size when it is deleted. Configuring log_temp_files to 0 causes all temporary file information to be logged, while positive values log only files whose size is greater than or equal to the specified number of kilobytes. A value of -1 disables temporary file information logging.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_temp_files" and Value eq "0" ] </td>
          </tr>
          
          <tr num="180">
            <!-- <td>180</td> -->
            <td>Ensure that the 'log_min_duration_statement' database flag for Cloud SQL PostgreSQL instance is set to '-1' (disabled)</td>
            <td>The log_min_duration_statement flag defines the minimum amount of execution time of a statement in milliseconds where the total duration of the statement is logged. Ensure that log_min_duration_statement is disabled, i.e., a value of -1 is set.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_min_duration_statement" and Value eq "-1" ] </td>
          </tr>
          
          <tr num="181">
            <!-- <td>181</td> -->
            <td>Ensure 'external scripts enabled' database flag for Cloud SQL SQL Server instance is set to 'off</td>
            <td>It is recommended to set external scripts enabled database flag for Cloud SQL SQL Server instance to off</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "external scripts enabled" and Value eq "off" ] </td>
          </tr>
          
          <tr num="182">
            <!-- <td>182</td> -->
            <td>Ensure 'cross db ownership chaining' database flag for Cloud SQL SQL Server instance is set to 'off'</td>
            <td>It is recommended to set cross db ownership chaining database flag for Cloud SQL SQL Server instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "cross db ownership chaining" and Value eq "off" ] </td>
          </tr>
          
          <tr num="183">
            <!-- <td>183</td> -->
            <td>Ensure 'user options' database flag for Cloud SQL SQL Server instance is not configured</td>
            <td>It is recommended that, user options database flag for Cloud SQL SQL Server instance should not be configured.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should not have Settings . DatabaseFlags with [ Name eq "user options" ] </td>
          </tr>
          
          <tr num="184">
            <!-- <td>184</td> -->
            <td>Ensure 'user connections' database flag for Cloud SQL SQL Server instance is set as appropriate</td>
            <td>It is recommended to set user connections database flag for Cloud SQL SQL Server instance according organization-defined value.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "user connections" and Value neq "0" ] </td>
          </tr>
          
          <tr num="185">
            <!-- <td>185</td> -->
            <td>Ensure '3625 (trace flag)' database flag for Cloud SQL SQL Server instance is set to 'off'</td>
            <td>It is recommended to set 3625 (trace flag) database flag for Cloud SQL SQL Server instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "3625" and Value eq "off" ] </td>
          </tr>
          
          <tr num="186">
            <!-- <td>186</td> -->
            <td>Ensure that the 'contained database authentication' database flag for Cloud SQL on the SQL Server instance is set to 'off'</td>
            <td>It is recommended to set contained database authentication database flag for Cloud SQL on the SQL Server instance is set to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "contained database authentication" and Value eq "off" ] </td>
          </tr>
          
          <tr num="187">
            <!-- <td>187</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="188">
            <!-- <td>188</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="189">
            <!-- <td>189</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="190">
            <!-- <td>190</td> -->
            <td>Ensure that Cloud SQL database instances do not have public IPs</td>
            <td>It is recommended to configure Second Generation Sql instance to use private IPs instead of public IPs.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where InstanceType eq "CLOUD_SQL_INSTANCE" should not have BackendType eq "SECOND_GEN" and IpAddresses with [IpAddress isPublic() or Type eq "PRIMARY" ] </td>
          </tr>
          
          <tr num="191">
            <!-- <td>191</td> -->
            <td>Backups of information: Ensure SQL Instances have Backup enabled</td>
            <td>Enable database backups on mission-critical systems.Lack of backups can result in permanent data loss if database is lost or corrupted.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . BackupConfiguration . Enabled eq false </td>
          </tr>
          
          <tr num="192">
            <!-- <td>192</td> -->
            <td>Ensure that BigQuery datasets are not anonymously or publicly accessible</td>
            <td>It is recommended that the IAM policy on BigQuery datasets does not allow anonymous and/or public access.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ SpecialGroup eq "allAuthenticatedUsers" or SpecialGroup eq "allUsers"] </td>
          </tr>
          
          <tr num="193">
            <!-- <td>193</td> -->
            <td> Ensure that all BigQuery Tables are encrypted with Customer- managed encryption key (CMEK)</td>
            <td>BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys. The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys. This is seamless and do not require any additional input from the user. However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets. If CMEK is used, the CMEK is used to encrypt the data encryption keys instead of using google-managed encryption keys.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should have every Tables with [ encryption . enabled ] </td>
          </tr>
          
          <tr num="194">
            <!-- <td>194</td> -->
            <td>Ensure 'remote access' database flag for Cloud SQL SQL Server instance is set to 'off'</td>
            <td>It is recommended to set remote access database flag for Cloud SQL SQL Server instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "remote access" and Value eq "off" ] </td>
          </tr>
          
          <tr num="195">
            <!-- <td>195</td> -->
            <td>Ensure that a Default Customer-managed encryption key (CMEK) is specified for all BigQuery Data Sets</td>
            <td>BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys. The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys. This is seamless and do not require any additional input from the user. However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should have Encryption.Enabled </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CISv1.3">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="196">
            <!-- <td>196</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="197">
            <!-- <td>197</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="198">
            <!-- <td>198</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="199">
            <!-- <td>199</td> -->
            <td>Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level</td>
            <td>It is recommended to assign the Service Account User (iam.serviceAccountUser) and Service Account Token Creator (iam.serviceAccountTokenCreator) roles to a user for a specific service account rather than assigning the role to a user at project level.</td>
            <td>
            
              Identity<br>
            
            </td>
            <td class="code">IAMPolicy where Name eq "iam.serviceAccountUser" or Name eq "iam.serviceAccountTokenCreator" should have Members . UserEmails len() eq 0 </td>
          </tr>
          
          <tr num="200">
            <!-- <td>200</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="201">
            <!-- <td>201</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="202">
            <!-- <td>202</td> -->
            <td>Ensure that Cloud KMS cryptokeys are not anonymously or publicly accessible</td>
            <td>It is recommended that the IAM policy on Cloud KMS cryptokeys should restrict anonymous and/or public access</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should not have Bindings with [ Members has ("allAuthenticatedUsers") or Members has ("allUsers") ] </td>
          </tr>
          
          <tr num="203">
            <!-- <td>203</td> -->
            <td>Ensure KMS encryption keys are rotated within a period of 90 days</td>
            <td>It is recommended that the KMS encryption keys are rotated within a period of 90 days</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 7776000 and NextRotationTime isEarlierThan (90, "days") </td>
          </tr>
          
          <tr num="204">
            <!-- <td>204</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="205">
            <!-- <td>205</td> -->
            <td>Ensure API Keys Are Not Created for a Project</td>
            <td>Keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to use standard authentication flow instead</td>
            <td>
            
              API<br>
            
            </td>
            <td class="code">GCP should not have APIKeys len() gt 0 </td>
          </tr>
          
          <tr num="206">
            <!-- <td>206</td> -->
            <td>Ensure API keys are restricted to only APIs that application needs access</td>
            <td>API keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to restrict API keys to use (call) only APIs required by an application</td>
            <td>
            
              API<br>
            
            </td>
            <td class="code">APIKey should not have ( APIRestrictions len () eq 0 or APIRestrictions with [ Service eq "cloudapis.googleapis.com" ] ) </td>
          </tr>
          
          <tr num="207">
            <!-- <td>207</td> -->
            <td>Ensure API keys are restricted to use by only specified Hosts and Apps</td>
            <td>Unrestricted keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to restrict API key usage to trusted hosts, HTTP referrers and apps</td>
            <td>
            
              API<br>
            
            </td>
            <td class="code">APIKey should not have ( ApplicationRestriction eq "None" or ( ( ApplicationRestriction eq "BrowserKeyRestrictions" and BrowserKeyRestrictions with [ AllowedReferrer like "\*" ] ) or ( ApplicationRestriction eq "ServerKeyRestrictions" and ServerKeyRestrictions with [ AllowedIp in ("0.0.0.0", "0.0.0.0/0", "::/0") ] ) ) ) </td>
          </tr>
          
          <tr num="208">
            <!-- <td>208</td> -->
            <td>Ensure API keys are rotated every 90 days</td>
            <td>It is recommended to rotate API keys every 90 days</td>
            <td>
            
              API<br>
            
            </td>
            <td class="code">APIKey should have CreationDate isLaterThan ( -90, "days" ) </td>
          </tr>
          
          <tr num="209">
            <!-- <td>209</td> -->
            <td>Ensure Essential Contacts is Configured for Organization</td>
            <td>It is recommended that Essential Contacts is configured to designate email addresses for Google Cloud services to notify of important technical or security information</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Organization should have EssentialContacts len () gt 0 and ( EssentialContacts with [ ValidationState eq "VALID" and NotificationCategorySubscriptions with [ NotificationCategory eq "ALL" ] ] or ( EssentialContacts with [ ValidationState eq "VALID" and NotificationCategorySubscriptions with [ NotificationCategory eq "LEGAL" ] ] and EssentialContacts with [ ValidationState eq "VALID" and NotificationCategorySubscriptions with [ NotificationCategory eq "SECURITY" ] ] and EssentialContacts with [ ValidationState eq "VALID" and NotificationCategorySubscriptions with [ NotificationCategory eq "SUSPENSION" ] ] and EssentialContacts with [ ValidationState eq "VALID" and NotificationCategorySubscriptions with [ NotificationCategory eq "TECHNICAL" ] ] ) ) </td>
          </tr>
          
          <tr num="210">
            <!-- <td>210</td> -->
            <td>Ensure that DataProc Cluster has a customer managed encryption key</td>
            <td>Ensure that DataProc Cluster has a customer managed encryption key</td>
            <td>
            
              Dataproc<br>
            
            </td>
            <td class="code">DataprocCluster should have Config . EncryptionConfig . GcePdKmsKeyName </td>
          </tr>
          
          <tr num="211">
            <!-- <td>211</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="212">
            <!-- <td>212</td> -->
            <td>Ensure That Sinks Are Configured for All Log Entries</td>
            <td>It is recommended to create a sink that will export copies of all the log entries. This can help aggregate logs from multiple projects and export them to a Security Information and Event Management (SIEM)</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one LoggingSinks with [ Destination . URL and ( Destination . BigqueryDataset or Destination . Bucket or Destination . PubSubTopic ) and ( Filter len() eq 0 or not Filter ) ] </td>
          </tr>
          
          <tr num="213">
            <!-- <td>213</td> -->
            <td>Ensure that retention policies on log buckets are configured using Bucket Lock</td>
            <td>Enabling retention policies on log buckets will protect logs stored in cloud storage buckets from being overwritten or accidentally deleted. It is recommended to set up retention policies and configure Bucket Lock on all storage buckets that are used as log sinks.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">LoggingSink where Destination . Bucket . Type len() gt 0 should have Destination . Bucket . RetentionPolicy . IsLocked </td>
          </tr>
          
          <tr num="214">
            <!-- <td>214</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="215">
            <!-- <td>215</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="216">
            <!-- <td>216</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="217">
            <!-- <td>217</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="218">
            <!-- <td>218</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="219">
            <!-- <td>219</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="220">
            <!-- <td>220</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="221">
            <!-- <td>221</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="222">
            <!-- <td>222</td> -->
            <td>Ensure that Cloud DNS logging is enabled for all VPC networks</td>
            <td>Cloud DNS logging records the queries from the name servers within your VPC to Stackdriver. Logged queries can come from Compute Engine VMs, GKE containers, or other GCP resources provisioned within the VPC</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VPC should have DNSPolicy . enableLogging </td>
          </tr>
          
          <tr num="223">
            <!-- <td>223</td> -->
            <td>Ensure Cloud Asset Inventory Is Enabled</td>
            <td>GCP Cloud Asset Inventory is services that provides a historical view of GCP resources and IAM policies through a time-series database. The information recorded includes metadata on Google Cloud resources, metadata on policies set on Google Cloud projects or resources, and runtime information gathered within a Google Cloud resource</td>
            <td>
            
              API<br>
            
            </td>
            <td class="code">GCP should have atleast one Service with [ Name eq "cloudasset.googleapis.com" and State eq "ENABLED"] </td>
          </tr>
          
          <tr num="224">
            <!-- <td>224</td> -->
            <td>Ensure 'Access Approval' is 'Enabled'</td>
            <td>GCP Access Approval enables you to require your organizations' explicit approval whenever Google support try to access your projects. You can then select users within your organization who can approve these requests through giving them a security role in IAM. All access requests display which Google Employee requested them in an email or Pub/Sub message that you can choose to Approve. This adds an additional control and logging of who in your organization approved/denied these requests</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">AccessApprovalSetting should have ( Enabled and EnrolledServices with [ CloudProduct eq "all" ] ) </td>
          </tr>
          
          <tr num="225">
            <!-- <td>225</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="226">
            <!-- <td>226</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="227">
            <!-- <td>227</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="228">
            <!-- <td>228</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="229">
            <!-- <td>229</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="230">
            <!-- <td>230</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="231">
            <!-- <td>231</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="232">
            <!-- <td>232</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="233">
            <!-- <td>233</td> -->
            <td>Ensure that instances are not configured to use the default service account</td>
            <td>It is recommended to configure your instance to not use the default Compute Engine service account because it has the Editor role on the project.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Email like "compute@developer\.gserviceaccount\.com$"] </td>
          </tr>
          
          <tr num="234">
            <!-- <td>234</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="235">
            <!-- <td>235</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="236">
            <!-- <td>236</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="237">
            <!-- <td>237</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="238">
            <!-- <td>238</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="239">
            <!-- <td>239</td> -->
            <td>Ensure VM disks for critical VMs are encrypted with Customer-Supplied Encryption Keys (CSEK)</td>
            <td>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. If you supply your own encryption keys, Google uses your key to protect the Google-generated keys used to encrypt and decrypt your data. By default, Google Compute Engine encrypts all data at rest. Compute Engine handles and manages this encryption for you without any additional actions on your part. However, if you wanted to control and manage this encryption yourself, you can provide your own encryption keys</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Volume where Name notlike "^gke-" should have DiskEncryptionKey . Sha256 len ( ) gt 0 </td>
          </tr>
          
          <tr num="240">
            <!-- <td>240</td> -->
            <td>Ensure Compute instances are launched with Shielded VM enabled</td>
            <td>To defend against advanced threats and ensure that the boot loader and firmware on your VMs are signed and untampered, it is recommended that Compute instances are launched with Shielded VM enabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should have ShieldedVM </td>
          </tr>
          
          <tr num="241">
            <!-- <td>241</td> -->
            <td>Ensure that Compute instances do not have public IP addresses</td>
            <td>Compute instances should not be configured to have external IP addresses.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have NetworkInterfaces with [ AccessConfigs len ( ) gt 0 ] </td>
          </tr>
          
          <tr num="242">
            <!-- <td>242</td> -->
            <td>Ensure that Compute instances have Confidential Computing enabled</td>
            <td>Google Cloud encrypts data at-rest and in-transit, but customer data must be decrypted for processing. Confidential Computing is a breakthrough technology which encrypts data in use while it is being processed. Confidential Computing environments keep data encrypted in memory and elsewhere outside the central processing unit (CPU).</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should have ConfidentialComputing </td>
          </tr>
          
          <tr num="243">
            <!-- <td>243</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="244">
            <!-- <td>244</td> -->
            <td>Ensure that Cloud Storage buckets have uniform bucket-level access enabled</td>
            <td>It is recommended that uniform bucket-level access is enabled on Cloud Storage buckets.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have IAMConfiguration.UniformBucketLevelAccess </td>
          </tr>
          
          <tr num="245">
            <!-- <td>245</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="246">
            <!-- <td>246</td> -->
            <td>Ensure 'skip_show_database' database flag for Cloud SQL Mysql instance is set to 'on'</td>
            <td>It is recommended to set skip_show_database database flag for Cloud SQL Mysql instance to on</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should have Settings . DatabaseFlags with [ Name eq "skip_show_database" and Value eq "on" ] </td>
          </tr>
          
          <tr num="247">
            <!-- <td>247</td> -->
            <td>Ensure that the 'local_infile' database flag for a Cloud SQL Mysql instance is set to 'off'</td>
            <td>It is recommended to set the local_infile database flag for a Cloud SQL MySQL instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should have Settings . DatabaseFlags with [ Name eq "local_infile" and Value eq "off" ] </td>
          </tr>
          
          <tr num="248">
            <!-- <td>248</td> -->
            <td>Ensure 'log_error_verbosity' database flag for Cloud SQL PostgreSQL instance is set to 'DEFAULT' or stricter</td>
            <td>The log_error_verbosity flag controls the verbosity/details of messages logged. Valid values are: TERSE, DEFAULT, VERBOSE</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_error_verbosity" and Value in ( "default", "verbose" ) ] </td>
          </tr>
          
          <tr num="249">
            <!-- <td>249</td> -->
            <td>Ensure that the 'log_connections' database flag for Cloud SQL PostgreSQL instance is set to 'on'</td>
            <td>Enabling the log_connections setting causes each attempted connection to the server to be logged, along with successful completion of client authentication. This parameter cannot be changed after the session starts.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_connections" and Value eq "on" ] </td>
          </tr>
          
          <tr num="250">
            <!-- <td>250</td> -->
            <td>Ensure that the 'log_disconnections' database flag for Cloud SQL PostgreSQL instance is set to 'on'</td>
            <td>Enabling the log_disconnections setting logs the end of each session, including the session duration.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_disconnections" and Value eq "on" ] </td>
          </tr>
          
          <tr num="251">
            <!-- <td>251</td> -->
            <td>Ensure 'log_statement' Database Flag for Cloud SQL PostgreSQL instance is set appropriately</td>
            <td>The value of log_statement flag determined the SQL statements that are logged. Valid values are none, ddl, mod, all. The value ddl logs all data definition statements. The value mod logs all ddl statements, plus data-modifying statements.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_statement" and Value neq "none" ] </td>
          </tr>
          
          <tr num="252">
            <!-- <td>252</td> -->
            <td>Ensure 'log_hostname' database flag for Cloud SQL PostgreSQL instance is set appropriately</td>
            <td>PostgreSQL logs only the IP address of the connecting hosts. The log_hostname flag controls the logging of hostnames in addition to the IP addresses logged. The performance hit is dependent on the configuration of the environment and the host name resolution setup.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_hostname" and Value eq "off" ] </td>
          </tr>
          
          <tr num="253">
            <!-- <td>253</td> -->
            <td>Ensure that the 'Log_min_messages' database flag for Cloud SQL PostgreSQL instance is set to at least 'Warning'</td>
            <td>The log_min_messages flag defines the minimum message severity level that is considered as an error statement. Messages for error statements are logged with the SQL statement. Valid values include DEBUG5, DEBUG4, DEBUG3, DEBUG2, DEBUG1, INFO, NOTICE, WARNING, ERROR, LOG, FATAL, and PANIC. Each severity level includes the subsequent levels mentioned above. ERROR is considered the best practice setting. Changes should only be made in accordance with the organization's logging policy.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_min_messages" and Value in ("debug5", "debug4", "debug3", "debug2", "debug1", "info", "notice", "warning", "error", "log", "fatal", "panic")] </td>
          </tr>
          
          <tr num="254">
            <!-- <td>254</td> -->
            <td>Ensure 'log_min_error_statement' database flag for Cloud SQL PostgreSQL instance is set to 'Error' or stricter</td>
            <td>The log_min_error_statement flag defines the minimum message severity level that are considered as an error statement. Messages for error statements are logged with the SQL statement. Valid values include DEBUG5, DEBUG4, DEBUG3, DEBUG2, DEBUG1, INFO, NOTICE, WARNING, ERROR, LOG, FATAL, and PANIC. Each severity level includes the subsequent levels mentioned above. Ensure a value of ERROR or stricter is set.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_min_error_statement" and Value in ("debug5", "debug4", "debug3", "debug2", "debug1", "info", "notice", "warning", "error")] </td>
          </tr>
          
          <tr num="255">
            <!-- <td>255</td> -->
            <td>Ensure that the 'log_min_duration_statement' database flag for Cloud SQL PostgreSQL instance is set to '-1' (disabled)</td>
            <td>The log_min_duration_statement flag defines the minimum amount of execution time of a statement in milliseconds where the total duration of the statement is logged. Ensure that log_min_duration_statement is disabled, i.e., a value of -1 is set.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_min_duration_statement" and Value eq "-1" ] </td>
          </tr>
          
          <tr num="256">
            <!-- <td>256</td> -->
            <td>Ensure that 'cloudsql.enable_pgaudit' database flag for each Cloud Sql Postgresql instance is set to 'on' for centralized logging</td>
            <td>Ensure cloudsql.enable_pgaudit database flag for Cloud SQL PostgreSQL instance is set to on to allow for centralized logging.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "cloudsql.enable_pgaudit" and Value eq "on" ] </td>
          </tr>
          
          <tr num="257">
            <!-- <td>257</td> -->
            <td>Ensure 'external scripts enabled' database flag for Cloud SQL SQL Server instance is set to 'off</td>
            <td>It is recommended to set external scripts enabled database flag for Cloud SQL SQL Server instance to off</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "external scripts enabled" and Value eq "off" ] </td>
          </tr>
          
          <tr num="258">
            <!-- <td>258</td> -->
            <td>Ensure 'cross db ownership chaining' database flag for Cloud SQL SQL Server instance is set to 'off'</td>
            <td>It is recommended to set cross db ownership chaining database flag for Cloud SQL SQL Server instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "cross db ownership chaining" and Value eq "off" ] </td>
          </tr>
          
          <tr num="259">
            <!-- <td>259</td> -->
            <td>Ensure 'user connections' database flag for Cloud SQL SQL Server instance is set as appropriate</td>
            <td>It is recommended to set user connections database flag for Cloud SQL SQL Server instance according organization-defined value.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "user connections" and Value neq "0" ] </td>
          </tr>
          
          <tr num="260">
            <!-- <td>260</td> -->
            <td>Ensure 'user options' database flag for Cloud SQL SQL Server instance is not configured</td>
            <td>It is recommended that, user options database flag for Cloud SQL SQL Server instance should not be configured.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should not have Settings . DatabaseFlags with [ Name eq "user options" ] </td>
          </tr>
          
          <tr num="261">
            <!-- <td>261</td> -->
            <td>Ensure 'remote access' database flag for Cloud SQL SQL Server instance is set to 'off'</td>
            <td>It is recommended to set remote access database flag for Cloud SQL SQL Server instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "remote access" and Value eq "off" ] </td>
          </tr>
          
          <tr num="262">
            <!-- <td>262</td> -->
            <td>Ensure '3625 (trace flag)' database flag for Cloud SQL SQL Server instance is set to 'off'</td>
            <td>It is recommended to set 3625 (trace flag) database flag for Cloud SQL SQL Server instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "3625" and Value eq "off" ] </td>
          </tr>
          
          <tr num="263">
            <!-- <td>263</td> -->
            <td>Ensure that the 'contained database authentication' database flag for Cloud SQL on the SQL Server instance is set to 'off'</td>
            <td>It is recommended to set contained database authentication database flag for Cloud SQL on the SQL Server instance is set to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "contained database authentication" and Value eq "off" ] </td>
          </tr>
          
          <tr num="264">
            <!-- <td>264</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="265">
            <!-- <td>265</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="266">
            <!-- <td>266</td> -->
            <td>Ensure that Cloud SQL database instances do not have public IPs</td>
            <td>It is recommended to configure Second Generation Sql instance to use private IPs instead of public IPs.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where InstanceType eq "CLOUD_SQL_INSTANCE" should not have BackendType eq "SECOND_GEN" and IpAddresses with [IpAddress isPublic() or Type eq "PRIMARY" ] </td>
          </tr>
          
          <tr num="267">
            <!-- <td>267</td> -->
            <td>Backups of information: Ensure SQL Instances have Backup enabled</td>
            <td>Enable database backups on mission-critical systems.Lack of backups can result in permanent data loss if database is lost or corrupted.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . BackupConfiguration . Enabled eq false </td>
          </tr>
          
          <tr num="268">
            <!-- <td>268</td> -->
            <td>Ensure that BigQuery datasets are not anonymously or publicly accessible</td>
            <td>It is recommended that the IAM policy on BigQuery datasets does not allow anonymous and/or public access.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ SpecialGroup eq "allAuthenticatedUsers" or SpecialGroup eq "allUsers"] </td>
          </tr>
          
          <tr num="269">
            <!-- <td>269</td> -->
            <td> Ensure that all BigQuery Tables are encrypted with Customer- managed encryption key (CMEK)</td>
            <td>BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys. The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys. This is seamless and do not require any additional input from the user. However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets. If CMEK is used, the CMEK is used to encrypt the data encryption keys instead of using google-managed encryption keys.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should have every Tables with [ encryption . enabled ] </td>
          </tr>
          
          <tr num="270">
            <!-- <td>270</td> -->
            <td>Ensure that a Default Customer-managed encryption key (CMEK) is specified for all BigQuery Data Sets</td>
            <td>BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys. The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys. This is seamless and do not require any additional input from the user. However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should have Encryption.Enabled </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GCP-IAM-advanced">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="271">
            <!-- <td>271</td> -->
            <td>Ensure that project's IAM does not have primitive roles</td>
            <td>The Wide-ranging permissions roles should not provide to any account. It is the best practice to give the least privilege needed to limit the impact of a security incident. Apply more granular permissions to the account.</td>
            <td>
            
              ProjectIAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Role . InbuiltRole and Role . Name in ( "editor", "viewer", "owner" ) </td>
          </tr>
          
          <tr num="272">
            <!-- <td>272</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="273">
            <!-- <td>273</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="274">
            <!-- <td>274</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="275">
            <!-- <td>275</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GCP-IAM-essentials">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="276">
            <!-- <td>276</td> -->
            <td>Ensure that 'Account' has 'services enabled'</td>
            <td>Ensure that Account has services enabled </td>
            <td>
            
              Project<br>
            
            </td>
            <td class="code">Project should have Services len ( ) gt 0 </td>
          </tr>
          
          <tr num="277">
            <!-- <td>277</td> -->
            <td>Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level</td>
            <td>It is recommended to assign the Service Account User (iam.serviceAccountUser) and Service Account Token Creator (iam.serviceAccountTokenCreator) roles to a user for a specific service account rather than assigning the role to a user at project level.</td>
            <td>
            
              Identity<br>
            
            </td>
            <td class="code">IAMPolicy where Name eq "iam.serviceAccountUser" or Name eq "iam.serviceAccountTokenCreator" should have Members . UserEmails len() eq 0 </td>
          </tr>
          
          <tr num="278">
            <!-- <td>278</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="279">
            <!-- <td>279</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="280">
            <!-- <td>280</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="281">
            <!-- <td>281</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="282">
            <!-- <td>282</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GCP-compute-advanced">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="283">
            <!-- <td>283</td> -->
            <td>Ensure that Compute instances have Confidential Computing enabled</td>
            <td>Google Cloud encrypts data at-rest and in-transit, but customer data must be decrypted for processing. Confidential Computing is a breakthrough technology which encrypts data in use while it is being processed. Confidential Computing environments keep data encrypted in memory and elsewhere outside the central processing unit (CPU).</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should have ConfidentialComputing </td>
          </tr>
          
          <tr num="284">
            <!-- <td>284</td> -->
            <td>Consider GKE Sandbox for running untrusted workloads</td>
            <td>Use GKE Sandbox to restrict untrusted workloads as an additional layer of protection when running in a multi-tenant environment</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.SandboxConfig.SandboxType eq "gvisor"] </td>
          </tr>
          
          <tr num="285">
            <!-- <td>285</td> -->
            <td>Ensure Image Vulnerability Scanning using GCR Container Analysis or a third party provider</td>
            <td>Scan images stored in Google Container Registry (GCR) for vulnerabilities.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">GCP should have atleast one Service with [ Name eq "containerscanning.googleapis.com" and State eq "ENABLED"] </td>
          </tr>
          
          <tr num="286">
            <!-- <td>286</td> -->
            <td>Ensure the GKE Metadata Server is Enabled</td>
            <td>Running the GKE Metadata Server prevents workloads from accessing sensitive instance metadata and facilitates Workload Identity</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.WorkloadMetadataConfig.NodeMetadata len() gt 0] </td>
          </tr>
          
          <tr num="287">
            <!-- <td>287</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="288">
            <!-- <td>288</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="289">
            <!-- <td>289</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="290">
            <!-- <td>290</td> -->
            <td>Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled </td>
            <td>Disable access to the Kubernetes API from outside the node network if it is not required.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PrivateClusterConfig . EnablePrivateEndpoint and Endpoint isPrivate () </td>
          </tr>
          
          <tr num="291">
            <!-- <td>291</td> -->
            <td>Ensure that 'Virtual Machine Instance Disk' has a 'customer managed encryption key'</td>
            <td>Ensure that Virtual Machine Instance Disk has a customer managed encryption key</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Volume should have DiskEncryptionKey . KMSKey . State eq "ENABLED" </td>
          </tr>
          
          <tr num="292">
            <!-- <td>292</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GCP-compute-essentials">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="293">
            <!-- <td>293</td> -->
            <td>Ensure that instances are not configured to use the default service account</td>
            <td>It is recommended to configure your instance to not use the default Compute Engine service account because it has the Editor role on the project.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Email like "compute@developer\.gserviceaccount\.com$"] </td>
          </tr>
          
          <tr num="294">
            <!-- <td>294</td> -->
            <td>Ensure Compute instances are launched with Shielded VM enabled</td>
            <td>To defend against advanced threats and ensure that the boot loader and firmware on your VMs are signed and untampered, it is recommended that Compute instances are launched with Shielded VM enabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should have ShieldedVM </td>
          </tr>
          
          <tr num="295">
            <!-- <td>295</td> -->
            <td>Ensure clusters are created with Private Nodes</td>
            <td>Disable public IP addresses for cluster nodes, so that they only have private IP addresses. Private Nodes are nodes with no public IP addresses</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PrivateClusterConfig . EnablePrivateNodes </td>
          </tr>
          
          <tr num="296">
            <!-- <td>296</td> -->
            <td>Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled</td>
            <td>Enable Integrity Monitoring for Shielded GKE Nodes to be notified of inconsistencies during the node boot sequence</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.ShieldedInstanceConfig.EnableIntegrityMonitoring ] </td>
          </tr>
          
          <tr num="297">
            <!-- <td>297</td> -->
            <td>Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS</td>
            <td>Encrypt Kubernetes secrets, stored in etcd, at the application-layer using a customer-managed key in Cloud KMS</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have DatabaseEncryption.State eq "ENCRYPTED" and DatabaseEncryption.KeyName neq "" </td>
          </tr>
          
          <tr num="298">
            <!-- <td>298</td> -->
            <td>Ensure legacy Compute Engine instance metadata APIs are Disabled</td>
            <td>Disable the legacy GCE instance metadata APIs for GKE nodes. Under some circumstances, these can be used from within a pod to extract the node's credentials</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.Metadata with [ Name eq "disable-legacy-endpoints" and Value eq "true"] ] </td>
          </tr>
          
          <tr num="299">
            <!-- <td>299</td> -->
            <td>Ensure Pod Security Policy is Enabled and set as appropriate</td>
            <td>Pod Security Policy should be used to prevent privileged containers where possible and enforce namespace and workload configurations</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PodSecurityPolicyConfig.Enabled </td>
          </tr>
          
          <tr num="300">
            <!-- <td>300</td> -->
            <td>Ensure Shielded GKE Nodes are Enabled</td>
            <td>Shielded GKE Nodes provides verifiable integrity via secure boot, virtual trusted platform module (vTPM)-enabled measured boot, and integrity monitoring</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have ShieldedNodes.Enabled </td>
          </tr>
          
          <tr num="301">
            <!-- <td>301</td> -->
            <td>Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled</td>
            <td>Send logs and metrics to a remote aggregator to mitigate the risk of local tampering in the event of a breach</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have ( ( ( LoggingService eq "logging.googleapis.com/kubernetes" ) or ( LoggingService eq "logging.googleapis.com" ) ) and ( ( MonitoringService eq "monitoring.googleapis.com/kubernetes" ) or ( MonitoringService eq "monitoring.googleapis.com" ) ) ) </td>
          </tr>
          
          <tr num="302">
            <!-- <td>302</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="303">
            <!-- <td>303</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="304">
            <!-- <td>304</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="305">
            <!-- <td>305</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
          <tr num="306">
            <!-- <td>306</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="307">
            <!-- <td>307</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="308">
            <!-- <td>308</td> -->
            <td>Ensure VM disks for critical VMs are encrypted with Customer-Supplied Encryption Keys (CSEK)</td>
            <td>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. If you supply your own encryption keys, Google uses your key to protect the Google-generated keys used to encrypt and decrypt your data. By default, Google Compute Engine encrypts all data at rest. Compute Engine handles and manages this encryption for you without any additional actions on your part. However, if you wanted to control and manage this encryption yourself, you can provide your own encryption keys</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Volume where Name notlike "^gke-" should have DiskEncryptionKey . Sha256 len ( ) gt 0 </td>
          </tr>
          
          <tr num="309">
            <!-- <td>309</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GCP-data-storage-advanced">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="310">
            <!-- <td>310</td> -->
            <td>Ensure that a Default Customer-managed encryption key (CMEK) is specified for all BigQuery Data Sets</td>
            <td>BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys. The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys. This is seamless and do not require any additional input from the user. However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should have Encryption.Enabled </td>
          </tr>
          
          <tr num="311">
            <!-- <td>311</td> -->
            <td> Ensure that all BigQuery Tables are encrypted with Customer- managed encryption key (CMEK)</td>
            <td>BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys. The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys. This is seamless and do not require any additional input from the user. However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets. If CMEK is used, the CMEK is used to encrypt the data encryption keys instead of using google-managed encryption keys.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should have every Tables with [ encryption . enabled ] </td>
          </tr>
          
          <tr num="312">
            <!-- <td>312</td> -->
            <td>Ensure that DataProc Cluster has a customer managed encryption key</td>
            <td>Ensure that DataProc Cluster has a customer managed encryption key</td>
            <td>
            
              Dataproc<br>
            
            </td>
            <td class="code">DataprocCluster should have Config . EncryptionConfig . GcePdKmsKeyName </td>
          </tr>
          
          <tr num="313">
            <!-- <td>313</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="314">
            <!-- <td>314</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="315">
            <!-- <td>315</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="316">
            <!-- <td>316</td> -->
            <td>Ensure 'skip_show_database' database flag for Cloud SQL Mysql instance is set to 'on'</td>
            <td>It is recommended to set skip_show_database database flag for Cloud SQL Mysql instance to on</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should have Settings . DatabaseFlags with [ Name eq "skip_show_database" and Value eq "on" ] </td>
          </tr>
          
          <tr num="317">
            <!-- <td>317</td> -->
            <td>Ensure that the 'log_checkpoints' database flag for Cloud SQL PostgreSQL instance is set to 'on'</td>
            <td>Ensure that the log_checkpoints database flag for the Cloud SQL PostgreSQL instance is set to on.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_checkpoints" and Value eq "on" ] </td>
          </tr>
          
          <tr num="318">
            <!-- <td>318</td> -->
            <td>Ensure that the 'log_connections' database flag for Cloud SQL PostgreSQL instance is set to 'on'</td>
            <td>Enabling the log_connections setting causes each attempted connection to the server to be logged, along with successful completion of client authentication. This parameter cannot be changed after the session starts.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_connections" and Value eq "on" ] </td>
          </tr>
          
          <tr num="319">
            <!-- <td>319</td> -->
            <td>Ensure 'log_duration' database flag for Cloud SQL PostgreSQL instance is set to 'on'</td>
            <td>Enabling the log_duration setting causes the duration of each completed statement to be logged. This does not logs the text of the query and thus behaves different from the log_min_duration_statement flag. This parameter cannot be changed after session start.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "POSTGRES" should have Settings . DatabaseFlags with [ Name eq "log_duration" and Value eq "on" ] </td>
          </tr>
          
          <tr num="320">
            <!-- <td>320</td> -->
            <td>Ensure 'remote access' database flag for Cloud SQL SQL Server instance is set to 'off'</td>
            <td>It is recommended to set remote access database flag for Cloud SQL SQL Server instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "remote access" and Value eq "off" ] </td>
          </tr>
          
          <tr num="321">
            <!-- <td>321</td> -->
            <td>Ensure 'user options' database flag for Cloud SQL SQL Server instance is not configured</td>
            <td>It is recommended that, user options database flag for Cloud SQL SQL Server instance should not be configured.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should not have Settings . DatabaseFlags with [ Name eq "user options" ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GCP-data-storage-essentials">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="322">
            <!-- <td>322</td> -->
            <td>Ensure that BigQuery datasets are not anonymously or publicly accessible</td>
            <td>It is recommended that the IAM policy on BigQuery datasets does not allow anonymous and/or public access.</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ SpecialGroup eq "allAuthenticatedUsers" or SpecialGroup eq "allUsers"] </td>
          </tr>
          
          <tr num="323">
            <!-- <td>323</td> -->
            <td>Ensure that 'Bucket' has a 'customer managed encryption key'</td>
            <td>Ensure that Bucket' has a customer managed encryption key</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Encryption eq "Customer-managed key" </td>
          </tr>
          
          <tr num="324">
            <!-- <td>324</td> -->
            <td>Ensure that Cloud Storage buckets have uniform bucket-level access enabled</td>
            <td>It is recommended that uniform bucket-level access is enabled on Cloud Storage buckets.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have IAMConfiguration.UniformBucketLevelAccess </td>
          </tr>
          
          <tr num="325">
            <!-- <td>325</td> -->
            <td>Backups of information: Ensure SQL Instances have Backup enabled</td>
            <td>Enable database backups on mission-critical systems.Lack of backups can result in permanent data loss if database is lost or corrupted.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . BackupConfiguration . Enabled eq false </td>
          </tr>
          
          <tr num="326">
            <!-- <td>326</td> -->
            <td>Ensure that Cloud KMS cryptokeys are not anonymously or publicly accessible</td>
            <td>It is recommended that the IAM policy on Cloud KMS cryptokeys should restrict anonymous and/or public access</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should not have Bindings with [ Members has ("allAuthenticatedUsers") or Members has ("allUsers") ] </td>
          </tr>
          
          <tr num="327">
            <!-- <td>327</td> -->
            <td>Ensure KMS encryption keys are rotated within a period of 90 days</td>
            <td>It is recommended that the KMS encryption keys are rotated within a period of 90 days</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 7776000 and NextRotationTime isEarlierThan (90, "days") </td>
          </tr>
          
          <tr num="328">
            <!-- <td>328</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="329">
            <!-- <td>329</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="330">
            <!-- <td>330</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="331">
            <!-- <td>331</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="332">
            <!-- <td>332</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="333">
            <!-- <td>333</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="334">
            <!-- <td>334</td> -->
            <td>Ensure that the 'contained database authentication' database flag for Cloud SQL on the SQL Server instance is set to 'off'</td>
            <td>It is recommended to set contained database authentication database flag for Cloud SQL on the SQL Server instance is set to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "contained database authentication" and Value eq "off" ] </td>
          </tr>
          
          <tr num="335">
            <!-- <td>335</td> -->
            <td>Ensure 'external scripts enabled' database flag for Cloud SQL SQL Server instance is set to 'off</td>
            <td>It is recommended to set external scripts enabled database flag for Cloud SQL SQL Server instance to off</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "SQLSERVER" should have Settings . DatabaseFlags with [ Name eq "external scripts enabled" and Value eq "off" ] </td>
          </tr>
          
          <tr num="336">
            <!-- <td>336</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="337">
            <!-- <td>337</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="338">
            <!-- <td>338</td> -->
            <td>Identities and credentials: Ensure BigQuery does not have Dataset ACL which grants permission to a Gmail account</td>
            <td>A cloud data warehouse should not allow access to Gmail accounts. Verify that the permissions applied are in line with your business use case.This could expose sensitive data to users outside of your organization.</td>
            <td>
            
              BigQuery<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ UserEmail like "@gmail\.com" ] </td>
          </tr>
          
          <tr num="339">
            <!-- <td>339</td> -->
            <td>Identities and credentials: Ensure BigQuery does not have Dataset ACL which is open to all authenticated users</td>
            <td>A cloud data warehouse should not allow access to all authenticated users. Verify that the permissions applied are in line with your business use case.This could expose sensitive data to users outside of your organization.</td>
            <td>
            
              BigQuery<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ SpecialGroup eq "allAuthenticatedUsers" ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GCP-network-advanced">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="340">
            <!-- <td>340</td> -->
            <td>Enable VPC Flow Logs and Intranode Visibility</td>
            <td>Enable VPC Flow Logs and Intranode Visibility to see pod-level traffic, even for traffic within a worker node</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkConfig . EnableIntraNodeVisibility </td>
          </tr>
          
          <tr num="341">
            <!-- <td>341</td> -->
            <td>Ensure that the 'local_infile' database flag for a Cloud SQL Mysql instance is set to 'off'</td>
            <td>It is recommended to set the local_infile database flag for a Cloud SQL MySQL instance to off.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should have Settings . DatabaseFlags with [ Name eq "local_infile" and Value eq "off" ] </td>
          </tr>
          
          <tr num="342">
            <!-- <td>342</td> -->
            <td>Ensure that Cloud DNS logging is enabled for all VPC networks</td>
            <td>Cloud DNS logging records the queries from the name servers within your VPC to Stackdriver. Logged queries can come from Compute Engine VMs, GKE containers, or other GCP resources provisioned within the VPC</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VPC should have DNSPolicy . enableLogging </td>
          </tr>
          
          <tr num="343">
            <!-- <td>343</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="344">
            <!-- <td>344</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="345">
            <!-- <td>345</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="346">
            <!-- <td>346</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="347">
            <!-- <td>347</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="348">
            <!-- <td>348</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="349">
            <!-- <td>349</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="350">
            <!-- <td>350</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GCP-network-essentials">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="351">
            <!-- <td>351</td> -->
            <td>Communications and control network protection: Ensure FirewallRule doesn't have any rule that allows incoming traffic on all ports</td>
            <td>Exposing all ports adds risk of exposure or compromise for all current and future network services running on the instance. Change firewall rule to only expose required ports.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Ports with [ FromPort eq 0 and ToPort eq 65535 ] ] </td>
          </tr>
          
          <tr num="352">
            <!-- <td>352</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens DNS port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "udp") and Ports with [ ( FromPort lte 53 and ToPort gte 53 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="353">
            <!-- <td>353</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens Telnet port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 23 and ToPort gte 23 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="354">
            <!-- <td>354</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens FTP port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( ( FromPort lte 20 and ToPort gte 20 ) or ( FromPort lte 21 and ToPort gte 21 ) ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="355">
            <!-- <td>355</td> -->
            <td>Ensure that Compute instances do not have public IP addresses</td>
            <td>Compute instances should not be configured to have external IP addresses.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have NetworkInterfaces with [ AccessConfigs len ( ) gt 0 ] </td>
          </tr>
          
          <tr num="356">
            <!-- <td>356</td> -->
            <td>Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled </td>
            <td>Disable access to the Kubernetes API from outside the node network if it is not required.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PrivateClusterConfig . EnablePrivateEndpoint and Endpoint isPrivate () </td>
          </tr>
          
          <tr num="357">
            <!-- <td>357</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="358">
            <!-- <td>358</td> -->
            <td>Ensure that Load Balancers do not have public IP address</td>
            <td>If Load Balancer has a public IP address, then it can have exposure to the Internet. It can increase the likelihood of data exfiltration or compromise for the resources behind this load balancer. Modify the Load Balancer public IP to internal IP.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">ForwardingRule should not have Type eq "INTERNAL" and IP isPublic() </td>
          </tr>
          
          <tr num="359">
            <!-- <td>359</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens MongoDB port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( ( FromPort lte 27017 and ToPort gte 27017 ) or ( FromPort lte 27018 and ToPort gte 27018 ) ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="360">
            <!-- <td>360</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens MsSQL port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 1434 and ToPort gte 1434 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="361">
            <!-- <td>361</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens MySQL port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 3306 and ToPort gte 3306 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="362">
            <!-- <td>362</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="363">
            <!-- <td>363</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="364">
            <!-- <td>364</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="365">
            <!-- <td>365</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="366">
            <!-- <td>366</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens NFS port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "udp", "tcp") and Ports with [ ( ( FromPort lte 111 and ToPort gte 111 ) or ( FromPort lte 2049 and ToPort gte 2049 ) ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="367">
            <!-- <td>367</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens OracleDB port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( ( FromPort lte 1521 and ToPort gte 1521 ) or ( FromPort lte 1630 and ToPort gte 1630 ) ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="368">
            <!-- <td>368</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="369">
            <!-- <td>369</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="370">
            <!-- <td>370</td> -->
            <td>Ensure that Cloud SQL database instances do not have public IPs</td>
            <td>It is recommended to configure Second Generation Sql instance to use private IPs instead of public IPs.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where InstanceType eq "CLOUD_SQL_INSTANCE" should not have BackendType eq "SECOND_GEN" and IpAddresses with [IpAddress isPublic() or Type eq "PRIMARY" ] </td>
          </tr>
          
          <tr num="371">
            <!-- <td>371</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens SSH port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 22 and ToPort gte 22 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="372">
            <!-- <td>372</td> -->
            <td>Ensure Virtual Machine Instances are not exposed to the internet</td>
            <td>Virtual Machine should not have the public IP address. If it is public is have exposure to the Internet which can increase the likelihood of data exfiltration or compromise for this virtual machine. To prevent this remove the public IP address from the access configuration for this virtual machine.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have NetworkInterfaces with [ AccessConfigs with [ NatIP ] ] </td>
          </tr>
          
          <tr num="373">
            <!-- <td>373</td> -->
            <td>Ensure VPC does not have any route to the internet</td>
            <td>If VPC has a route to the Internet, then Exposure to the internet can lead to data exfiltration or compromise for resources in this VPC. Change the configuration of VPC to prevent this.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">Route should not have Network . Mode len () gt 0 and ( DestinationCIDR isPublic ( ) or DestinationCIDR eq 0.0.0.0/0 ) </td>
          </tr>
          
          <tr num="374">
            <!-- <td>374</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens PostGreSQL port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 5432 and ToPort gte 5432 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="375">
            <!-- <td>375</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens RDP port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "udp", "tcp") and Ports with [ ( FromPort lte 3389 and ToPort gte 3389 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="376">
            <!-- <td>376</td> -->
            <td>Ensure FirewallRule does not contain any rule which opens SMTP port to internet</td>
            <td>Opening a port increases risk of exposure or compromise. Review whether the network service needs to be exposed to the world and change the firewall rule to restrict access.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Protocol in ("all", "tcp") and Ports with [ ( FromPort lte 25 and ToPort gte 25 ) ] ] and SourceRanges with [ Value eq 0.0.0.0/0 ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GDPR">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="377">
            <!-- <td>377</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="378">
            <!-- <td>378</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="379">
            <!-- <td>379</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="380">
            <!-- <td>380</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="381">
            <!-- <td>381</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="382">
            <!-- <td>382</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="383">
            <!-- <td>383</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="384">
            <!-- <td>384</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="385">
            <!-- <td>385</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="386">
            <!-- <td>386</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="387">
            <!-- <td>387</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="388">
            <!-- <td>388</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="389">
            <!-- <td>389</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="390">
            <!-- <td>390</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="391">
            <!-- <td>391</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="392">
            <!-- <td>392</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="393">
            <!-- <td>393</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="394">
            <!-- <td>394</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="395">
            <!-- <td>395</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="396">
            <!-- <td>396</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="397">
            <!-- <td>397</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="398">
            <!-- <td>398</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="399">
            <!-- <td>399</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="400">
            <!-- <td>400</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="401">
            <!-- <td>401</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="402">
            <!-- <td>402</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="403">
            <!-- <td>403</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="404">
            <!-- <td>404</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="405">
            <!-- <td>405</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="406">
            <!-- <td>406</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="407">
            <!-- <td>407</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="408">
            <!-- <td>408</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="409">
            <!-- <td>409</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="410">
            <!-- <td>410</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="411">
            <!-- <td>411</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="412">
            <!-- <td>412</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GKE-CISv1.1.0">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="413">
            <!-- <td>413</td> -->
            <td>Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image</td>
            <td>Container-Optimized OS is an operating system image for your Compute Engine VMs that is optimized for running Docker containers. With Container-Optimized OS, you can bring up your Docker containers on Google Cloud Platform quickly, efficiently, and securely.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodeConfig . ImageType eq "COS" </td>
          </tr>
          
          <tr num="414">
            <!-- <td>414</td> -->
            <td>Backups of information: Ensure `Automatic node repair` is enabled for Kubernetes Clusters</td>
            <td>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node. If you disable node auto-repair at any time during the repair process, the in-progress repairs are not cancelled and still complete for any node currently under repair.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoRepair eq True ] </td>
          </tr>
          
          <tr num="415">
            <!-- <td>415</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="416">
            <!-- <td>416</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="417">
            <!-- <td>417</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="418">
            <!-- <td>418</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="419">
            <!-- <td>419</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="420">
            <!-- <td>420</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="421">
            <!-- <td>421</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="422">
            <!-- <td>422</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="423">
            <!-- <td>423</td> -->
            <td>Ensure Image Vulnerability Scanning using GCR Container Analysis or a third party provider</td>
            <td>Scan images stored in Google Container Registry (GCR) for vulnerabilities.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">GCP should have atleast one Service with [ Name eq "containerscanning.googleapis.com" and State eq "ENABLED"] </td>
          </tr>
          
          <tr num="424">
            <!-- <td>424</td> -->
            <td>Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS</td>
            <td>Encrypt Kubernetes secrets, stored in etcd, at the application-layer using a customer-managed key in Cloud KMS</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have DatabaseEncryption.State eq "ENCRYPTED" and DatabaseEncryption.KeyName neq "" </td>
          </tr>
          
          <tr num="425">
            <!-- <td>425</td> -->
            <td>Ensure legacy Compute Engine instance metadata APIs are Disabled</td>
            <td>Disable the legacy GCE instance metadata APIs for GKE nodes. Under some circumstances, these can be used from within a pod to extract the node's credentials</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.Metadata with [ Name eq "disable-legacy-endpoints" and Value eq "true"] ] </td>
          </tr>
          
          <tr num="426">
            <!-- <td>426</td> -->
            <td>Ensure the GKE Metadata Server is Enabled</td>
            <td>Running the GKE Metadata Server prevents workloads from accessing sensitive instance metadata and facilitates Workload Identity</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.WorkloadMetadataConfig.NodeMetadata len() gt 0] </td>
          </tr>
          
          <tr num="427">
            <!-- <td>427</td> -->
            <td>When creating New Clusters - Automate GKE version management using Release Channels </td>
            <td>Subscribe to the Regular or Stable Release Channel to automate version upgrades to the GKE cluster and to reduce version management complexity to the number of features and level of stability required</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have ReleaseChannel.Channel eq "REGULAR" or ReleaseChannel.Channel eq "STABLE"</td>
          </tr>
          
          <tr num="428">
            <!-- <td>428</td> -->
            <td>Ensure Shielded GKE Nodes are Enabled</td>
            <td>Shielded GKE Nodes provides verifiable integrity via secure boot, virtual trusted platform module (vTPM)-enabled measured boot, and integrity monitoring</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have ShieldedNodes.Enabled </td>
          </tr>
          
          <tr num="429">
            <!-- <td>429</td> -->
            <td>Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled</td>
            <td>Enable Integrity Monitoring for Shielded GKE Nodes to be notified of inconsistencies during the node boot sequence</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.ShieldedInstanceConfig.EnableIntegrityMonitoring ] </td>
          </tr>
          
          <tr num="430">
            <!-- <td>430</td> -->
            <td>Ensure Secure Boot for Shielded GKE Nodes is Enabled</td>
            <td>Enable Secure Boot for Shielded GKE Nodes to verify the digital signature of node boot components</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.ShieldedInstanceConfig.EnableSecureBoot ] </td>
          </tr>
          
          <tr num="431">
            <!-- <td>431</td> -->
            <td>Enable VPC Flow Logs and Intranode Visibility</td>
            <td>Enable VPC Flow Logs and Intranode Visibility to see pod-level traffic, even for traffic within a worker node</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkConfig . EnableIntraNodeVisibility </td>
          </tr>
          
          <tr num="432">
            <!-- <td>432</td> -->
            <td>Ensure clusters are created with Private Nodes</td>
            <td>Disable public IP addresses for cluster nodes, so that they only have private IP addresses. Private Nodes are nodes with no public IP addresses</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PrivateClusterConfig . EnablePrivateNodes </td>
          </tr>
          
          <tr num="433">
            <!-- <td>433</td> -->
            <td>Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled</td>
            <td>Send logs and metrics to a remote aggregator to mitigate the risk of local tampering in the event of a breach</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have ( ( ( LoggingService eq "logging.googleapis.com/kubernetes" ) or ( LoggingService eq "logging.googleapis.com" ) ) and ( ( MonitoringService eq "monitoring.googleapis.com/kubernetes" ) or ( MonitoringService eq "monitoring.googleapis.com" ) ) ) </td>
          </tr>
          
          <tr num="434">
            <!-- <td>434</td> -->
            <td>Ensure that Alpha clusters are not used for production workloads</td>
            <td>Alpha clusters are not covered by an SLA and are not production-ready</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have EnableKubernetesAlpha </td>
          </tr>
          
          <tr num="435">
            <!-- <td>435</td> -->
            <td>Ensure Pod Security Policy is Enabled and set as appropriate</td>
            <td>Pod Security Policy should be used to prevent privileged containers where possible and enforce namespace and workload configurations</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PodSecurityPolicyConfig.Enabled </td>
          </tr>
          
          <tr num="436">
            <!-- <td>436</td> -->
            <td>Consider GKE Sandbox for running untrusted workloads</td>
            <td>Use GKE Sandbox to restrict untrusted workloads as an additional layer of protection when running in a multi-tenant environment</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Config.SandboxConfig.SandboxType eq "gvisor"] </td>
          </tr>
          
          <tr num="437">
            <!-- <td>437</td> -->
            <td>Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled </td>
            <td>Disable access to the Kubernetes API from outside the node network if it is not required.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PrivateClusterConfig . EnablePrivateEndpoint and Endpoint isPrivate () </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="HIPAA">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="438">
            <!-- <td>438</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="439">
            <!-- <td>439</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="440">
            <!-- <td>440</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="441">
            <!-- <td>441</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="442">
            <!-- <td>442</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="443">
            <!-- <td>443</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="444">
            <!-- <td>444</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="445">
            <!-- <td>445</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="446">
            <!-- <td>446</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="447">
            <!-- <td>447</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="448">
            <!-- <td>448</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="449">
            <!-- <td>449</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="450">
            <!-- <td>450</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="451">
            <!-- <td>451</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="452">
            <!-- <td>452</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="453">
            <!-- <td>453</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="454">
            <!-- <td>454</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="455">
            <!-- <td>455</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="ISO27K">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="456">
            <!-- <td>456</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="457">
            <!-- <td>457</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="458">
            <!-- <td>458</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="459">
            <!-- <td>459</td> -->
            <td>Baseline security configuration of systems: Ensure Kubernetes Clusters are configured with Labels</td>
            <td>Labels enable users to map their own organizational structures onto system objects in a loosely coupled fashion, without requiring clients to store these mappings. Labels can also be used to apply specific security settings and 'auto configure' objects at creation.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="460">
            <!-- <td>460</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="461">
            <!-- <td>461</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="462">
            <!-- <td>462</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="463">
            <!-- <td>463</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="464">
            <!-- <td>464</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="465">
            <!-- <td>465</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="466">
            <!-- <td>466</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="467">
            <!-- <td>467</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="468">
            <!-- <td>468</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="469">
            <!-- <td>469</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="470">
            <!-- <td>470</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="471">
            <!-- <td>471</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="472">
            <!-- <td>472</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="473">
            <!-- <td>473</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="474">
            <!-- <td>474</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="475">
            <!-- <td>475</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="476">
            <!-- <td>476</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="477">
            <!-- <td>477</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="478">
            <!-- <td>478</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="479">
            <!-- <td>479</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="480">
            <!-- <td>480</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="481">
            <!-- <td>481</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="482">
            <!-- <td>482</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="483">
            <!-- <td>483</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="484">
            <!-- <td>484</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="485">
            <!-- <td>485</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="486">
            <!-- <td>486</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="487">
            <!-- <td>487</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="488">
            <!-- <td>488</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="489">
            <!-- <td>489</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="490">
            <!-- <td>490</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="491">
            <!-- <td>491</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="492">
            <!-- <td>492</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="493">
            <!-- <td>493</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="494">
            <!-- <td>494</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="495">
            <!-- <td>495</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="496">
            <!-- <td>496</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="497">
            <!-- <td>497</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="498">
            <!-- <td>498</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="499">
            <!-- <td>499</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="500">
            <!-- <td>500</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="501">
            <!-- <td>501</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="502">
            <!-- <td>502</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="503">
            <!-- <td>503</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
          <tr num="504">
            <!-- <td>504</td> -->
            <td>Backups of information: Ensure `Automatic node repair` is enabled for Kubernetes Clusters</td>
            <td>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node. If you disable node auto-repair at any time during the repair process, the in-progress repairs are not cancelled and still complete for any node currently under repair.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoRepair eq True ] </td>
          </tr>
          
          <tr num="505">
            <!-- <td>505</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="506">
            <!-- <td>506</td> -->
            <td>Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image</td>
            <td>Container-Optimized OS is an operating system image for your Compute Engine VMs that is optimized for running Docker containers. With Container-Optimized OS, you can bring up your Docker containers on Google Cloud Platform quickly, efficiently, and securely.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodeConfig . ImageType eq "COS" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="507">
            <!-- <td>507</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="508">
            <!-- <td>508</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="509">
            <!-- <td>509</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="510">
            <!-- <td>510</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="511">
            <!-- <td>511</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="512">
            <!-- <td>512</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="513">
            <!-- <td>513</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="514">
            <!-- <td>514</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="515">
            <!-- <td>515</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="516">
            <!-- <td>516</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="517">
            <!-- <td>517</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="518">
            <!-- <td>518</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="519">
            <!-- <td>519</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="520">
            <!-- <td>520</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="521">
            <!-- <td>521</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="522">
            <!-- <td>522</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="523">
            <!-- <td>523</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="524">
            <!-- <td>524</td> -->
            <td>Identities and credentials: Ensure BigQuery does not have Dataset ACL which is open to all authenticated users</td>
            <td>A cloud data warehouse should not allow access to all authenticated users. Verify that the permissions applied are in line with your business use case.This could expose sensitive data to users outside of your organization.</td>
            <td>
            
              BigQuery<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ SpecialGroup eq "allAuthenticatedUsers" ] </td>
          </tr>
          
          <tr num="525">
            <!-- <td>525</td> -->
            <td>Identities and credentials: Ensure BigQuery does not have Dataset ACL which grants permission to a Gmail account</td>
            <td>A cloud data warehouse should not allow access to Gmail accounts. Verify that the permissions applied are in line with your business use case.This could expose sensitive data to users outside of your organization.</td>
            <td>
            
              BigQuery<br>
            
            </td>
            <td class="code">BigqueryDataset should not have DatasetACL with [ UserEmail like "@gmail\.com" ] </td>
          </tr>
          
          <tr num="526">
            <!-- <td>526</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="527">
            <!-- <td>527</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="528">
            <!-- <td>528</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="529">
            <!-- <td>529</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="530">
            <!-- <td>530</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="531">
            <!-- <td>531</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="532">
            <!-- <td>532</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="533">
            <!-- <td>533</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="534">
            <!-- <td>534</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="535">
            <!-- <td>535</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="536">
            <!-- <td>536</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="537">
            <!-- <td>537</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="538">
            <!-- <td>538</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="539">
            <!-- <td>539</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="540">
            <!-- <td>540</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="541">
            <!-- <td>541</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="542">
            <!-- <td>542</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="543">
            <!-- <td>543</td> -->
            <td>Baseline security configuration of systems: Ensure Kubernetes Clusters are configured with Labels</td>
            <td>Labels enable users to map their own organizational structures onto system objects in a loosely coupled fashion, without requiring clients to store these mappings. Labels can also be used to apply specific security settings and 'auto configure' objects at creation.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="544">
            <!-- <td>544</td> -->
            <td>Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled </td>
            <td>Disable access to the Kubernetes API from outside the node network if it is not required.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have PrivateClusterConfig . EnablePrivateEndpoint and Endpoint isPrivate () </td>
          </tr>
          
          <tr num="545">
            <!-- <td>545</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
          <tr num="546">
            <!-- <td>546</td> -->
            <td>Backups of information: Ensure `Automatic node repair` is enabled for Kubernetes Clusters</td>
            <td>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node. If you disable node auto-repair at any time during the repair process, the in-progress repairs are not cancelled and still complete for any node currently under repair.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoRepair eq True ] </td>
          </tr>
          
          <tr num="547">
            <!-- <td>547</td> -->
            <td>Backups of information: Ensure SQL Instances have Backup enabled</td>
            <td>Enable database backups on mission-critical systems.Lack of backups can result in permanent data loss if database is lost or corrupted.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . BackupConfiguration . Enabled eq false </td>
          </tr>
          
          <tr num="548">
            <!-- <td>548</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="549">
            <!-- <td>549</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="550">
            <!-- <td>550</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="551">
            <!-- <td>551</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="552">
            <!-- <td>552</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="553">
            <!-- <td>553</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="554">
            <!-- <td>554</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="555">
            <!-- <td>555</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="556">
            <!-- <td>556</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="557">
            <!-- <td>557</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="558">
            <!-- <td>558</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="559">
            <!-- <td>559</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="560">
            <!-- <td>560</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="561">
            <!-- <td>561</td> -->
            <td>Communications and control network protection: Ensure FirewallRule doesn't have any rule that allows incoming traffic on all ports</td>
            <td>Exposing all ports adds risk of exposure or compromise for all current and future network services running on the instance. Change firewall rule to only expose required ports.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and Allowed with [ Ports with [ FromPort eq 0 and ToPort eq 65535 ] ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST800-53">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="562">
            <!-- <td>562</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="563">
            <!-- <td>563</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="564">
            <!-- <td>564</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="565">
            <!-- <td>565</td> -->
            <td>Baseline security configuration of systems: Ensure Kubernetes Clusters are configured with Labels</td>
            <td>Labels enable users to map their own organizational structures onto system objects in a loosely coupled fashion, without requiring clients to store these mappings. Labels can also be used to apply specific security settings and 'auto configure' objects at creation.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="566">
            <!-- <td>566</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="567">
            <!-- <td>567</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="568">
            <!-- <td>568</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="569">
            <!-- <td>569</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="570">
            <!-- <td>570</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="571">
            <!-- <td>571</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="572">
            <!-- <td>572</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="573">
            <!-- <td>573</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="574">
            <!-- <td>574</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="575">
            <!-- <td>575</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="576">
            <!-- <td>576</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="577">
            <!-- <td>577</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="578">
            <!-- <td>578</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="579">
            <!-- <td>579</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="580">
            <!-- <td>580</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="581">
            <!-- <td>581</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="582">
            <!-- <td>582</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="583">
            <!-- <td>583</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="584">
            <!-- <td>584</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="585">
            <!-- <td>585</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="586">
            <!-- <td>586</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="587">
            <!-- <td>587</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="588">
            <!-- <td>588</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="589">
            <!-- <td>589</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="590">
            <!-- <td>590</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="591">
            <!-- <td>591</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="592">
            <!-- <td>592</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="593">
            <!-- <td>593</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="594">
            <!-- <td>594</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="595">
            <!-- <td>595</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="596">
            <!-- <td>596</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="597">
            <!-- <td>597</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="598">
            <!-- <td>598</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="599">
            <!-- <td>599</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="600">
            <!-- <td>600</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="601">
            <!-- <td>601</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="602">
            <!-- <td>602</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="603">
            <!-- <td>603</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="604">
            <!-- <td>604</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="605">
            <!-- <td>605</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="606">
            <!-- <td>606</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="607">
            <!-- <td>607</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="608">
            <!-- <td>608</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="609">
            <!-- <td>609</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
          <tr num="610">
            <!-- <td>610</td> -->
            <td>Backups of information: Ensure `Automatic node repair` is enabled for Kubernetes Clusters</td>
            <td>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node. If you disable node auto-repair at any time during the repair process, the in-progress repairs are not cancelled and still complete for any node currently under repair.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoRepair eq True ] </td>
          </tr>
          
          <tr num="611">
            <!-- <td>611</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="612">
            <!-- <td>612</td> -->
            <td>Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image</td>
            <td>Container-Optimized OS is an operating system image for your Compute Engine VMs that is optimized for running Docker containers. With Container-Optimized OS, you can bring up your Docker containers on Google Cloud Platform quickly, efficiently, and securely.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodeConfig . ImageType eq "COS" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="PCI">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="613">
            <!-- <td>613</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="614">
            <!-- <td>614</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="615">
            <!-- <td>615</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="616">
            <!-- <td>616</td> -->
            <td>Baseline security configuration of systems: Ensure Kubernetes Clusters are configured with Labels</td>
            <td>Labels enable users to map their own organizational structures onto system objects in a loosely coupled fashion, without requiring clients to store these mappings. Labels can also be used to apply specific security settings and 'auto configure' objects at creation.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="617">
            <!-- <td>617</td> -->
            <td>Remote access: Ensure oslogin is enabled for a Project</td>
            <td>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Project . ComputeInfo . CommonInstanceMetadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)true" ] and no Metadata . Items with [ Key eq "enable-oslogin" and Value like "(?i)false" ] </td>
          </tr>
          
          <tr num="618">
            <!-- <td>618</td> -->
            <td>Identities and credentials: Ensure that there are only GCP-managed service account keys for each service account</td>
            <td>User managed service account should not have user managed keys. Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should not have Email like "iam\.gserviceaccount\.com$" and Keys len ( ) gt 1 </td>
          </tr>
          
          <tr num="619">
            <!-- <td>619</td> -->
            <td>Identities and credentials: Ensure user-managed/external keys for service accounts are rotated every 90 days or less</td>
            <td>Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests that you make to Google cloud services accessible to that particular Service account. It is recommended that all Service Account keys are regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">ServiceAccount should have every Keys with [ Validity . AfterTime isLaterThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="620">
            <!-- <td>620</td> -->
            <td>Identities and credentials: Ensure Encryption keys are rotated within a period of 365 days</td>
            <td>A key is used to protect some corpus of data. You could encrypt a collection of files with the same key, and people with decrypt permissions on that key would be able to decrypt those files. Hence it's necessary to make sure the rotation period is set to a specific time.</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should have RotationPeriod lte 31536000 and NextRotationTime isEarlierThan (365, "days") </td>
          </tr>
          
          <tr num="621">
            <!-- <td>621</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning KMS related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data that that user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered a best practice. Any user(s) should not have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/cloudkms.admin" ] and Roles with [ id in ("roles/cloudkms.cryptoKeyDecrypter", "roles/cloudkms.cryptoKeyEncrypter", "roles/cloudkms.cryptoKeyEncrypterDecrypter" ) ] ) </td>
          </tr>
          
          <tr num="622">
            <!-- <td>622</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="623">
            <!-- <td>623</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="624">
            <!-- <td>624</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="625">
            <!-- <td>625</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="626">
            <!-- <td>626</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="627">
            <!-- <td>627</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="628">
            <!-- <td>628</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="629">
            <!-- <td>629</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="630">
            <!-- <td>630</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="631">
            <!-- <td>631</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="632">
            <!-- <td>632</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="633">
            <!-- <td>633</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="634">
            <!-- <td>634</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="635">
            <!-- <td>635</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="636">
            <!-- <td>636</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="637">
            <!-- <td>637</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="638">
            <!-- <td>638</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="639">
            <!-- <td>639</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="640">
            <!-- <td>640</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="641">
            <!-- <td>641</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="642">
            <!-- <td>642</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="643">
            <!-- <td>643</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="644">
            <!-- <td>644</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="645">
            <!-- <td>645</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="646">
            <!-- <td>646</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="647">
            <!-- <td>647</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="648">
            <!-- <td>648</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="649">
            <!-- <td>649</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="650">
            <!-- <td>650</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="651">
            <!-- <td>651</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="652">
            <!-- <td>652</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="653">
            <!-- <td>653</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="654">
            <!-- <td>654</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="655">
            <!-- <td>655</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="656">
            <!-- <td>656</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="657">
            <!-- <td>657</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="658">
            <!-- <td>658</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="659">
            <!-- <td>659</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="660">
            <!-- <td>660</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
          <tr num="661">
            <!-- <td>661</td> -->
            <td>Backups of information: Ensure `Automatic node repair` is enabled for Kubernetes Clusters</td>
            <td>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node. If you disable node auto-repair at any time during the repair process, the in-progress repairs are not cancelled and still complete for any node currently under repair.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoRepair eq True ] </td>
          </tr>
          
          <tr num="662">
            <!-- <td>662</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="663">
            <!-- <td>663</td> -->
            <td>Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image</td>
            <td>Container-Optimized OS is an operating system image for your Compute Engine VMs that is optimized for running Docker containers. With Container-Optimized OS, you can bring up your Docker containers on Google Cloud Platform quickly, efficiently, and securely.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodeConfig . ImageType eq "COS" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="SOC2">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="664">
            <!-- <td>664</td> -->
            <td>Identities and credentials: Ensure that Cloud Storage bucket is not anonymously or publicly accessible</td>
            <td>Allowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should not have Policies with [ Members . AllUsers eq True or Members . AllAuthenticatedUsers eq True ] </td>
          </tr>
          
          <tr num="665">
            <!-- <td>665</td> -->
            <td>Identities and credentials: Ensure that Cloud SQL database Instances are not open to the world</td>
            <td>To minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it. Authorized networks should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should not have Settings . IpConfiguration . AuthorizedNetworks with [ CIDR eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="666">
            <!-- <td>666</td> -->
            <td>Identities and credentials: Ensure that MySQL Database Instance does not allows root login from any Host</td>
            <td>When root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance where DatabaseType eq "MYSQL" should not have Users with [ Name eq "root" and Host in ("%", "0.0.0.0", "/0") ] </td>
          </tr>
          
          <tr num="667">
            <!-- <td>667</td> -->
            <td>Baseline security configuration of systems: Ensure Kubernetes Clusters are configured with Labels</td>
            <td>Labels enable users to map their own organizational structures onto system objects in a loosely coupled fashion, without requiring clients to store these mappings. Labels can also be used to apply specific security settings and 'auto configure' objects at creation.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="668">
            <!-- <td>668</td> -->
            <td>Data-in-transit is protected: Ensure that Cloud SQL database instance requires all incoming connections to use SSL</td>
            <td>SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 Instances.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SqlInstance should have Settings . IpConfiguration . RequireSsl eq True </td>
          </tr>
          
          <tr num="669">
            <!-- <td>669</td> -->
            <td>Identities and credentials: Ensure that ServiceAccount has no Admin privileges.</td>
            <td>A service account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved. It's recommended not to use admin access for ServiceAccount.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and ( Role . id in ("roles/editor", "roles/owner") or Role . id like ".*Admin$" ) </td>
          </tr>
          
          <tr num="670">
            <!-- <td>670</td> -->
            <td>Identities and credentials: Ensure that IAM users are not assigned Service Account User role at project level</td>
            <td>It is recommended to assign Service Account User (iam.serviceAccountUser) role to a user for a specific service account rather than assigning the role to a user at project level. A service account is a special Google account that belongs to application or a virtual machine (VM), instead of to an individual end user. Application/VM-Instance uses the service account to call the Google API of a service, so that the users aren't directly involved. In addition to being an identity, a service account is a resource which has IAM policies attached to it. These policies determine who can use the service account. In order to implement least privileges best practices, IAM users should not be assigned Service Account User role at project level. Instead iam.serviceAccountUser role should be assigned to a user for a specific service account giving a user access to the service account.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . ServiceEmails with [ Email like "iam\.gserviceaccount\.com$" ] and Role . id eq "roles/iam.serviceAccountUser" </td>
          </tr>
          
          <tr num="671">
            <!-- <td>671</td> -->
            <td>Identities and credentials: Ensure that Separation of duties is enforced while assigning service account related roles to users</td>
            <td>It is recommended that the principle of 'Separation of Duties' is enforced while assigning service account related roles to users. Built-in/Predefined IAM role Service Account admin allows user/identity to create, delete, manage service account(s). Built-in/Predefined IAM role Service Account User allows user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances. Any user(s) should not have Service Account Admin and Service Account User, both roles assigned at a time.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicyUser should not have ( Roles with [ id eq "roles/iam.serviceAccountAdmin" ] and Roles with [ id eq "roles/iam.serviceAccountUser" ] ) </td>
          </tr>
          
          <tr num="672">
            <!-- <td>672</td> -->
            <td>Identities and credentials: Ensure that instances are not configured to use the default service account with full access to all Cloud APIs</td>
            <td>To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have ServiceAccounts with [ Scopes with [ Value eq "https://www.googleapis.com/auth/cloud-platform" ] ] </td>
          </tr>
          
          <tr num="673">
            <!-- <td>673</td> -->
            <td>Access permissions and authorizations: Ensure Kubernetes web UI / Dashboard is disabled</td>
            <td>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI (Dashboard) is backed by a highly privileged Kubernetes Service Account.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have AddonsConfig . KubernetesDashboard . Disabled eq True </td>
          </tr>
          
          <tr num="674">
            <!-- <td>674</td> -->
            <td>Identities and credentials: Ensure Basic Authentication is disabled on Kubernetes Engine Clusters</td>
            <td>Basic authentication allows a user to authenticate to the cluster with a username and password and it is stored in plain text without any encryption. Disabling Basic authentication will prevent attacks like brute force. Its recommended to use either client certificate or IAM for authentication.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have MasterAuth . Username and MasterAuth . Password </td>
          </tr>
          
          <tr num="675">
            <!-- <td>675</td> -->
            <td>Identities and credentials: Ensure Kubernetes Cluster is created with Client Certificate enabled</td>
            <td>If you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuth . ClientKey </td>
          </tr>
          
          <tr num="676">
            <!-- <td>676</td> -->
            <td>Identities and credentials: Ensure default Service account is not used for Project access in Kubernetes Clusters</td>
            <td>A service account is an identity that an instance or an application can use to run API requests on your behalf. This identity is used to identify applications running on your virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes are given the Compute Engine default service account. This account has broad access by default, making it useful to a wide variety of applications, but it has more permissions than are required to run your Kubernetes Engine cluster.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have NodePools with [ Config . ServiceAccount eq "default" ] </td>
          </tr>
          
          <tr num="677">
            <!-- <td>677</td> -->
            <td>Remote access: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance</td>
            <td>Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance should not have Metadata . Items with [ Key eq "serial-port-enable" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="678">
            <!-- <td>678</td> -->
            <td>Remote access: Ensure "Block Project-wide SSH keys" enabled for VM instances</td>
            <td>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should have Metadata . Items with [ Key eq "block-project-ssh-keys" and Value like "(?i)true" ] </td>
          </tr>
          
          <tr num="679">
            <!-- <td>679</td> -->
            <td>Identities and credentials: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters</td>
            <td>In Kubernetes, authorizers interact by granting a permission if any authorizer grants the permission. The legacy authorizer in Kubernetes Engine grants broad, statically defined permissions. To ensure that RBAC limits permissions correctly, you must disable the legacy authorizer. RBAC has significant security advantages, can help you ensure that users only have access to cluster resources within their own namespace and is now stable in Kubernetes.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should not have LegacyAbac . Enabled eq True </td>
          </tr>
          
          <tr num="680">
            <!-- <td>680</td> -->
            <td>Identities and credentials: Ensure that corporate login credentials are used instead of Gmail accounts</td>
            <td>Gmail accounts are personally created and controllable accounts. Organizations seldom have any control over them. Thus, it is recommended that you use fully managed corporate Google accounts for increased visibility, auditing, and control over access to Cloud Platform resources.</td>
            <td>
            
              IAMPolicy<br>
            
            </td>
            <td class="code">IAMPolicy should not have Members . UserEmails with [ Email like "@gmail\.com$" ] </td>
          </tr>
          
          <tr num="681">
            <!-- <td>681</td> -->
            <td>Audit/log records: Ensure that logging is enabled for Cloud buckets</td>
            <td>By enabling access and storage logs on target Storage buckets, it is possible to capture all events which may affect objects within target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">Bucket should have Logging . LogBucket and Logging . LogObjectPrefix </td>
          </tr>
          
          <tr num="682">
            <!-- <td>682</td> -->
            <td>Audit/log records: Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Monitoring will monitor signals and build operations in your Kubernetes Engine clusters. Stackdriver Monitoring can access metrics about CPU utilization, some disk traffic metrics, network traffic, and uptime information. Stackdriver Monitoring uses the Monitoring agent to access additional system resources and application services in virtual machine instances.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MonitoringService eq "monitoring.googleapis.com" </td>
          </tr>
          
          <tr num="683">
            <!-- <td>683</td> -->
            <td>Audit/log records: Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters</td>
            <td>Stackdriver Logging lets you have Kubernetes Engine automatically collect, process, and store your container and system logs in a dedicated, persistent datastore.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have LoggingService eq "logging.googleapis.com" </td>
          </tr>
          
          <tr num="684">
            <!-- <td>684</td> -->
            <td>Audit/log records: Ensure that Cloud Audit Logging is configured properly across all services and all users from a project</td>
            <td>It is recommended that Cloud Audit Logging is configured to track all Admin activities and read, write access to user data. It is recommended to have effective default audit config configured in such a way that: 1. logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data); 2. audit config is enabled for all the services supported by Data Access audit logs feature; 3. Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.</td>
            <td>
            
              Logging<br>
            
            </td>
            <td class="code">GCP should have atleast one AuditConfigs with [ Service eq "allServices" and AuditLogConfigs with [ LogType eq "DATA_READ" ] and AuditLogConfigs with [ LogType eq "DATA_WRITE" ] and AuditLogConfigs with [ LogType eq "ADMIN_READ" ] ] and every AuditConfigs with [ HasExemptedMembers eq False ] </td>
          </tr>
          
          <tr num="685">
            <!-- <td>685</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Project Ownership assignments/changes</td>
            <td>In order to prevent unnecessarily project ownership assignments to users/service- accounts and further misuses of project and resources, all roles/Owner assignments should be monitored. Project Ownership Having highest level of privileges on a project, to avoid misuse of project resources project ownership assignment/change actions mentioned should be monitored and alerted to concerned recipients.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like "\(\s*protoPayload.serviceName\s*=\s*\"cloudresourcemanager\.googleapis\.com\"\s*\)\s+AND\s+\(\s*ProjectOwnership\s+OR\s+projectOwnerInvitee\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"REMOVE\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)\s+OR\s+\(\s*protoPayload\.serviceData\.policyDelta\.bindingDeltas\.action\s*=\s*\"ADD\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.bindingDeltas\.role\s*=\s*\"roles/owner\"\s*\)" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="686">
            <!-- <td>686</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Audit Configuration Changes</td>
            <td>Admin activity and Data access logs produced by Cloud audit logging enables security analysis, resource change tracking, and compliance auditing. Configuring metric filter and alerts for Audit Configuration Changes ensures recommended state of audit configuration and hence, all the activities in project are audit-able at any point in time.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"SetIamPolicy\"\s+AND\s+protoPayload\.serviceData\.policyDelta\.auditConfigDeltas:\*.*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="687">
            <!-- <td>687</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Custom Role changes</td>
            <td>It is recommended that a metric filter and alarm be established for changes IAM Role creation, deletion and updating activities. Monitoring role creation, deletion and updating activities will help in identifying over-privileged role at early stages.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"iam_role\"\s+AND\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.CreateRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.DeleteRole\"\s+OR\s+protoPayload\.methodName\s*=\s*\"google\.iam\.admin\.v1\.UpdateRole\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="688">
            <!-- <td>688</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC Network Firewall rule changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC Network Firewall rule changes. Monitoring for Create or Update firewall rule events gives insight network access changes and may reduce the time it takes to detect suspicious activity.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_firewall_rule\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.firewalls\.delete\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="689">
            <!-- <td>689</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network route changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network route changes. Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_route\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.routes\.insert\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="690">
            <!-- <td>690</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for VPC network changes</td>
            <td>It is recommended that a metric filter and alarm be established for VPC network changes. It is possible to have more than 1 VPC within an project, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs.Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*\"gce_network\"\s+AND\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.insert\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.patch\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.delete\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.removePeering\"\s+OR\s+protoPayload\.methodName\s*:\s*\"compute\.networks\.addPeering\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="691">
            <!-- <td>691</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for Cloud Storage IAM permission changes</td>
            <td>It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. Monitoring changes to Cloud Storage bucket permissions may reduce time to detect and correct permissions on sensitive Cloud Storage bucket and objects inside the bucket.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*resource\.type\s*=\s*gcs_bucket\s+AND\s+protoPayload\.methodName\s*=\s*\"storage\.setIamPermissions\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="692">
            <!-- <td>692</td> -->
            <td>Network integrity: Ensure log metric filter and alerts exists for SQL instance configuration changes</td>
            <td>It is recommended that a metric filter and alarm be established for SQL Instance configuration changes. Monitoring changes to Sql Instance configuration changes may reduce time to detect and correct misconfigurations done on sql server. A few of the configurable Options which may impact security posture of a SQL Instance: Enable auto backups and high availability: Misconfiguration may adversely impact Business continuity, Disaster Recovery and High Availability; Authorize networks : Misconfiguration may increase exposure to the untrusted networks</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">GCP should have any LogMetrics with [ Filter like ".*protoPayload\.methodName\s*=\s*\"cloudsql\.instances\.update\".*" and AlertPolicies len ( ) gt 0 and AlertPolicies with [ Enabled eq True ] ] </td>
          </tr>
          
          <tr num="693">
            <!-- <td>693</td> -->
            <td>Communications and control network protection: Ensure the default network does not exist in a project</td>
            <td>To prevent use of default network, a project should not have a default network.The default network has automatically created firewall rules and has pre-fabricated network configuration. Based on your security and networking requirements, you should create your network and delete the default network.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">VPC should not have Name eq "default" and AutoCreateSubnetworks eq True </td>
          </tr>
          
          <tr num="694">
            <!-- <td>694</td> -->
            <td>Communications and control network protection: Ensure legacy networks does not exists for a project</td>
            <td>In order to prevent use of legacy networks, a project should not have a legacy network configured. Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. You cannot create subnetworks in a legacy network or switch from legacy to auto or custom subnet networks. Legacy networks can thus have an impact for high network traffic projects and subject to the single point of contention or failure.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should not have Mode eq "LEGACY" </td>
          </tr>
          
          <tr num="695">
            <!-- <td>695</td> -->
            <td>Communications and control network protection: Ensure that DNSSEC is enabled for Cloud DNS</td>
            <td>Cloud DNS is a fast, reliable and cost-effective Domain Name System that powers millions of domains on the internet. DNSSEC in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should have DnssecConfig . State eq "on" </td>
          </tr>
          
          <tr num="696">
            <!-- <td>696</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for key-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "keySigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="697">
            <!-- <td>697</td> -->
            <td>Communications and control network protection: Ensure that RSASHA1 is not used for zone-signing key in Cloud DNS DNSSEC</td>
            <td>DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for zone signing should be a recommended one and it should not be weak.</td>
            <td>
            
              DNS<br>
            
            </td>
            <td class="code">DNSManagedZone should not have any DnssecConfig . DefaultKeySpecs with [ KeyType eq "zoneSigning" and Algorithm eq "rsasha1" ] </td>
          </tr>
          
          <tr num="698">
            <!-- <td>698</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22 assigned to googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 22 and ToPort gte 22 ] ] </td>
          </tr>
          
          <tr num="699">
            <!-- <td>699</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through RDP with default Port 3389 assigned to a googlecloud firewall rule. We need to restrict generic access from Internet to specific IP Range.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">FirewallRule where Disabled eq False should not have Direction eq "INGRESS" and SourceRanges with [ Value eq 0.0.0.0/0 ] and Allowed with [ Protocol in ("all", "tcp") and Ports with [ FromPort lte 3389 and ToPort gte 3389 ] ] </td>
          </tr>
          
          <tr num="700">
            <!-- <td>700</td> -->
            <td>Communications and control network protection: Ensure Private Google Access is enabled for all subnetwork in VPC Network</td>
            <td>VPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Subnet should have PrivateIPGoogleAccess eq True </td>
          </tr>
          
          <tr num="701">
            <!-- <td>701</td> -->
            <td>Communications and control network protection: Ensure VPC Flow logs is enabled for every subnet in VPC Network</td>
            <td>Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC Subnets. Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows. It is recommended that Flow Logs be enabled for every business critical VPC subnet.</td>
            <td>
            
              VPCnetwork<br>
            
            </td>
            <td class="code">VPC should have every Subnetworks with [ LogEnabled ] </td>
          </tr>
          
          <tr num="702">
            <!-- <td>702</td> -->
            <td>Network integrity: Ensure that IP forwarding is not enabled on Instances</td>
            <td>Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.  Forwarding of data packets should be disabled to prevent data loss or information disclosure.</td>
            <td>
            
              ComputeEngine<br>
            
            </td>
            <td class="code">Instance where not ( Name like "^gke-" and Tags with [ Name eq "goog-gke-node" and Value eq "" ] ) should not have CanIpForward </td>
          </tr>
          
          <tr num="703">
            <!-- <td>703</td> -->
            <td>Access permissions and authorizations: Ensure Master authorized networks is set to Enabled on Kubernetes Engine Clusters</td>
            <td>By Enabling, Master authorized networks blocks untrusted IP addresses from outside Google Cloud Platform and Addresses from inside GCP (such as traffic from Compute Engine VMs) which can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have MasterAuthorizedNetworksConfig . Enabled eq True </td>
          </tr>
          
          <tr num="704">
            <!-- <td>704</td> -->
            <td>Network integrity: Ensure Network policy is enabled on Kubernetes Engine Clusters</td>
            <td>A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NetworkPolicy . Enabled eq True </td>
          </tr>
          
          <tr num="705">
            <!-- <td>705</td> -->
            <td>Network integrity: Ensure Kubernetes Cluster is created with Alias IP ranges enabled</td>
            <td>With Alias IPs ranges enabled, Kubernetes Engine clusters can allocate IP addresses from a CIDR block known to Google Cloud Platform. This makes your cluster more scalable and allows your cluster to better interact with other GCP products and entities. Using Alias IPs has several benefits: Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources; the networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs; firewall controls for Pods can be applied separately from their nodes;  Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have IpAllocationPolicy . UseIpAliases eq True </td>
          </tr>
          
          <tr num="706">
            <!-- <td>706</td> -->
            <td>Baseline security configuration of systems: Ensure Private Google Access is set on Kubernetes Engine Cluster Subnets</td>
            <td>Private Google Access enables your cluster hosts, which have only private IP addresses, to communicate with Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have Subnetwork . PrivateIPGoogleAccess eq true </td>
          </tr>
          
          <tr num="707">
            <!-- <td>707</td> -->
            <td>Backups of information: Ensure `Automatic node repair` is enabled for Kubernetes Clusters</td>
            <td>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node. If you disable node auto-repair at any time during the repair process, the in-progress repairs are not cancelled and still complete for any node currently under repair.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoRepair eq True ] </td>
          </tr>
          
          <tr num="708">
            <!-- <td>708</td> -->
            <td>Software asset inventory: Ensure Automatic node upgrades is enabled on Kubernetes Engine Clusters nodes</td>
            <td>Node auto-upgrades help you keep the nodes in your cluster or node pool up to date with the latest stable version of Kubernetes. Auto-Upgrades use the same update mechanism as manual node upgrades.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodePools with [ Management . AutoUpgrade eq True ] </td>
          </tr>
          
          <tr num="709">
            <!-- <td>709</td> -->
            <td>Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image</td>
            <td>Container-Optimized OS is an operating system image for your Compute Engine VMs that is optimized for running Docker containers. With Container-Optimized OS, you can bring up your Docker containers on Google Cloud Platform quickly, efficiently, and securely.</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">KubernetesCluster should have NodeConfig . ImageType eq "COS" </td>
          </tr>
          
        </table>
      
      &nbsp;
      <br><br>
      <br><br>
      <br><br>
      &nbsp;
    </div>
  </div>
  <script>

  // Sort
  const getCellValue = (tr, idx) => (idx == 0 ) ? tr.getAttribute("num") : ( tr.children[idx].innerText || tr.children[idx].textContent);
  const comparer = (idx, asc) => (a, b) => ((v1, v2) =>
      v1 !== '' && v2 !== '' && !isNaN(v1) && !isNaN(v2) ? v1 - v2 : v1.toString().localeCompare(v2)
      )(getCellValue(asc ? a : b, idx), getCellValue(asc ? b : a, idx));
  document.querySelectorAll('th').forEach(th => th.addEventListener('click', (() => {
      this.asc = !this.asc;
      const table = th.closest('table');
      Array.from(table.querySelectorAll('tr:nth-child(n+2)'))
          .sort(comparer(Array.from(th.parentNode.children).indexOf(th), this.asc))
          .forEach(tr => table.appendChild(tr) );
      $('th').removeClass('headerSortDown').removeClass('headerSortUp')
      if (this.asc) {
        $(th).addClass('headerSortUp')
      } else {
        $(th).addClass('headerSortDown')
      }
  })));

  // Search
  var $rows = $('table.rule_table tr[num]');
  $('#search').keyup(debounce(function() {

    var val = '^(?=.*\\b' + $.trim($(this).val()).split(/\s+/).join('\\b)(?=.*\\b') + ').*$',
      reg = RegExp(val, 'i'),
      text;

    $rows.show().filter(function() {
      text = $(this).text().replace(/\s+/g, ' ');
      return !reg.test(text);
    }).hide();
  }, 300));

  function debounce(func, wait, immediate) {
    var timeout;
    return function() {
      var context = this,
        args = arguments;
      var later = function() {
        timeout = null;
        if (!immediate) func.apply(context, args);
      };
      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) func.apply(context, args);
    };
  };

  // Nav Menu Show/Hide
  function hideRuleTables() {
    $('.rule_table').hide()
    $('.rule_key').removeClass('active')
  }

  function showRuleTable(name) {
    // c) show this table
    if (name == 'ALL') { 
        $('.rule_table').show()
    } else {
        $('.rule_table[data-profile-name="'+name+'"]').show()
    }
  }

  function activateRule(profile_name) {
    // a) hide all the tables with the class 'rule_table'
    hideRuleTables()
    // b) find the table in '.rule_table' with the same 'profile-name' data attribute
    showRuleTable(profile_name)
    if (name == "ALL") { 
        $('.rule_key').addClass('active')
    } else {
        $('.rule_key[data-profile-name="'+profile_name+'"]').addClass('active')
    }
  }

  function initListeners(){
    // 1. iterate over each Rule list item   
    $('.rule_key').each(function(i, obj) {
      var ruleKey = $(obj)
      var ruleName = ruleKey.data('profile-name')
      console.log('adding click listener to ' + ruleName);
      // 2. add a click listener
      ruleKey.click(function(event){
        console.log('received click event for ' + ruleName)
        activateRule(ruleName)
      })
    })
  }
  (function(){
    hideRuleTables()
    var firstRule = $($('.rule_key')[0]).data('profile-name')
    console.log('activating first rule: ', firstRule)
    activateRule(firstRule)
    initListeners()
  })()
  </script>
</body>
</html>