<html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!--
<script src="jquery-3.3.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="rules_styles.css"> 
-->
<style>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
*/
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}

/* Start Netskope styles */

h1 {font-size: 1.8em; font-family: Arial,sans-serif; margin: 1.2rem}
h2 {font-size: 1.6em; font-family: Arial,sans-serif; margin: 1.2rem}
body {font-family: Arial,sans-serif;}

table.rule_table {font-size: 90%}
td.code {font-family: monospace}
th {font-weight: bold; cursor: pointer; }
input { margin-left: 2px; margin-bottom: 5px; padding: 2px 3px; width: 300; }
.headerSortDown:after,
.headerSortUp:after{
    content: ' ';
    position: relative;
    left: 10px;
    border: 7px solid transparent;
}
.headerSortDown:after{
    top: 10px;
    border-top-color: silver;
}
.headerSortUp:after{
    bottom: 15px;
    border-bottom-color: silver;
}
.headerSortDown,
.headerSortUp{
    padding-left: 20px;
}

img[alt="Netskope"] {display:block; margin:1.2rem;}
.container {display: flex; flex-direction: row; padding: 1.5rem;}
._TAB{ display: inline-block; width: 0.4rem; height: 0.1rem; border-top: 0.5rem solid transparent; border-bottom: 0.5rem solid transparent; border-left: 0.5rem solid rgba(125,125,125,0.40); margin-left: 1.4rem; margin-right: 0.1rem;}
.rule_keys {display:inline-block; margin:0.4rem; margin-top:0; padding-right:0.5rem}
.rule_keys>.rule_category:first-child{margin-top:0;}
.rule_keys ul {list-style: none;}
.rule_keys li {cursor: pointer;}
.rule_keys li:hover {background-color: rgba(255,131,0,0.39); }

.rule_keys {position: fixed; top:135; width: 350px}
img {position: fixed; top: 0}
h1 {position: fixed; top: 75}

.rule_tables {flex:3 1 0px;display:inline-block;}
.rule_tables table, .rule_tables th, .rule_tables td { border: 1px solid rgba(150,150,100,0.5);  }
.rule_tables table {table-layout: fixed; width:100%;}
.rule_tables th {background-color: rgba(180,180,180,0.2); padding:0.2rem;}
.rule_tables td {padding: 0.2rem;}
.rule_tables {position: absolute; left: 400; top: 135}

/* rule styles */
.rule_category, .rule_name {display:inline-block;float:none; padding-right:0.2rem;}
.rule_category {font-size:1.3em;width: 100%;background-color: rgba(180,180,180,0.2); margin:0.5rem 0 0.2rem 0;padding:0;}
.rule_category:before, .rule_category:after {display:inline-block; content:''; width:0.4rem;}
.rule_key {padding:0.3rem;padding-left: 1.5rem;}
.rule_key.active {background-color: #ff8300; color:#ffffff;}
.rule_name {width:100%; text-align: left;}
</style>

<title>Azure Predefined Rules</title>
</head>
<body>
  <img src="logo.png" alt="Netskope"/>
  <h1>Azure Predefined Rules</h1>
  <div class="container">
    <div class="rule_keys">
        <ul>
            
            <li class="rule_key" data-profile-name="AZURE-IAM-advanced">
              <span class="rule_name">Netskope Advanced Security profile for AZURE IAM</span>
            </li>
            
            <li class="rule_key" data-profile-name="AZURE-IAM-essentials">
              <span class="rule_name">Netskope Essential Security profile for AZURE IAM</span>
            </li>
            
            <li class="rule_key" data-profile-name="AZURE-compute-advanced">
              <span class="rule_name">Netskope Advanced Security profile for AZURE Compute</span>
            </li>
            
            <li class="rule_key" data-profile-name="AZURE-compute-essentials">
              <span class="rule_name">Netskope Essential Security profile for AZURE Compute</span>
            </li>
            
            <li class="rule_key" data-profile-name="AZURE-data-storage-advanced">
              <span class="rule_name">Netskope Advanced Security profile for AZURE Storage</span>
            </li>
            
            <li class="rule_key" data-profile-name="AZURE-data-storage-essentials">
              <span class="rule_name">Netskope Essential Security profile for AZURE Storage</span>
            </li>
            
            <li class="rule_key" data-profile-name="AZURE-network-advanced">
              <span class="rule_name">Netskope Advanced Security profile for AZURE Networking</span>
            </li>
            
            <li class="rule_key" data-profile-name="AZURE-network-essentials">
              <span class="rule_name">Netskope Essential Security profile for AZURE Networking</span>
            </li>
            
            <li class="rule_key" data-profile-name="BPR">
              <span class="rule_name">Azure Best Practices v1.0.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CCM">
              <span class="rule_name">CSA CCM v3.0.1</span>
            </li>
            
            <li class="rule_key" data-profile-name="CIS">
              <span class="rule_name">CIS Azure Foundations Benchmark v1.0.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CISv1">
              <span class="rule_name">CIS Azure Foundations Benchmark v1.1.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CISv1.3">
              <span class="rule_name">CIS Azure Foundations Benchmark v1.3.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CISv1.4">
              <span class="rule_name">CIS Azure Foundations Benchmark v1.4.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="GDPR">
              <span class="rule_name">GDPR 1996/679 (Azure)</span>
            </li>
            
            <li class="rule_key" data-profile-name="HIPAA">
              <span class="rule_name">HIPAA 1996 (Azure)</span>
            </li>
            
            <li class="rule_key" data-profile-name="ISO27K">
              <span class="rule_name">ISO 27002 (Azure)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST">
              <span class="rule_name">NIST-CSF v1.1 (Azure)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST800-53">
              <span class="rule_name">NIST 800-53 r4 (Azure)</span>
            </li>
            
            <li class="rule_key" data-profile-name="PCI">
              <span class="rule_name">PCI-DSS v3.2.1 (Azure)</span>
            </li>
            
            <li class="rule_key" data-profile-name="SOC2">
              <span class="rule_name">AICPA SOC2 TSC 2017 (Azure)</span>
            </li>
            
            <!--
            <li class="rule_key" data-profile-name="ALL">
              <span class="rule_name">All Rules</span>
            </li>
            -->
        </ul>
        <br><br>
        <!-- 
        -->
        &#x1F50D;<input type="text" id="search" placeholder="Type to search"> 
    </div>
    <div class="rule_tables">
      
        <table id="table" class="rule_table" data-profile-name="AZURE-IAM-advanced">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="1">
            <!-- <td>1</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="2">
            <!-- <td>2</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="3">
            <!-- <td>3</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for App Service is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForAppService </td>
          </tr>
          
          <tr num="4">
            <!-- <td>4</td> -->
            <td>Security Center protection: Ensure that 'Notify about alerts with the following severity' is set to 'High'</td>
            <td>Enables emailing security alerts to the subscription owner or other designated security contact</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AlertNotificationMinimalSeverity eq "High" </td>
          </tr>
          
          <tr num="5">
            <!-- <td>5</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="AZURE-IAM-essentials">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="6">
            <!-- <td>6</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="7">
            <!-- <td>7</td> -->
            <td>Ensure Diagnostic Setting captures appropriate categories</td>
            <td>The diagnostic setting should be configured to log the appropriate activities from the control/management plane</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Subscription should have DiagnosticSettings with [ Logs with [ Category eq "Administrative" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Alert" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Policy" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Security" and Enabled ] ] </td>
          </tr>
          
          <tr num="8">
            <!-- <td>8</td> -->
            <td>Enable role-based access control (RBAC) within Azure Kubernetes Services</td>
            <td>Ensure that RBAC is enabled on all Azure Kubernetes Services Instances</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">AKSCluster should have EnableRBAC </td>
          </tr>
          
          <tr num="9">
            <!-- <td>9</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Policy Assignment</td>
            <td>Create an activity log alert for the Delete Policy Assignment event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "Microsoft.Authorization/policyAssignments/delete" ] ] </td>
          </tr>
          
          <tr num="10">
            <!-- <td>10</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="11">
            <!-- <td>11</td> -->
            <td>Security Center protection: Ensure that Microsoft Defender for Endpoint (WDATP) integration with Microsoft Defender for Cloud is selected</td>
            <td>This setting enables Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have WDATPIntegratedWithSecurityCenter </td>
          </tr>
          
          <tr num="12">
            <!-- <td>12</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="13">
            <!-- <td>13</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="14">
            <!-- <td>14</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="15">
            <!-- <td>15</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="16">
            <!-- <td>16</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="17">
            <!-- <td>17</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="18">
            <!-- <td>18</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="19">
            <!-- <td>19</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="20">
            <!-- <td>20</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="AZURE-compute-advanced">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="21">
            <!-- <td>21</td> -->
            <td>Ensure that 'Tags' are present on 'Kubernetes Cluster'</td>
            <td>Check for tags on Kubernetes clusters</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">AKSCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="22">
            <!-- <td>22</td> -->
            <td>Ensure App Service Authentication is set on Azure App Service</td>
            <td>Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the API app, or authenticate those that have tokens before they reach the API app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have AuthSettings with [ Enabled and UnauthenticatedClientAction neq "AllowAnonymous" ] </td>
          </tr>
          
          <tr num="23">
            <!-- <td>23</td> -->
            <td>Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service</td>
            <td>Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have HttpsOnly </td>
          </tr>
          
          <tr num="24">
            <!-- <td>24</td> -->
            <td>Ensure web app is using the latest version of TLS encryption</td>
            <td>The TLS(Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, such as PCI DSS.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have Configurations with [ MinTLSVersion eq "1.2" ] </td>
          </tr>
          
          <tr num="25">
            <!-- <td>25</td> -->
            <td>Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'</td>
            <td>Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have ClientCertEnabled </td>
          </tr>
          
          <tr num="26">
            <!-- <td>26</td> -->
            <td>Ensure that Register with Azure Active Directory is enabled on App Service</td>
            <td>Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have ADRegistered </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="AZURE-compute-essentials">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="27">
            <!-- <td>27</td> -->
            <td>Ensure Virtual Machines are utilizing Managed Disks</td>
            <td>Migrate BLOB based VHD's to Managed Disks on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have UnmanagedDisks len() eq 0 </td>
          </tr>
          
          <tr num="28">
            <!-- <td>28</td> -->
            <td>Ensure that 'OMS Agent' is enabled for the 'addon profile</td>
            <td>OMS Agent to be enabled in the addon profile</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">AKSCluster should have AddonProfiles . OMSAgent . Enabled eq true </td>
          </tr>
          
          <tr num="29">
            <!-- <td>29</td> -->
            <td>Ensure that Microsoft Defender for Container Registries is set to 'On'</td>
            <td>Turning on Microsoft Defender for Container Registries enables threat detection for Container Registries, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForContainerRegistries </td>
          </tr>
          
          <tr num="30">
            <!-- <td>30</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Kubernetes is set to 'On'</td>
            <td>Turning on Microsoft Defender for Kubernetes enables threat detection for Kubernetes, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForKubernetes </td>
          </tr>
          
          <tr num="31">
            <!-- <td>31</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Servers is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Server, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForServer </td>
          </tr>
          
          <tr num="32">
            <!-- <td>32</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="33">
            <!-- <td>33</td> -->
            <td>Ensure that 'site authentication' is enabled on 'Function app'</td>
            <td>Check for authentication is enabled on Function app</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have every AuthSettings with [ Enabled eq true ] </td>
          </tr>
          
          <tr num="34">
            <!-- <td>34</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="35">
            <!-- <td>35</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="36">
            <!-- <td>36</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="37">
            <!-- <td>37</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="38">
            <!-- <td>38</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="39">
            <!-- <td>39</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="40">
            <!-- <td>40</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="41">
            <!-- <td>41</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="42">
            <!-- <td>42</td> -->
            <td>Ensure that 'Unattached disks' are encrypted with CMK</td>
            <td>Ensure that unattached disks in a subscription are encrypted with a Customer Managed Key</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">Disk where DiskAttachment eq "Unattached" should have Encrypted </td>
          </tr>
          
          <tr num="43">
            <!-- <td>43</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="44">
            <!-- <td>44</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="AZURE-data-storage-advanced">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="45">
            <!-- <td>45</td> -->
            <td>Ensure soft delete is enabled for Azure Storage</td>
            <td>Azure Storage be made recoverable by enabling soft delete configuration. This is to save and recover data when blobs or blob snapshots are deleted</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have SoftDelete . Enabled</td>
          </tr>
          
          <tr num="46">
            <!-- <td>46</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="47">
            <!-- <td>47</td> -->
            <td>SQL Server protection: Ensure that VA setting 'Periodic recurring scans' to 'on' for each SQL server</td>
            <td>Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.RecurringScansState </td>
          </tr>
          
          <tr num="48">
            <!-- <td>48</td> -->
            <td>SQL Server protection: Ensure that VA setting 'Send scan reports to' is configured for a SQL server</td>
            <td>Configure 'Send scan reports to' with email ids of concerned data owners/stakeholders for a critical SQL servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.NotificationEmails len() gt 0 </td>
          </tr>
          
          <tr num="49">
            <!-- <td>49</td> -->
            <td>SQL Server protection: Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account</td>
            <td>Enable Vulnerability Assessment (VA) service scans for critical SQL servers and corresponding SQL databases</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment . StorageAccount neq "" </td>
          </tr>
          
          <tr num="50">
            <!-- <td>50</td> -->
            <td>Ensure SQL server's TDE protector is encrypted with Customer-managed key</td>
            <td>TDE with Customer-managed key support provides increased transparency and control over the TDE Protector increased security with an HSM-backed external service and promotion of separation of duties.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have TDEProtector.kind eq "azurekeyvault" and TDEProtector.serverKeyType eq "AzureKeyVault" and TDEProtector.uri </td>
          </tr>
          
          <tr num="51">
            <!-- <td>51</td> -->
            <td>Ensure server parameter log_connections is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_connections on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_connections like "(?i)on" </td>
          </tr>
          
          <tr num="52">
            <!-- <td>52</td> -->
            <td>Ensure server parameter log_duration is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_duration on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_duration like "(?i)on" </td>
          </tr>
          
          <tr num="53">
            <!-- <td>53</td> -->
            <td>Ensure server parameter log_retention_days is greater than 3 days for PostgreSQL Database Server</td>
            <td>Enable log_retention_days on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_retention_days gte 4 </td>
          </tr>
          
          <tr num="54">
            <!-- <td>54</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="55">
            <!-- <td>55</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="56">
            <!-- <td>56</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="57">
            <!-- <td>57</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="58">
            <!-- <td>58</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="AZURE-data-storage-essentials">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="59">
            <!-- <td>59</td> -->
            <td>Ensure that 'non-public access' to 'CosmosDB'</td>
            <td>Ensure that 'non-public access' to 'CosmosDB'</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">CosmosDB should not have IpRules with [ value isPublic() ] </td>
          </tr>
          
          <tr num="60">
            <!-- <td>60</td> -->
            <td>SQL Server protection: Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled</td>
            <td>Disable access from Azure services to PostgreSQL Database Server</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should not have firewall_rules with [properties.startIpAddress eq "0.0.0.0" and properties.endIpAddress eq "0.0.0.0"] </td>
          </tr>
          
          <tr num="61">
            <!-- <td>61</td> -->
            <td>Ensure storage for critical data are encrypted with Customer Managed Key</td>
            <td>Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EncryptionType eq "Microsoft.Keyvault" </td>
          </tr>
          
          <tr num="62">
            <!-- <td>62</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="63">
            <!-- <td>63</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Cloud Apps (MCAS) Integration with Microsoft Defender for Cloud is Selected</td>
            <td>This setting enables Microsoft Defender for Cloud Apps (MCAS) integration with Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have MCASIntegratedWithSecurityCenter </td>
          </tr>
          
          <tr num="64">
            <!-- <td>64</td> -->
            <td>Ensure that 'OS and Data' disks are encrypted with CMK</td>
            <td>Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK (Customer Managed Keys). Customer Managed keys can be either ADE or Server Side Encryption (SSE)</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk and DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="65">
            <!-- <td>65</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="66">
            <!-- <td>66</td> -->
            <td>SQL Server protection: Ensure that Vulnerability Assessment Setting 'Also send email notifications to admins and subscription owners' is Set for Each SQL server</td>
            <td>Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.EmailSubscriptionAdmins </td>
          </tr>
          
          <tr num="67">
            <!-- <td>67</td> -->
            <td>Ensure the storage container storing the activity logs is not publicly accessible</td>
            <td>The storage account container containing the activity log export should not be publicly accessible</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have StorageContainerPublicAccess eq "None" </td>
          </tr>
          
          <tr num="68">
            <!-- <td>68</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="69">
            <!-- <td>69</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="70">
            <!-- <td>70</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="71">
            <!-- <td>71</td> -->
            <td>Ensure default network access rule for Storage Accounts is set to deny</td>
            <td>Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should not have ACL.DefaultAction eq "Allow" </td>
          </tr>
          
          <tr num="72">
            <!-- <td>72</td> -->
            <td>Ensure 'Trusted Microsoft Services' are Enabled for Storage Account Access</td>
            <td>Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules. These services will then use strong authentication to access the storage account. If the Allow trusted Microsoft services exception is enabled, the following services: Azure Backup, Azure Site Recovery, Azure DevTest Labs, Azure Event Grid, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are granted access to the storage account.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have ACL.Bypass has ( "AzureServices") </td>
          </tr>
          
          <tr num="73">
            <!-- <td>73</td> -->
            <td>Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Databases</td>
            <td>SQL Database Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="74">
            <!-- <td>74</td> -->
            <td>Ensure that Data encryption is set to On on a SQL Database</td>
            <td>Enable Transparent Data Encryption on every SQL Database</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have DataEncryption.TransparentDataEncryptionStatus eq "Enabled" </td>
          </tr>
          
          <tr num="75">
            <!-- <td>75</td> -->
            <td>Ensure audit profile captures all the activities</td>
            <td>The log profile should be configured to export all activities from the control/management</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have Categories has ("Write") and Categories has ("Delete") and Categories has ("Action") </td>
          </tr>
          
          <tr num="76">
            <!-- <td>76</td> -->
            <td>Ensure the log profile captures activity logs for all regions including global</td>
            <td>Configure the log profile to export activities from all Azure supported regions/locations including global.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have AllRegion eq true </td>
          </tr>
          
          <tr num="77">
            <!-- <td>77</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="78">
            <!-- <td>78</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="79">
            <!-- <td>79</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="80">
            <!-- <td>80</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="81">
            <!-- <td>81</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="82">
            <!-- <td>82</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="83">
            <!-- <td>83</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="84">
            <!-- <td>84</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Azure SQL Databases is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Azure SQL database servers, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForAzureSQLDataBaseServers </td>
          </tr>
          
          <tr num="85">
            <!-- <td>85</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Key Vault is set to 'On'</td>
            <td>Turning on Microsoft Defender for Key Vault enables threat detection for Key Vault, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForKeyVault </td>
          </tr>
          
          <tr num="86">
            <!-- <td>86</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for SQL servers on machines is set to 'On'</td>
            <td>Turning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForSQLServersOnMachine </td>
          </tr>
          
          <tr num="87">
            <!-- <td>87</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Storage is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Storage, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForStorage </td>
          </tr>
          
          <tr num="88">
            <!-- <td>88</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="89">
            <!-- <td>89</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="90">
            <!-- <td>90</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="91">
            <!-- <td>91</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="92">
            <!-- <td>92</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="93">
            <!-- <td>93</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Databases</td>
            <td>Enable auditing on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="94">
            <!-- <td>94</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Databases</td>
            <td> SQL Database Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="95">
            <!-- <td>95</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="96">
            <!-- <td>96</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="97">
            <!-- <td>97</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="98">
            <!-- <td>98</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="99">
            <!-- <td>99</td> -->
            <td>Ensure that storage account access keys are periodically regenerated</td>
            <td>Regenerate storage account access keys every 90 days</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have KeyRegenerated </td>
          </tr>
          
          <tr num="100">
            <!-- <td>100</td> -->
            <td>Ensure that 'Threat Detection' is set to 'On' for SQL Databases</td>
            <td>Enable threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="101">
            <!-- <td>101</td> -->
            <td>Ensure that 'Threat Detection Types' is set to 'All' for SQL Databases</td>
            <td>Enable all types of threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="102">
            <!-- <td>102</td> -->
            <td>Ensure that 'Send Alerts to' is set for SQL Databases</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAddresses len() gt 0 </td>
          </tr>
          
          <tr num="103">
            <!-- <td>103</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="104">
            <!-- <td>104</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="105">
            <!-- <td>105</td> -->
            <td>Ensure the key vault is recoverable</td>
            <td>It is recommended the key vault be made recoverable by enabling the Do Not Purge and Soft Delete functions. This is in order to prevent loss of encrypted data including storage accounts, SQL databases, and/or dependent services provided by key vault objects (Keys, Secrets, Certificates) etc., as may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have EnableSoftDelete and EnablePurgeProtection </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="AZURE-network-advanced">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="106">
            <!-- <td>106</td> -->
            <td>Ensure that 'Virtual Network' Integrated with service 'Endpoints'</td>
            <td>Ensure that Virtual Network is Integrated with Service Endpoints</td>
            <td>
            
              VPC<br>
            
            </td>
            <td class="code">VirtualNetwork should have every Subnets with [ EndpointServices len ( ) gt 0 ] </td>
          </tr>
          
          <tr num="107">
            <!-- <td>107</td> -->
            <td>Ensure 'Enforce SSL connection' is set to 'Enabled' for Standard MySQL Database Server</td>
            <td>Enable SSL connection on MYSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">MYSQLServer should have sslEnforcement eq "Enabled" </td>
          </tr>
          
          <tr num="108">
            <!-- <td>108</td> -->
            <td>Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server</td>
            <td>Enable SSL connection on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have sslEnforcement eq "Enabled" </td>
          </tr>
          
          <tr num="109">
            <!-- <td>109</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="110">
            <!-- <td>110</td> -->
            <td>Ensure that 'CORS allowed origin' are present on 'Function App'</td>
            <td>Ensure that FunctionApp has CORS allowed origin</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have every Configurations with [ CORS . AllowedOrigins len () gt 0 ] </td>
          </tr>
          
          <tr num="111">
            <!-- <td>111</td> -->
            <td>Ensure that'Public SSL Cert' is present in 'Function App'</td>
            <td>Ensure that Function App has a Public SSL Cert</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have PublicCertificates len ( ) gt 0 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="AZURE-network-essentials">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="112">
            <!-- <td>112</td> -->
            <td>Ensure LoadBalancer doesnot have public ip</td>
            <td>LoadBalancer frontend ip config should not have public IPs</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">LoadBalancer should have public_ip len() eq 0 </td>
          </tr>
          
          <tr num="113">
            <!-- <td>113</td> -->
            <td>Ensure that UDP Services are restricted from the Internet</td>
            <td>Disable Internet exposed UDP ports on network security groups</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "UDP") and Destination . PortRange with [ ( FromPort lte 22 and ToPort gte 22 ) or ( FromPort lte 53 and ToPort gte 53 ) or ( FromPort lte 67 and ToPort gte 67 ) or ( FromPort lte 80 and ToPort gte 80 ) or ( FromPort lte 123 and ToPort gte 123 ) or ( FromPort lte 161 and ToPort gte 161 ) or ( FromPort lte 389 and ToPort gte 389 ) or ( FromPort lte 443 and ToPort gte 443 ) or ( FromPort lte 520 and ToPort gte 520 ) or ( FromPort lte 547 and ToPort gte 547 ) or ( FromPort lte 1433 and ToPort gte 1433 ) or ( FromPort lte 1521 and ToPort gte 1521 ) or ( FromPort lte 1900 and ToPort gte 1900 ) or ( FromPort lte 3306 and ToPort gte 3306 ) or ( FromPort lte 3389 and ToPort gte 3389 ) or ( FromPort lte 5432 and ToPort gte 5432 ) or ( FromPort lte 27019 and ToPort gte 27017 ) ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="114">
            <!-- <td>114</td> -->
            <td>Ensure server parameter log_checkpoints is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_checkpoints on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_checkpoints like "(?i)on" </td>
          </tr>
          
          <tr num="115">
            <!-- <td>115</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="116">
            <!-- <td>116</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="117">
            <!-- <td>117</td> -->
            <td>Do not allow default Network Security Groups</td>
            <td>Check for Network Security Groups with only default rules, which by default allows all outbound Internet traffic.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should have SecurityRules len() gt 0 and no SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] and SecurityRules with [ Access eq "Deny" and Direction eq "Outbound" and ( ( Destination . PortRange with [ ( FromPort eq 0 and ToPort eq 65535 ) ] ) and ( ( Destination . Type eq "Any" ) or ( Destination . Type eq "IP Addresses" and Destination . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) or ( Destination . Type eq "Service Tag" and Destination . ServiceTag eq "Internet" ) ) ) ] </td>
          </tr>
          
          <tr num="118">
            <!-- <td>118</td> -->
            <td>Ensure that all inbound traffic from the Internet is restricted</td>
            <td>Check Network Security Groups for rules allowing any inbound traffic from the Internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and ( Source . Addresses with [ Prefix isPublic() or Prefix in ( "<nw>/0", "/0") ] ) ) ) ] </td>
          </tr>
          
          <tr num="119">
            <!-- <td>119</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="120">
            <!-- <td>120</td> -->
            <td>Ensure that relational database access is restricted from the Internet</td>
            <td>Ensure that common SQL Database (SQLServer, mySQL, Oracle, Postgres) ports are not allowed inbound access from the internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "UDP", "TCP") and ( Destination . PortRange with [ ( FromPort lte 1433 and ToPort gte 1433 ) or ( FromPort lte 3306 and ToPort gte 3306 ) or ( FromPort lte 1521 and ToPort gte 1521 ) or ( FromPort lte 5432 and ToPort gte 5432 ) ] ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] </td>
          </tr>
          
          <tr num="121">
            <!-- <td>121</td> -->
            <td>Ensure that inbound access from the Internet is restricted</td>
            <td>Make sure Network Security Groups do not allow any inbound access from the Internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "UDP", "TCP") and ( Destination . PortRange with [ ( FromPort eq 0 and ToPort eq 65535 ) ] ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] </td>
          </tr>
          
          <tr num="122">
            <!-- <td>122</td> -->
            <td>Ensure that Network Security Group Flow Log retention period is greater than 90 days</td>
            <td>Network Security Group Flow Logs should be enabled and retention period is set to greater than or equal to 90 days.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should have FlowLog . RetentionPolicy . Days gt 90 and FlowLog . RetentionPolicy . Enabled </td>
          </tr>
          
          <tr num="123">
            <!-- <td>123</td> -->
            <td>Ensure that clear text protocols from the Internet are restricted</td>
            <td>Check Network Security Groups for inbound access of clear-text protocols (telnet, SMTP, POP, IMAP, and SNMP) from the Internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Protocol in ( "*", "TCP" ) and ( Destination . PortRange with [ ( FromPort lte 23 and ToPort gte 23 ) or ( FromPort lte 25 and ToPort gte 25 ) or ( FromPort lte 110 and ToPort gte 110 ) or ( FromPort lte 143 and ToPort gte 143 ) or ( FromPort lte 162 and ToPort gte 161 ) ] ) ) or ( Protocol in ( "*" , "UDP" ) and ( Destination . PortRange with [ ( FromPort lte 162 and ToPort gte 161 ) ] ) ) ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] </td>
          </tr>
          
          <tr num="124">
            <!-- <td>124</td> -->
            <td>Ensure that commonly-attacked ports access are restricted from the Internet</td>
            <td>Prevent inbound access from the Internet to commonly attacked ports (TCP 0, 19, 135-139, 445, 1080, 5900) and (UDP 67, 520, 547, 1900).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Protocol in ( "*", "TCP" ) and ( Destination . PortRange with [ ( FromPort lte 0 and ToPort gte 0 ) or ( FromPort lte 19 and ToPort gte 19 ) or ( FromPort lte 139 and ToPort gte 135 ) or ( FromPort lte 445 and ToPort gte 445 ) or ( FromPort lte 1080 and ToPort gte 1080 ) or ( FromPort lte 5800 and ToPort gte 5800 ) or ( FromPort lte 5900 and ToPort gte 5900) ] ) ) or ( Protocol in ( "*", "UDP" ) and ( Destination . PortRange with [ ( FromPort lte 19 and ToPort gte 19 ) or ( FromPort lte 123 and ToPort gte 123 ) or ( FromPort lte 67 and ToPort gte 67 ) or ( FromPort lte 139 and ToPort gte 135 ) or ( FromPort lte 445 and ToPort gte 445 ) or ( FromPort lte 520 and ToPort gte 520 ) or ( FromPort lte 547 and ToPort gte 547 ) or ( FromPort lte 1900 and ToPort gte 1900 ) ] ) ) ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] </td>
          </tr>
          
          <tr num="125">
            <!-- <td>125</td> -->
            <td>Ensure that FTP access is restricted from the Internet</td>
            <td>Check Network Security Groups for FTP access from the Internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code"> NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and ( Destination . PortRange with [ ( FromPort lte 21 and ToPort gte 20 ) ] ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] </td>
          </tr>
          
          <tr num="126">
            <!-- <td>126</td> -->
            <td>Prevent inbound traffic from the Internet that has spoofed or invalid src IP addresses</td>
            <td>Prevent any inbound traffic from the internet that has unroutable, reserved, or invalid source IP addresses.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Source . Type eq "Any" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/8", "100.64.0.0/10", "127.0.0.0/8", "169.254.0.0/16", "192.0.0.0/24", "192.0.2.0/24", "192.88.99.0/24", "198.18.0.0/15", "198.51.100.0/25", "203.0.113.0/24", "224.0.0.0/4", "240.0.0.0/4", "255.255.255.255/32", "0.0.0.0/0" ) ] ) ) ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="BPR">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="127">
            <!-- <td>127</td> -->
            <td>Ensure that 'OMS Agent' is enabled for the 'addon profile</td>
            <td>OMS Agent to be enabled in the addon profile</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">AKSCluster should have AddonProfiles . OMSAgent . Enabled eq true </td>
          </tr>
          
          <tr num="128">
            <!-- <td>128</td> -->
            <td>Ensure that 'Tags' are present on 'Kubernetes Cluster'</td>
            <td>Check for tags on Kubernetes clusters</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">AKSCluster should have Tags len ( ) gt 0 </td>
          </tr>
          
          <tr num="129">
            <!-- <td>129</td> -->
            <td>Ensure that 'site authentication' is enabled on 'Function app'</td>
            <td>Check for authentication is enabled on Function app</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have every AuthSettings with [ Enabled eq true ] </td>
          </tr>
          
          <tr num="130">
            <!-- <td>130</td> -->
            <td>Ensure that'Public SSL Cert' is present in 'Function App'</td>
            <td>Ensure that Function App has a Public SSL Cert</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have PublicCertificates len ( ) gt 0 </td>
          </tr>
          
          <tr num="131">
            <!-- <td>131</td> -->
            <td>Ensure that 'CORS allowed origin' are present on 'Function App'</td>
            <td>Ensure that FunctionApp has CORS allowed origin</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have every Configurations with [ CORS . AllowedOrigins len () gt 0 ] </td>
          </tr>
          
          <tr num="132">
            <!-- <td>132</td> -->
            <td>Ensure that 'non-public access' to 'CosmosDB'</td>
            <td>Ensure that 'non-public access' to 'CosmosDB'</td>
            <td>
            
              Database<br>
            
            </td>
            <td class="code">CosmosDB should not have IpRules with [ value isPublic() ] </td>
          </tr>
          
          <tr num="133">
            <!-- <td>133</td> -->
            <td>Ensure that 'Virtual Network' Integrated with service 'Endpoints'</td>
            <td>Ensure that Virtual Network is Integrated with Service Endpoints</td>
            <td>
            
              VPC<br>
            
            </td>
            <td class="code">VirtualNetwork should have every Subnets with [ EndpointServices len ( ) gt 0 ] </td>
          </tr>
          
          <tr num="134">
            <!-- <td>134</td> -->
            <td>Ensure LoadBalancer doesnot have public ip</td>
            <td>LoadBalancer frontend ip config should not have public IPs</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">LoadBalancer should have public_ip len() eq 0 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CCM">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="135">
            <!-- <td>135</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="136">
            <!-- <td>136</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="137">
            <!-- <td>137</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="138">
            <!-- <td>138</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="139">
            <!-- <td>139</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="140">
            <!-- <td>140</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="141">
            <!-- <td>141</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="142">
            <!-- <td>142</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="143">
            <!-- <td>143</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="144">
            <!-- <td>144</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="145">
            <!-- <td>145</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="146">
            <!-- <td>146</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="147">
            <!-- <td>147</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="148">
            <!-- <td>148</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="149">
            <!-- <td>149</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="150">
            <!-- <td>150</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="151">
            <!-- <td>151</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="152">
            <!-- <td>152</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="153">
            <!-- <td>153</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="154">
            <!-- <td>154</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="155">
            <!-- <td>155</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="156">
            <!-- <td>156</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="157">
            <!-- <td>157</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="158">
            <!-- <td>158</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="159">
            <!-- <td>159</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="160">
            <!-- <td>160</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="161">
            <!-- <td>161</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="162">
            <!-- <td>162</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="163">
            <!-- <td>163</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="164">
            <!-- <td>164</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="165">
            <!-- <td>165</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="166">
            <!-- <td>166</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="167">
            <!-- <td>167</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="168">
            <!-- <td>168</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="169">
            <!-- <td>169</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="170">
            <!-- <td>170</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="171">
            <!-- <td>171</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="172">
            <!-- <td>172</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="173">
            <!-- <td>173</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="174">
            <!-- <td>174</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="175">
            <!-- <td>175</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="176">
            <!-- <td>176</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="177">
            <!-- <td>177</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="178">
            <!-- <td>178</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="179">
            <!-- <td>179</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="180">
            <!-- <td>180</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="181">
            <!-- <td>181</td> -->
            <td>Ensure that 'Send Alerts to' is set for SQL Databases</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAddresses len() gt 0 </td>
          </tr>
          
          <tr num="182">
            <!-- <td>182</td> -->
            <td>Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Databases</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="183">
            <!-- <td>183</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
          <tr num="184">
            <!-- <td>184</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="185">
            <!-- <td>185</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="186">
            <!-- <td>186</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="187">
            <!-- <td>187</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="188">
            <!-- <td>188</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="189">
            <!-- <td>189</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="190">
            <!-- <td>190</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="191">
            <!-- <td>191</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="192">
            <!-- <td>192</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="193">
            <!-- <td>193</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Databases</td>
            <td>Enable auditing on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="194">
            <!-- <td>194</td> -->
            <td>Ensure that 'Threat Detection' is set to 'On' for SQL Databases</td>
            <td>Enable threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="195">
            <!-- <td>195</td> -->
            <td>Ensure that 'Threat Detection Types' is set to 'All' for SQL Databases</td>
            <td>Enable all types of threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CIS">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="196">
            <!-- <td>196</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="197">
            <!-- <td>197</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="198">
            <!-- <td>198</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="199">
            <!-- <td>199</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="200">
            <!-- <td>200</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="201">
            <!-- <td>201</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="202">
            <!-- <td>202</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="203">
            <!-- <td>203</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="204">
            <!-- <td>204</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="205">
            <!-- <td>205</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="206">
            <!-- <td>206</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="207">
            <!-- <td>207</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="208">
            <!-- <td>208</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="209">
            <!-- <td>209</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="210">
            <!-- <td>210</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="211">
            <!-- <td>211</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="212">
            <!-- <td>212</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="213">
            <!-- <td>213</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="214">
            <!-- <td>214</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="215">
            <!-- <td>215</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="216">
            <!-- <td>216</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="217">
            <!-- <td>217</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="218">
            <!-- <td>218</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="219">
            <!-- <td>219</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="220">
            <!-- <td>220</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="221">
            <!-- <td>221</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="222">
            <!-- <td>222</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="223">
            <!-- <td>223</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="224">
            <!-- <td>224</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="225">
            <!-- <td>225</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="226">
            <!-- <td>226</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="227">
            <!-- <td>227</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="228">
            <!-- <td>228</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="229">
            <!-- <td>229</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Databases</td>
            <td>Enable auditing on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="230">
            <!-- <td>230</td> -->
            <td>Ensure that 'Threat Detection' is set to 'On' for SQL Databases</td>
            <td>Enable threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="231">
            <!-- <td>231</td> -->
            <td>Ensure that 'Threat Detection Types' is set to 'All' for SQL Databases</td>
            <td>Enable all types of threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="232">
            <!-- <td>232</td> -->
            <td>Ensure that 'Send Alerts to' is set for SQL Databases</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAddresses len() gt 0 </td>
          </tr>
          
          <tr num="233">
            <!-- <td>233</td> -->
            <td>Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Databases</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="234">
            <!-- <td>234</td> -->
            <td>Ensure that Data encryption is set to On on a SQL Database</td>
            <td>Enable Transparent Data Encryption on every SQL Database</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have DataEncryption.TransparentDataEncryptionStatus eq "Enabled" </td>
          </tr>
          
          <tr num="235">
            <!-- <td>235</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Databases</td>
            <td> SQL Database Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="236">
            <!-- <td>236</td> -->
            <td>Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Databases</td>
            <td>SQL Database Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="237">
            <!-- <td>237</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="238">
            <!-- <td>238</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="239">
            <!-- <td>239</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="240">
            <!-- <td>240</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="241">
            <!-- <td>241</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="242">
            <!-- <td>242</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="243">
            <!-- <td>243</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="244">
            <!-- <td>244</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="245">
            <!-- <td>245</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="246">
            <!-- <td>246</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="247">
            <!-- <td>247</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="248">
            <!-- <td>248</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="249">
            <!-- <td>249</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="250">
            <!-- <td>250</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="251">
            <!-- <td>251</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="252">
            <!-- <td>252</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="253">
            <!-- <td>253</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="254">
            <!-- <td>254</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="255">
            <!-- <td>255</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="256">
            <!-- <td>256</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="257">
            <!-- <td>257</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
          <tr num="258">
            <!-- <td>258</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="259">
            <!-- <td>259</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="260">
            <!-- <td>260</td> -->
            <td>Ensure that Network Security Group Flow Log retention period is greater than 90 days</td>
            <td>Network Security Group Flow Logs should be enabled and retention period is set to greater than or equal to 90 days.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should have FlowLog . RetentionPolicy . Days gt 90 and FlowLog . RetentionPolicy . Enabled </td>
          </tr>
          
          <tr num="261">
            <!-- <td>261</td> -->
            <td>Ensure that storage account access keys are periodically regenerated</td>
            <td>Regenerate storage account access keys every 90 days</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have KeyRegenerated </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CISv1">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="262">
            <!-- <td>262</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="263">
            <!-- <td>263</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="264">
            <!-- <td>264</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="265">
            <!-- <td>265</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="266">
            <!-- <td>266</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="267">
            <!-- <td>267</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="268">
            <!-- <td>268</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="269">
            <!-- <td>269</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="270">
            <!-- <td>270</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="271">
            <!-- <td>271</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="272">
            <!-- <td>272</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="273">
            <!-- <td>273</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="274">
            <!-- <td>274</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="275">
            <!-- <td>275</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="276">
            <!-- <td>276</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="277">
            <!-- <td>277</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="278">
            <!-- <td>278</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="279">
            <!-- <td>279</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="280">
            <!-- <td>280</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="281">
            <!-- <td>281</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="282">
            <!-- <td>282</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="283">
            <!-- <td>283</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="284">
            <!-- <td>284</td> -->
            <td>Ensure that storage account access keys are periodically regenerated</td>
            <td>Regenerate storage account access keys every 90 days</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have KeyRegenerated </td>
          </tr>
          
          <tr num="285">
            <!-- <td>285</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="286">
            <!-- <td>286</td> -->
            <td>Ensure default network access rule for Storage Accounts is set to deny</td>
            <td>Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should not have ACL.DefaultAction eq "Allow" </td>
          </tr>
          
          <tr num="287">
            <!-- <td>287</td> -->
            <td>Ensure 'Trusted Microsoft Services' are Enabled for Storage Account Access</td>
            <td>Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules. These services will then use strong authentication to access the storage account. If the Allow trusted Microsoft services exception is enabled, the following services: Azure Backup, Azure Site Recovery, Azure DevTest Labs, Azure Event Grid, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are granted access to the storage account.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have ACL.Bypass has ( "AzureServices") </td>
          </tr>
          
          <tr num="288">
            <!-- <td>288</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="289">
            <!-- <td>289</td> -->
            <td>Ensure that AuditActionGroups in auditing policy for a SQL server is set properly</td>
            <td>Configure the AuditActionGroups property to appropriate groups to capture all the critical activities on the SQL Server and all the SQL databases hosted on the SQL server </td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . AuditActionGroup has ("SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP", "FAILED_DATABASE_AUTHENTICATION_GROUP", "BATCH_COMPLETED_GROUP") </td>
          </tr>
          
          <tr num="290">
            <!-- <td>290</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="291">
            <!-- <td>291</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="292">
            <!-- <td>292</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="293">
            <!-- <td>293</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="294">
            <!-- <td>294</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="295">
            <!-- <td>295</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="296">
            <!-- <td>296</td> -->
            <td>Ensure that Data encryption is set to On on a SQL Database</td>
            <td>Enable Transparent Data Encryption on every SQL Database</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have DataEncryption.TransparentDataEncryptionStatus eq "Enabled" </td>
          </tr>
          
          <tr num="297">
            <!-- <td>297</td> -->
            <td>Ensure SQL server's TDE protector is encrypted with Customer-managed key</td>
            <td>TDE with Customer-managed key support provides increased transparency and control over the TDE Protector increased security with an HSM-backed external service and promotion of separation of duties.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have TDEProtector.kind eq "azurekeyvault" and TDEProtector.serverKeyType eq "AzureKeyVault" and TDEProtector.uri </td>
          </tr>
          
          <tr num="298">
            <!-- <td>298</td> -->
            <td>Ensure 'Enforce SSL connection' is set to 'Enabled' for Standard MySQL Database Server</td>
            <td>Enable SSL connection on MYSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">MYSQLServer should have sslEnforcement eq "Enabled" </td>
          </tr>
          
          <tr num="299">
            <!-- <td>299</td> -->
            <td>Ensure server parameter log_checkpoints is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_checkpoints on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_checkpoints like "(?i)on" </td>
          </tr>
          
          <tr num="300">
            <!-- <td>300</td> -->
            <td>Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server</td>
            <td>Enable SSL connection on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have sslEnforcement eq "Enabled" </td>
          </tr>
          
          <tr num="301">
            <!-- <td>301</td> -->
            <td>Ensure server parameter log_connections is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_connections on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_connections like "(?i)on" </td>
          </tr>
          
          <tr num="302">
            <!-- <td>302</td> -->
            <td>Ensure server parameter log_disconnections is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_disconnections on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_disconnections like "(?i)on" </td>
          </tr>
          
          <tr num="303">
            <!-- <td>303</td> -->
            <td>Ensure server parameter log_duration is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_duration on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_duration like "(?i)on" </td>
          </tr>
          
          <tr num="304">
            <!-- <td>304</td> -->
            <td>Ensure server parameter connection_throttling is set to ON for PostgreSQL Database Server</td>
            <td>Enable connection_throttling on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have connection_throttling like "(?i)on" </td>
          </tr>
          
          <tr num="305">
            <!-- <td>305</td> -->
            <td>Ensure server parameter log_retention_days is greater than 3 days for PostgreSQL Database Server</td>
            <td>Enable log_retention_days on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_retention_days gte 4 </td>
          </tr>
          
          <tr num="306">
            <!-- <td>306</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="307">
            <!-- <td>307</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="308">
            <!-- <td>308</td> -->
            <td>Ensure audit profile captures all the activities</td>
            <td>The log profile should be configured to export all activities from the control/management</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have Categories has ("Write") and Categories has ("Delete") and Categories has ("Action") </td>
          </tr>
          
          <tr num="309">
            <!-- <td>309</td> -->
            <td>Ensure the log profile captures activity logs for all regions including global</td>
            <td>Configure the log profile to export activities from all Azure supported regions/locations including global.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have AllRegion eq true </td>
          </tr>
          
          <tr num="310">
            <!-- <td>310</td> -->
            <td>Ensure the storage account containing the container with activity logs is encrypted with BYOK</td>
            <td>The storage account with the activity log export container is configured to use BYOK (Use Your Own Key).</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have StorageAccount.EncryptionType eq "Microsoft.Keyvault" and StorageAccount.KeyVaultUri </td>
          </tr>
          
          <tr num="311">
            <!-- <td>311</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="312">
            <!-- <td>312</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="313">
            <!-- <td>313</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="314">
            <!-- <td>314</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="315">
            <!-- <td>315</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="316">
            <!-- <td>316</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="317">
            <!-- <td>317</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="318">
            <!-- <td>318</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="319">
            <!-- <td>319</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="320">
            <!-- <td>320</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="321">
            <!-- <td>321</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="322">
            <!-- <td>322</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="323">
            <!-- <td>323</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="324">
            <!-- <td>324</td> -->
            <td>Ensure that Network Security Group Flow Log retention period is greater than 90 days</td>
            <td>Network Security Group Flow Logs should be enabled and retention period is set to greater than or equal to 90 days.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should have FlowLog . RetentionPolicy . Days gt 90 and FlowLog . RetentionPolicy . Enabled </td>
          </tr>
          
          <tr num="325">
            <!-- <td>325</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="326">
            <!-- <td>326</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="327">
            <!-- <td>327</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="328">
            <!-- <td>328</td> -->
            <td>Ensure that 'Unattached disks' are encrypted with CMK</td>
            <td>Ensure that unattached disks in a subscription are encrypted with a Customer Managed Key</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">Disk where DiskAttachment eq "Unattached" should have Encrypted </td>
          </tr>
          
          <tr num="329">
            <!-- <td>329</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="330">
            <!-- <td>330</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="331">
            <!-- <td>331</td> -->
            <td>Enable role-based access control (RBAC) within Azure Kubernetes Services</td>
            <td>Ensure that RBAC is enabled on all Azure Kubernetes Services Instances</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">AKSCluster should have EnableRBAC </td>
          </tr>
          
          <tr num="332">
            <!-- <td>332</td> -->
            <td>Ensure App Service Authentication is set on Azure App Service</td>
            <td>Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the API app, or authenticate those that have tokens before they reach the API app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have AuthSettings with [ Enabled and UnauthenticatedClientAction neq "AllowAnonymous" ] </td>
          </tr>
          
          <tr num="333">
            <!-- <td>333</td> -->
            <td>Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service</td>
            <td>Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have HttpsOnly </td>
          </tr>
          
          <tr num="334">
            <!-- <td>334</td> -->
            <td>Ensure web app is using the latest version of TLS encryption</td>
            <td>The TLS(Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, such as PCI DSS.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have Configurations with [ MinTLSVersion eq "1.2" ] </td>
          </tr>
          
          <tr num="335">
            <!-- <td>335</td> -->
            <td>Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'</td>
            <td>Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have ClientCertEnabled </td>
          </tr>
          
          <tr num="336">
            <!-- <td>336</td> -->
            <td>Ensure that Register with Azure Active Directory is enabled on App Service</td>
            <td>Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have ADRegistered </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CISv1.3">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="337">
            <!-- <td>337</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="338">
            <!-- <td>338</td> -->
            <td>Ensure that Microsoft Defender for Container Registries is set to 'On'</td>
            <td>Turning on Microsoft Defender for Container Registries enables threat detection for Container Registries, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForContainerRegistries </td>
          </tr>
          
          <tr num="339">
            <!-- <td>339</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for SQL servers on machines is set to 'On'</td>
            <td>Turning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForSQLServersOnMachine </td>
          </tr>
          
          <tr num="340">
            <!-- <td>340</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for App Service is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForAppService </td>
          </tr>
          
          <tr num="341">
            <!-- <td>341</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Key Vault is set to 'On'</td>
            <td>Turning on Microsoft Defender for Key Vault enables threat detection for Key Vault, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForKeyVault </td>
          </tr>
          
          <tr num="342">
            <!-- <td>342</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Servers is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Server, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForServer </td>
          </tr>
          
          <tr num="343">
            <!-- <td>343</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Azure SQL Databases is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Azure SQL database servers, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForAzureSQLDataBaseServers </td>
          </tr>
          
          <tr num="344">
            <!-- <td>344</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Kubernetes is set to 'On'</td>
            <td>Turning on Microsoft Defender for Kubernetes enables threat detection for Kubernetes, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForKubernetes </td>
          </tr>
          
          <tr num="345">
            <!-- <td>345</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Storage is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Storage, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForStorage </td>
          </tr>
          
          <tr num="346">
            <!-- <td>346</td> -->
            <td>Security Center protection: Ensure that Microsoft Defender for Endpoint (WDATP) integration with Microsoft Defender for Cloud is selected</td>
            <td>This setting enables Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have WDATPIntegratedWithSecurityCenter </td>
          </tr>
          
          <tr num="347">
            <!-- <td>347</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Cloud Apps (MCAS) Integration with Microsoft Defender for Cloud is Selected</td>
            <td>This setting enables Microsoft Defender for Cloud Apps (MCAS) integration with Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have MCASIntegratedWithSecurityCenter </td>
          </tr>
          
          <tr num="348">
            <!-- <td>348</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="349">
            <!-- <td>349</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="350">
            <!-- <td>350</td> -->
            <td>Security Center protection: Ensure that 'Notify about alerts with the following severity' is set to 'High'</td>
            <td>Enables emailing security alerts to the subscription owner or other designated security contact</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AlertNotificationMinimalSeverity eq "High" </td>
          </tr>
          
          <tr num="351">
            <!-- <td>351</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="352">
            <!-- <td>352</td> -->
            <td>Ensure storage for critical data are encrypted with Customer Managed Key</td>
            <td>Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EncryptionType eq "Microsoft.Keyvault" </td>
          </tr>
          
          <tr num="353">
            <!-- <td>353</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="354">
            <!-- <td>354</td> -->
            <td>SQL Server protection: Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account</td>
            <td>Enable Vulnerability Assessment (VA) service scans for critical SQL servers and corresponding SQL databases</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment . StorageAccount neq "" </td>
          </tr>
          
          <tr num="355">
            <!-- <td>355</td> -->
            <td>SQL Server protection: Ensure that VA setting 'Periodic recurring scans' to 'on' for each SQL server</td>
            <td>Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.RecurringScansState </td>
          </tr>
          
          <tr num="356">
            <!-- <td>356</td> -->
            <td>SQL Server protection: Ensure that VA setting 'Send scan reports to' is configured for a SQL server</td>
            <td>Configure 'Send scan reports to' with email ids of concerned data owners/stakeholders for a critical SQL servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.NotificationEmails len() gt 0 </td>
          </tr>
          
          <tr num="357">
            <!-- <td>357</td> -->
            <td>SQL Server protection: Ensure that Vulnerability Assessment Setting 'Also send email notifications to admins and subscription owners' is Set for Each SQL server</td>
            <td>Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.EmailSubscriptionAdmins </td>
          </tr>
          
          <tr num="358">
            <!-- <td>358</td> -->
            <td>SQL Server protection: Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled</td>
            <td>Disable access from Azure services to PostgreSQL Database Server</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should not have firewall_rules with [properties.startIpAddress eq "0.0.0.0" and properties.endIpAddress eq "0.0.0.0"] </td>
          </tr>
          
          <tr num="359">
            <!-- <td>359</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="360">
            <!-- <td>360</td> -->
            <td>Ensure Diagnostic Setting captures appropriate categories</td>
            <td>The diagnostic setting should be configured to log the appropriate activities from the control/management plane</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Subscription should have DiagnosticSettings with [ Logs with [ Category eq "Administrative" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Alert" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Policy" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Security" and Enabled ] ] </td>
          </tr>
          
          <tr num="361">
            <!-- <td>361</td> -->
            <td>Ensure the storage container storing the activity logs is not publicly accessible</td>
            <td>The storage account container containing the activity log export should not be publicly accessible</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have StorageContainerPublicAccess eq "None" </td>
          </tr>
          
          <tr num="362">
            <!-- <td>362</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Policy Assignment</td>
            <td>Create an activity log alert for the Delete Policy Assignment event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "Microsoft.Authorization/policyAssignments/delete" ] ] </td>
          </tr>
          
          <tr num="363">
            <!-- <td>363</td> -->
            <td>Ensure that UDP Services are restricted from the Internet</td>
            <td>Disable Internet exposed UDP ports on network security groups</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "UDP") and Destination . PortRange with [ ( FromPort lte 22 and ToPort gte 22 ) or ( FromPort lte 53 and ToPort gte 53 ) or ( FromPort lte 67 and ToPort gte 67 ) or ( FromPort lte 80 and ToPort gte 80 ) or ( FromPort lte 123 and ToPort gte 123 ) or ( FromPort lte 161 and ToPort gte 161 ) or ( FromPort lte 389 and ToPort gte 389 ) or ( FromPort lte 443 and ToPort gte 443 ) or ( FromPort lte 520 and ToPort gte 520 ) or ( FromPort lte 547 and ToPort gte 547 ) or ( FromPort lte 1433 and ToPort gte 1433 ) or ( FromPort lte 1521 and ToPort gte 1521 ) or ( FromPort lte 1900 and ToPort gte 1900 ) or ( FromPort lte 3306 and ToPort gte 3306 ) or ( FromPort lte 3389 and ToPort gte 3389 ) or ( FromPort lte 5432 and ToPort gte 5432 ) or ( FromPort lte 27019 and ToPort gte 27017 ) ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="364">
            <!-- <td>364</td> -->
            <td>Ensure Virtual Machines are utilizing Managed Disks</td>
            <td>Migrate BLOB based VHD's to Managed Disks on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have UnmanagedDisks len() eq 0 </td>
          </tr>
          
          <tr num="365">
            <!-- <td>365</td> -->
            <td>Ensure that 'OS and Data' disks are encrypted with CMK</td>
            <td>Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK (Customer Managed Keys). Customer Managed keys can be either ADE or Server Side Encryption (SSE)</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk and DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="366">
            <!-- <td>366</td> -->
            <td>Ensure soft delete is enabled for Azure Storage</td>
            <td>Azure Storage be made recoverable by enabling soft delete configuration. This is to save and recover data when blobs or blob snapshots are deleted</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have SoftDelete . Enabled</td>
          </tr>
          
          <tr num="367">
            <!-- <td>367</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="368">
            <!-- <td>368</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="369">
            <!-- <td>369</td> -->
            <td>Ensure that storage account access keys are periodically regenerated</td>
            <td>Regenerate storage account access keys every 90 days</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have KeyRegenerated </td>
          </tr>
          
          <tr num="370">
            <!-- <td>370</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="371">
            <!-- <td>371</td> -->
            <td>Ensure default network access rule for Storage Accounts is set to deny</td>
            <td>Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should not have ACL.DefaultAction eq "Allow" </td>
          </tr>
          
          <tr num="372">
            <!-- <td>372</td> -->
            <td>Ensure 'Trusted Microsoft Services' are Enabled for Storage Account Access</td>
            <td>Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules. These services will then use strong authentication to access the storage account. If the Allow trusted Microsoft services exception is enabled, the following services: Azure Backup, Azure Site Recovery, Azure DevTest Labs, Azure Event Grid, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are granted access to the storage account.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have ACL.Bypass has ( "AzureServices") </td>
          </tr>
          
          <tr num="373">
            <!-- <td>373</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="374">
            <!-- <td>374</td> -->
            <td>Ensure that Data encryption is set to On on a SQL Database</td>
            <td>Enable Transparent Data Encryption on every SQL Database</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have DataEncryption.TransparentDataEncryptionStatus eq "Enabled" </td>
          </tr>
          
          <tr num="375">
            <!-- <td>375</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="376">
            <!-- <td>376</td> -->
            <td>Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server</td>
            <td>Enable SSL connection on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have sslEnforcement eq "Enabled" </td>
          </tr>
          
          <tr num="377">
            <!-- <td>377</td> -->
            <td>Ensure 'Enforce SSL connection' is set to 'Enabled' for Standard MySQL Database Server</td>
            <td>Enable SSL connection on MYSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">MYSQLServer should have sslEnforcement eq "Enabled" </td>
          </tr>
          
          <tr num="378">
            <!-- <td>378</td> -->
            <td>Ensure server parameter log_checkpoints is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_checkpoints on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_checkpoints like "(?i)on" </td>
          </tr>
          
          <tr num="379">
            <!-- <td>379</td> -->
            <td>Ensure server parameter log_connections is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_connections on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_connections like "(?i)on" </td>
          </tr>
          
          <tr num="380">
            <!-- <td>380</td> -->
            <td>Ensure server parameter log_disconnections is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_disconnections on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_disconnections like "(?i)on" </td>
          </tr>
          
          <tr num="381">
            <!-- <td>381</td> -->
            <td>Ensure server parameter connection_throttling is set to ON for PostgreSQL Database Server</td>
            <td>Enable connection_throttling on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have connection_throttling like "(?i)on" </td>
          </tr>
          
          <tr num="382">
            <!-- <td>382</td> -->
            <td>Ensure server parameter log_retention_days is greater than 3 days for PostgreSQL Database Server</td>
            <td>Enable log_retention_days on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_retention_days gte 4 </td>
          </tr>
          
          <tr num="383">
            <!-- <td>383</td> -->
            <td>Ensure SQL server's TDE protector is encrypted with Customer-managed key</td>
            <td>TDE with Customer-managed key support provides increased transparency and control over the TDE Protector increased security with an HSM-backed external service and promotion of separation of duties.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have TDEProtector.kind eq "azurekeyvault" and TDEProtector.serverKeyType eq "AzureKeyVault" and TDEProtector.uri </td>
          </tr>
          
          <tr num="384">
            <!-- <td>384</td> -->
            <td>Ensure the storage account containing the container with activity logs is encrypted with BYOK</td>
            <td>The storage account with the activity log export container is configured to use BYOK (Use Your Own Key).</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have StorageAccount.EncryptionType eq "Microsoft.Keyvault" and StorageAccount.KeyVaultUri </td>
          </tr>
          
          <tr num="385">
            <!-- <td>385</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="386">
            <!-- <td>386</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="387">
            <!-- <td>387</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="388">
            <!-- <td>388</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="389">
            <!-- <td>389</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="390">
            <!-- <td>390</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="391">
            <!-- <td>391</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="392">
            <!-- <td>392</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="393">
            <!-- <td>393</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="394">
            <!-- <td>394</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="395">
            <!-- <td>395</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="396">
            <!-- <td>396</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="397">
            <!-- <td>397</td> -->
            <td>Ensure that Network Security Group Flow Log retention period is greater than 90 days</td>
            <td>Network Security Group Flow Logs should be enabled and retention period is set to greater than or equal to 90 days.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should have FlowLog . RetentionPolicy . Days gt 90 and FlowLog . RetentionPolicy . Enabled </td>
          </tr>
          
          <tr num="398">
            <!-- <td>398</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="399">
            <!-- <td>399</td> -->
            <td>Ensure that 'Unattached disks' are encrypted with CMK</td>
            <td>Ensure that unattached disks in a subscription are encrypted with a Customer Managed Key</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">Disk where DiskAttachment eq "Unattached" should have Encrypted </td>
          </tr>
          
          <tr num="400">
            <!-- <td>400</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="401">
            <!-- <td>401</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="402">
            <!-- <td>402</td> -->
            <td>Ensure the key vault is recoverable</td>
            <td>It is recommended the key vault be made recoverable by enabling the Do Not Purge and Soft Delete functions. This is in order to prevent loss of encrypted data including storage accounts, SQL databases, and/or dependent services provided by key vault objects (Keys, Secrets, Certificates) etc., as may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have EnableSoftDelete and EnablePurgeProtection </td>
          </tr>
          
          <tr num="403">
            <!-- <td>403</td> -->
            <td>Enable role-based access control (RBAC) within Azure Kubernetes Services</td>
            <td>Ensure that RBAC is enabled on all Azure Kubernetes Services Instances</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">AKSCluster should have EnableRBAC </td>
          </tr>
          
          <tr num="404">
            <!-- <td>404</td> -->
            <td>Ensure App Service Authentication is set on Azure App Service</td>
            <td>Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the API app, or authenticate those that have tokens before they reach the API app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have AuthSettings with [ Enabled and UnauthenticatedClientAction neq "AllowAnonymous" ] </td>
          </tr>
          
          <tr num="405">
            <!-- <td>405</td> -->
            <td>Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service</td>
            <td>Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have HttpsOnly </td>
          </tr>
          
          <tr num="406">
            <!-- <td>406</td> -->
            <td>Ensure web app is using the latest version of TLS encryption</td>
            <td>The TLS(Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, such as PCI DSS.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have Configurations with [ MinTLSVersion eq "1.2" ] </td>
          </tr>
          
          <tr num="407">
            <!-- <td>407</td> -->
            <td>Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'</td>
            <td>Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have ClientCertEnabled </td>
          </tr>
          
          <tr num="408">
            <!-- <td>408</td> -->
            <td>Ensure that Register with Azure Active Directory is enabled on App Service</td>
            <td>Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have ADRegistered </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CISv1.4">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="409">
            <!-- <td>409</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="410">
            <!-- <td>410</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Servers is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Server, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForServer </td>
          </tr>
          
          <tr num="411">
            <!-- <td>411</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for App Service is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForAppService </td>
          </tr>
          
          <tr num="412">
            <!-- <td>412</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Azure SQL Databases is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Azure SQL database servers, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForAzureSQLDataBaseServers </td>
          </tr>
          
          <tr num="413">
            <!-- <td>413</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for SQL servers on machines is set to 'On'</td>
            <td>Turning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForSQLServersOnMachine </td>
          </tr>
          
          <tr num="414">
            <!-- <td>414</td> -->
            <td>Azure Defender protection: Ensure that Microsoft Defender for Storage is set to 'On'</td>
            <td>Turning on Azure Defender enables threat detection for Storage, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForStorage </td>
          </tr>
          
          <tr num="415">
            <!-- <td>415</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Kubernetes is set to 'On'</td>
            <td>Turning on Microsoft Defender for Kubernetes enables threat detection for Kubernetes, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForKubernetes </td>
          </tr>
          
          <tr num="416">
            <!-- <td>416</td> -->
            <td>Ensure that Microsoft Defender for Container Registries is set to 'On'</td>
            <td>Turning on Microsoft Defender for Container Registries enables threat detection for Container Registries, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForContainerRegistries </td>
          </tr>
          
          <tr num="417">
            <!-- <td>417</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Key Vault is set to 'On'</td>
            <td>Turning on Microsoft Defender for Key Vault enables threat detection for Key Vault, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">AzureDefender should have AzureDefenderForKeyVault </td>
          </tr>
          
          <tr num="418">
            <!-- <td>418</td> -->
            <td>Security Center protection: Ensure that Microsoft Defender for Endpoint (WDATP) integration with Microsoft Defender for Cloud is selected</td>
            <td>This setting enables Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have WDATPIntegratedWithSecurityCenter </td>
          </tr>
          
          <tr num="419">
            <!-- <td>419</td> -->
            <td>Microsoft Defender for Cloud: Ensure that Microsoft Defender for Cloud Apps (MCAS) Integration with Microsoft Defender for Cloud is Selected</td>
            <td>This setting enables Microsoft Defender for Cloud Apps (MCAS) integration with Microsoft Defender for Cloud.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have MCASIntegratedWithSecurityCenter </td>
          </tr>
          
          <tr num="420">
            <!-- <td>420</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="421">
            <!-- <td>421</td> -->
            <td>Security Center protection: Ensure that 'Notify about alerts with the following severity' is set to 'High'</td>
            <td>Enables emailing security alerts to the subscription owner or other designated security contact</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AlertNotificationMinimalSeverity eq "High" </td>
          </tr>
          
          <tr num="422">
            <!-- <td>422</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="423">
            <!-- <td>423</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="424">
            <!-- <td>424</td> -->
            <td>Ensure that storage account access keys are periodically regenerated</td>
            <td>Regenerate storage account access keys every 90 days</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have KeyRegenerated </td>
          </tr>
          
          <tr num="425">
            <!-- <td>425</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="426">
            <!-- <td>426</td> -->
            <td>Ensure default network access rule for Storage Accounts is set to deny</td>
            <td>Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should not have ACL.DefaultAction eq "Allow" </td>
          </tr>
          
          <tr num="427">
            <!-- <td>427</td> -->
            <td>Ensure 'Trusted Microsoft Services' are Enabled for Storage Account Access</td>
            <td>Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules. These services will then use strong authentication to access the storage account. If the Allow trusted Microsoft services exception is enabled, the following services: Azure Backup, Azure Site Recovery, Azure DevTest Labs, Azure Event Grid, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are granted access to the storage account.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have ACL.Bypass has ( "AzureServices") </td>
          </tr>
          
          <tr num="428">
            <!-- <td>428</td> -->
            <td>Ensure soft delete is enabled for Azure Storage</td>
            <td>Azure Storage be made recoverable by enabling soft delete configuration. This is to save and recover data when blobs or blob snapshots are deleted</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have SoftDelete . Enabled</td>
          </tr>
          
          <tr num="429">
            <!-- <td>429</td> -->
            <td>Ensure storage for critical data are encrypted with Customer Managed Key</td>
            <td>Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EncryptionType eq "Microsoft.Keyvault" </td>
          </tr>
          
          <tr num="430">
            <!-- <td>430</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="431">
            <!-- <td>431</td> -->
            <td>Ensure that Data encryption is set to On on a SQL Database</td>
            <td>Enable Transparent Data Encryption on every SQL Database</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have DataEncryption.TransparentDataEncryptionStatus eq "Enabled" </td>
          </tr>
          
          <tr num="432">
            <!-- <td>432</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="433">
            <!-- <td>433</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="434">
            <!-- <td>434</td> -->
            <td>SQL Server protection: Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account</td>
            <td>Enable Vulnerability Assessment (VA) service scans for critical SQL servers and corresponding SQL databases</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment . StorageAccount neq "" </td>
          </tr>
          
          <tr num="435">
            <!-- <td>435</td> -->
            <td>SQL Server protection: Ensure that VA setting 'Periodic recurring scans' to 'on' for each SQL server</td>
            <td>Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.RecurringScansState </td>
          </tr>
          
          <tr num="436">
            <!-- <td>436</td> -->
            <td>SQL Server protection: Ensure that VA setting 'Send scan reports to' is configured for a SQL server</td>
            <td>Configure 'Send scan reports to' with email ids of concerned data owners/stakeholders for a critical SQL servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.NotificationEmails len() gt 0 </td>
          </tr>
          
          <tr num="437">
            <!-- <td>437</td> -->
            <td>SQL Server protection: Ensure that Vulnerability Assessment Setting 'Also send email notifications to admins and subscription owners' is Set for Each SQL server</td>
            <td>Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have VulnerabilityAssessment.EmailSubscriptionAdmins </td>
          </tr>
          
          <tr num="438">
            <!-- <td>438</td> -->
            <td>Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server</td>
            <td>Enable SSL connection on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have sslEnforcement eq "Enabled" </td>
          </tr>
          
          <tr num="439">
            <!-- <td>439</td> -->
            <td>Ensure 'Enforce SSL connection' is set to 'Enabled' for Standard MySQL Database Server</td>
            <td>Enable SSL connection on MYSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">MYSQLServer should have sslEnforcement eq "Enabled" </td>
          </tr>
          
          <tr num="440">
            <!-- <td>440</td> -->
            <td>Ensure server parameter log_checkpoints is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_checkpoints on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_checkpoints like "(?i)on" </td>
          </tr>
          
          <tr num="441">
            <!-- <td>441</td> -->
            <td>Ensure server parameter log_connections is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_connections on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_connections like "(?i)on" </td>
          </tr>
          
          <tr num="442">
            <!-- <td>442</td> -->
            <td>Ensure server parameter log_disconnections is set to ON for PostgreSQL Database Server</td>
            <td>Enable log_disconnections on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_disconnections like "(?i)on" </td>
          </tr>
          
          <tr num="443">
            <!-- <td>443</td> -->
            <td>Ensure server parameter connection_throttling is set to ON for PostgreSQL Database Server</td>
            <td>Enable connection_throttling on PostgreSQL Servers</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have connection_throttling like "(?i)on" </td>
          </tr>
          
          <tr num="444">
            <!-- <td>444</td> -->
            <td>Ensure server parameter log_retention_days is greater than 3 days for PostgreSQL Database Server</td>
            <td>Enable log_retention_days on PostgreSQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have log_retention_days gte 4 </td>
          </tr>
          
          <tr num="445">
            <!-- <td>445</td> -->
            <td>SQL Server protection: Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled</td>
            <td>Disable access from Azure services to PostgreSQL Database Server</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should not have firewall_rules with [properties.startIpAddress eq "0.0.0.0" and properties.endIpAddress eq "0.0.0.0"] </td>
          </tr>
          
          <tr num="446">
            <!-- <td>446</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="447">
            <!-- <td>447</td> -->
            <td>Ensure SQL server's TDE protector is encrypted with Customer-managed key</td>
            <td>TDE with Customer-managed key support provides increased transparency and control over the TDE Protector increased security with an HSM-backed external service and promotion of separation of duties.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have TDEProtector.kind eq "azurekeyvault" and TDEProtector.serverKeyType eq "AzureKeyVault" and TDEProtector.uri </td>
          </tr>
          
          <tr num="448">
            <!-- <td>448</td> -->
            <td>Ensure Diagnostic Setting captures appropriate categories</td>
            <td>The diagnostic setting should be configured to log the appropriate activities from the control/management plane</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Subscription should have DiagnosticSettings with [ Logs with [ Category eq "Administrative" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Alert" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Policy" and Enabled ] ] and DiagnosticSettings with [ Logs with [ Category eq "Security" and Enabled ] ] </td>
          </tr>
          
          <tr num="449">
            <!-- <td>449</td> -->
            <td>Ensure the storage container storing the activity logs is not publicly accessible</td>
            <td>The storage account container containing the activity log export should not be publicly accessible</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have StorageContainerPublicAccess eq "None" </td>
          </tr>
          
          <tr num="450">
            <!-- <td>450</td> -->
            <td>Ensure the storage account containing the container with activity logs is encrypted with BYOK</td>
            <td>The storage account with the activity log export container is configured to use BYOK (Use Your Own Key).</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have StorageAccount.EncryptionType eq "Microsoft.Keyvault" and StorageAccount.KeyVaultUri </td>
          </tr>
          
          <tr num="451">
            <!-- <td>451</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="452">
            <!-- <td>452</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="453">
            <!-- <td>453</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Policy Assignment</td>
            <td>Create an activity log alert for the Delete Policy Assignment event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "Microsoft.Authorization/policyAssignments/delete" ] ] </td>
          </tr>
          
          <tr num="454">
            <!-- <td>454</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="455">
            <!-- <td>455</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="456">
            <!-- <td>456</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="457">
            <!-- <td>457</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="458">
            <!-- <td>458</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="459">
            <!-- <td>459</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="460">
            <!-- <td>460</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="461">
            <!-- <td>461</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="462">
            <!-- <td>462</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="463">
            <!-- <td>463</td> -->
            <td>Ensure that Network Security Group Flow Log retention period is greater than 90 days</td>
            <td>Network Security Group Flow Logs should be enabled and retention period is set to greater than or equal to 90 days.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should have FlowLog . RetentionPolicy . Days gt 90 and FlowLog . RetentionPolicy . Enabled </td>
          </tr>
          
          <tr num="464">
            <!-- <td>464</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="465">
            <!-- <td>465</td> -->
            <td>Ensure that UDP Services are restricted from the Internet</td>
            <td>Disable Internet exposed UDP ports on network security groups</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "UDP") and Destination . PortRange with [ ( FromPort lte 22 and ToPort gte 22 ) or ( FromPort lte 53 and ToPort gte 53 ) or ( FromPort lte 67 and ToPort gte 67 ) or ( FromPort lte 80 and ToPort gte 80 ) or ( FromPort lte 123 and ToPort gte 123 ) or ( FromPort lte 161 and ToPort gte 161 ) or ( FromPort lte 389 and ToPort gte 389 ) or ( FromPort lte 443 and ToPort gte 443 ) or ( FromPort lte 520 and ToPort gte 520 ) or ( FromPort lte 547 and ToPort gte 547 ) or ( FromPort lte 1433 and ToPort gte 1433 ) or ( FromPort lte 1521 and ToPort gte 1521 ) or ( FromPort lte 1900 and ToPort gte 1900 ) or ( FromPort lte 3306 and ToPort gte 3306 ) or ( FromPort lte 3389 and ToPort gte 3389 ) or ( FromPort lte 5432 and ToPort gte 5432 ) or ( FromPort lte 27019 and ToPort gte 27017 ) ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="466">
            <!-- <td>466</td> -->
            <td>Ensure Virtual Machines are utilizing Managed Disks</td>
            <td>Migrate BLOB based VHD's to Managed Disks on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have UnmanagedDisks len() eq 0 </td>
          </tr>
          
          <tr num="467">
            <!-- <td>467</td> -->
            <td>Ensure that 'OS and Data' disks are encrypted with CMK</td>
            <td>Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK (Customer Managed Keys). Customer Managed keys can be either ADE or Server Side Encryption (SSE)</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk and DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="468">
            <!-- <td>468</td> -->
            <td>Ensure that 'Unattached disks' are encrypted with CMK</td>
            <td>Ensure that unattached disks in a subscription are encrypted with a Customer Managed Key</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">Disk where DiskAttachment eq "Unattached" should have Encrypted </td>
          </tr>
          
          <tr num="469">
            <!-- <td>469</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="470">
            <!-- <td>470</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="471">
            <!-- <td>471</td> -->
            <td>Ensure the key vault is recoverable</td>
            <td>It is recommended the key vault be made recoverable by enabling the Do Not Purge and Soft Delete functions. This is in order to prevent loss of encrypted data including storage accounts, SQL databases, and/or dependent services provided by key vault objects (Keys, Secrets, Certificates) etc., as may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have EnableSoftDelete and EnablePurgeProtection </td>
          </tr>
          
          <tr num="472">
            <!-- <td>472</td> -->
            <td>Enable role-based access control (RBAC) within Azure Kubernetes Services</td>
            <td>Ensure that RBAC is enabled on all Azure Kubernetes Services Instances</td>
            <td>
            
              Kubernetes<br>
            
            </td>
            <td class="code">AKSCluster should have EnableRBAC </td>
          </tr>
          
          <tr num="473">
            <!-- <td>473</td> -->
            <td>Ensure App Service Authentication is set on Azure App Service</td>
            <td>Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the API app, or authenticate those that have tokens before they reach the API app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have AuthSettings with [ Enabled and UnauthenticatedClientAction neq "AllowAnonymous" ] </td>
          </tr>
          
          <tr num="474">
            <!-- <td>474</td> -->
            <td>Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service</td>
            <td>Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have HttpsOnly </td>
          </tr>
          
          <tr num="475">
            <!-- <td>475</td> -->
            <td>Ensure web app is using the latest version of TLS encryption</td>
            <td>The TLS(Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, such as PCI DSS.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have Configurations with [ MinTLSVersion eq "1.2" ] </td>
          </tr>
          
          <tr num="476">
            <!-- <td>476</td> -->
            <td>Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'</td>
            <td>Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have ClientCertEnabled </td>
          </tr>
          
          <tr num="477">
            <!-- <td>477</td> -->
            <td>Ensure that Register with Azure Active Directory is enabled on App Service</td>
            <td>Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have ADRegistered </td>
          </tr>
          
          <tr num="478">
            <!-- <td>478</td> -->
            <td>Ensure that 'HTTP Version' is the Latest, if Used to Run the Web App</td>
            <td>Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">FunctionApp should have Configurations with [ HTTP20Enabled ] </td>
          </tr>
          
          <tr num="479">
            <!-- <td>479</td> -->
            <td>Ensure the 'Minimum TLS version' is set to 'Version 1.2'</td>
            <td>Azure Storage sets the minimum TLS version to be version 1.0 by default. TLS 1.0 is a legacy version and has known vulnerabilities. This minimum TLS version can be configured to be later protocols such as TLS 1.2.</td>
            <td>
            
              Function<br>
            
            </td>
            <td class="code">StorageAccount should have MinimumTlsVersion eq "TLS1_2" </td>
          </tr>
          
          <tr num="480">
            <!-- <td>480</td> -->
            <td>Ensure 'Infrastructure double encryption' for PostgreSQL Database Server is 'Enabled'</td>
            <td>Enable encryption at rest for PostgreSQL Databases. This ensures another layer of encryption is implemented at the hardware level before the storage or network level. Information will be encrypted before it is even accessed, preventing both interception of data in motion if the network layer encryption is broken and data at rest in system resources such as memory or processor cache.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">PostgreSQLServer should have infrastructureEncryption eq "Enabled" </td>
          </tr>
          
          <tr num="481">
            <!-- <td>481</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GDPR">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="482">
            <!-- <td>482</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="483">
            <!-- <td>483</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="484">
            <!-- <td>484</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="485">
            <!-- <td>485</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="486">
            <!-- <td>486</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="487">
            <!-- <td>487</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="488">
            <!-- <td>488</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="489">
            <!-- <td>489</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="490">
            <!-- <td>490</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="491">
            <!-- <td>491</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="492">
            <!-- <td>492</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="493">
            <!-- <td>493</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="494">
            <!-- <td>494</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="495">
            <!-- <td>495</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="496">
            <!-- <td>496</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="497">
            <!-- <td>497</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="498">
            <!-- <td>498</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="499">
            <!-- <td>499</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="500">
            <!-- <td>500</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="501">
            <!-- <td>501</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="502">
            <!-- <td>502</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="503">
            <!-- <td>503</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="504">
            <!-- <td>504</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="505">
            <!-- <td>505</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="506">
            <!-- <td>506</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="507">
            <!-- <td>507</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="508">
            <!-- <td>508</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="509">
            <!-- <td>509</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="510">
            <!-- <td>510</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="511">
            <!-- <td>511</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="HIPAA">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="512">
            <!-- <td>512</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="513">
            <!-- <td>513</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="514">
            <!-- <td>514</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="515">
            <!-- <td>515</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="516">
            <!-- <td>516</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="517">
            <!-- <td>517</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="518">
            <!-- <td>518</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="519">
            <!-- <td>519</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="520">
            <!-- <td>520</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="521">
            <!-- <td>521</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="522">
            <!-- <td>522</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="523">
            <!-- <td>523</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="524">
            <!-- <td>524</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="525">
            <!-- <td>525</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="526">
            <!-- <td>526</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="527">
            <!-- <td>527</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="528">
            <!-- <td>528</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="529">
            <!-- <td>529</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="530">
            <!-- <td>530</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="531">
            <!-- <td>531</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="532">
            <!-- <td>532</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="533">
            <!-- <td>533</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="534">
            <!-- <td>534</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="535">
            <!-- <td>535</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="536">
            <!-- <td>536</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="537">
            <!-- <td>537</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="538">
            <!-- <td>538</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="539">
            <!-- <td>539</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="540">
            <!-- <td>540</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="541">
            <!-- <td>541</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="542">
            <!-- <td>542</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="543">
            <!-- <td>543</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="544">
            <!-- <td>544</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="545">
            <!-- <td>545</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="546">
            <!-- <td>546</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="547">
            <!-- <td>547</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="548">
            <!-- <td>548</td> -->
            <td>Ensure that 'Send Alerts to' is set for SQL Databases</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAddresses len() gt 0 </td>
          </tr>
          
          <tr num="549">
            <!-- <td>549</td> -->
            <td>Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Databases</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="550">
            <!-- <td>550</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="551">
            <!-- <td>551</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="552">
            <!-- <td>552</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="553">
            <!-- <td>553</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="554">
            <!-- <td>554</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="555">
            <!-- <td>555</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="556">
            <!-- <td>556</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="557">
            <!-- <td>557</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="558">
            <!-- <td>558</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Databases</td>
            <td>Enable auditing on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="559">
            <!-- <td>559</td> -->
            <td>Ensure that 'Threat Detection' is set to 'On' for SQL Databases</td>
            <td>Enable threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="560">
            <!-- <td>560</td> -->
            <td>Ensure that 'Threat Detection Types' is set to 'All' for SQL Databases</td>
            <td>Enable all types of threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="561">
            <!-- <td>561</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="ISO27K">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="562">
            <!-- <td>562</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="563">
            <!-- <td>563</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="564">
            <!-- <td>564</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="565">
            <!-- <td>565</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="566">
            <!-- <td>566</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="567">
            <!-- <td>567</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="568">
            <!-- <td>568</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="569">
            <!-- <td>569</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="570">
            <!-- <td>570</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="571">
            <!-- <td>571</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="572">
            <!-- <td>572</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="573">
            <!-- <td>573</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="574">
            <!-- <td>574</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="575">
            <!-- <td>575</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="576">
            <!-- <td>576</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="577">
            <!-- <td>577</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="578">
            <!-- <td>578</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="579">
            <!-- <td>579</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="580">
            <!-- <td>580</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="581">
            <!-- <td>581</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="582">
            <!-- <td>582</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="583">
            <!-- <td>583</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="584">
            <!-- <td>584</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="585">
            <!-- <td>585</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="586">
            <!-- <td>586</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="587">
            <!-- <td>587</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="588">
            <!-- <td>588</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="589">
            <!-- <td>589</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="590">
            <!-- <td>590</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="591">
            <!-- <td>591</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="592">
            <!-- <td>592</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="593">
            <!-- <td>593</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="594">
            <!-- <td>594</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="595">
            <!-- <td>595</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="596">
            <!-- <td>596</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="597">
            <!-- <td>597</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="598">
            <!-- <td>598</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="599">
            <!-- <td>599</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="600">
            <!-- <td>600</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="601">
            <!-- <td>601</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="602">
            <!-- <td>602</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="603">
            <!-- <td>603</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="604">
            <!-- <td>604</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="605">
            <!-- <td>605</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="606">
            <!-- <td>606</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="607">
            <!-- <td>607</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="608">
            <!-- <td>608</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="609">
            <!-- <td>609</td> -->
            <td>Ensure that 'Send Alerts to' is set for SQL Databases</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAddresses len() gt 0 </td>
          </tr>
          
          <tr num="610">
            <!-- <td>610</td> -->
            <td>Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Databases</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="611">
            <!-- <td>611</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
          <tr num="612">
            <!-- <td>612</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="613">
            <!-- <td>613</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="614">
            <!-- <td>614</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="615">
            <!-- <td>615</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="616">
            <!-- <td>616</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="617">
            <!-- <td>617</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="618">
            <!-- <td>618</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="619">
            <!-- <td>619</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="620">
            <!-- <td>620</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Databases</td>
            <td>Enable auditing on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="621">
            <!-- <td>621</td> -->
            <td>Ensure that 'Threat Detection' is set to 'On' for SQL Databases</td>
            <td>Enable threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="622">
            <!-- <td>622</td> -->
            <td>Ensure that 'Threat Detection Types' is set to 'All' for SQL Databases</td>
            <td>Enable all types of threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="623">
            <!-- <td>623</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="624">
            <!-- <td>624</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="625">
            <!-- <td>625</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="626">
            <!-- <td>626</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="627">
            <!-- <td>627</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="628">
            <!-- <td>628</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="629">
            <!-- <td>629</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="630">
            <!-- <td>630</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="631">
            <!-- <td>631</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="632">
            <!-- <td>632</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="633">
            <!-- <td>633</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="634">
            <!-- <td>634</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="635">
            <!-- <td>635</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="636">
            <!-- <td>636</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="637">
            <!-- <td>637</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="638">
            <!-- <td>638</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="639">
            <!-- <td>639</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="640">
            <!-- <td>640</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="641">
            <!-- <td>641</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="642">
            <!-- <td>642</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="643">
            <!-- <td>643</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="644">
            <!-- <td>644</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="645">
            <!-- <td>645</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="646">
            <!-- <td>646</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="647">
            <!-- <td>647</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="648">
            <!-- <td>648</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="649">
            <!-- <td>649</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="650">
            <!-- <td>650</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="651">
            <!-- <td>651</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="652">
            <!-- <td>652</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="653">
            <!-- <td>653</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="654">
            <!-- <td>654</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="655">
            <!-- <td>655</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="656">
            <!-- <td>656</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="657">
            <!-- <td>657</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="658">
            <!-- <td>658</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="659">
            <!-- <td>659</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="660">
            <!-- <td>660</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="661">
            <!-- <td>661</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="662">
            <!-- <td>662</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="663">
            <!-- <td>663</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="664">
            <!-- <td>664</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="665">
            <!-- <td>665</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="666">
            <!-- <td>666</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="667">
            <!-- <td>667</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="668">
            <!-- <td>668</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="669">
            <!-- <td>669</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="670">
            <!-- <td>670</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="671">
            <!-- <td>671</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="672">
            <!-- <td>672</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
          <tr num="673">
            <!-- <td>673</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="674">
            <!-- <td>674</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="675">
            <!-- <td>675</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="676">
            <!-- <td>676</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="677">
            <!-- <td>677</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="678">
            <!-- <td>678</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST800-53">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="679">
            <!-- <td>679</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="680">
            <!-- <td>680</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="681">
            <!-- <td>681</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="682">
            <!-- <td>682</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="683">
            <!-- <td>683</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="684">
            <!-- <td>684</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="685">
            <!-- <td>685</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="686">
            <!-- <td>686</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="687">
            <!-- <td>687</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="688">
            <!-- <td>688</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="689">
            <!-- <td>689</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="690">
            <!-- <td>690</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="691">
            <!-- <td>691</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="692">
            <!-- <td>692</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="693">
            <!-- <td>693</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="694">
            <!-- <td>694</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="695">
            <!-- <td>695</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="696">
            <!-- <td>696</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="697">
            <!-- <td>697</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="698">
            <!-- <td>698</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="699">
            <!-- <td>699</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="700">
            <!-- <td>700</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="701">
            <!-- <td>701</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="702">
            <!-- <td>702</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="703">
            <!-- <td>703</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="704">
            <!-- <td>704</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="705">
            <!-- <td>705</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="706">
            <!-- <td>706</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="707">
            <!-- <td>707</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="708">
            <!-- <td>708</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="709">
            <!-- <td>709</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="710">
            <!-- <td>710</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="711">
            <!-- <td>711</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="712">
            <!-- <td>712</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="713">
            <!-- <td>713</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="714">
            <!-- <td>714</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="715">
            <!-- <td>715</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="716">
            <!-- <td>716</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="717">
            <!-- <td>717</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="718">
            <!-- <td>718</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="719">
            <!-- <td>719</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="720">
            <!-- <td>720</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="721">
            <!-- <td>721</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="722">
            <!-- <td>722</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="723">
            <!-- <td>723</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="724">
            <!-- <td>724</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="725">
            <!-- <td>725</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="726">
            <!-- <td>726</td> -->
            <td>Ensure that 'Send Alerts to' is set for SQL Databases</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAddresses len() gt 0 </td>
          </tr>
          
          <tr num="727">
            <!-- <td>727</td> -->
            <td>Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Databases</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="728">
            <!-- <td>728</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="729">
            <!-- <td>729</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="730">
            <!-- <td>730</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="731">
            <!-- <td>731</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="732">
            <!-- <td>732</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="733">
            <!-- <td>733</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="734">
            <!-- <td>734</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="735">
            <!-- <td>735</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="736">
            <!-- <td>736</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Databases</td>
            <td>Enable auditing on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="737">
            <!-- <td>737</td> -->
            <td>Ensure that 'Threat Detection' is set to 'On' for SQL Databases</td>
            <td>Enable threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="738">
            <!-- <td>738</td> -->
            <td>Ensure that 'Threat Detection Types' is set to 'All' for SQL Databases</td>
            <td>Enable all types of threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="739">
            <!-- <td>739</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="PCI">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="740">
            <!-- <td>740</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="741">
            <!-- <td>741</td> -->
            <td>Ensure that inbound access from the Internet is restricted</td>
            <td>Make sure Network Security Groups do not allow any inbound access from the Internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "UDP", "TCP") and ( Destination . PortRange with [ ( FromPort eq 0 and ToPort eq 65535 ) ] ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] </td>
          </tr>
          
          <tr num="742">
            <!-- <td>742</td> -->
            <td>Do not allow default Network Security Groups</td>
            <td>Check for Network Security Groups with only default rules, which by default allows all outbound Internet traffic.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should have SecurityRules len() gt 0 and no SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] and SecurityRules with [ Access eq "Deny" and Direction eq "Outbound" and ( ( Destination . PortRange with [ ( FromPort eq 0 and ToPort eq 65535 ) ] ) and ( ( Destination . Type eq "Any" ) or ( Destination . Type eq "IP Addresses" and Destination . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) or ( Destination . Type eq "Service Tag" and Destination . ServiceTag eq "Internet" ) ) ) ] </td>
          </tr>
          
          <tr num="743">
            <!-- <td>743</td> -->
            <td>Ensure that relational database access is restricted from the Internet</td>
            <td>Ensure that common SQL Database (SQLServer, mySQL, Oracle, Postgres) ports are not allowed inbound access from the internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "UDP", "TCP") and ( Destination . PortRange with [ ( FromPort lte 1433 and ToPort gte 1433 ) or ( FromPort lte 3306 and ToPort gte 3306 ) or ( FromPort lte 1521 and ToPort gte 1521 ) or ( FromPort lte 5432 and ToPort gte 5432 ) ] ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] </td>
          </tr>
          
          <tr num="744">
            <!-- <td>744</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="745">
            <!-- <td>745</td> -->
            <td>Ensure that FTP access is restricted from the Internet</td>
            <td>Check Network Security Groups for FTP access from the Internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code"> NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and ( Destination . PortRange with [ ( FromPort lte 21 and ToPort gte 20 ) ] ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] </td>
          </tr>
          
          <tr num="746">
            <!-- <td>746</td> -->
            <td>Ensure that clear text protocols from the Internet are restricted</td>
            <td>Check Network Security Groups for inbound access of clear-text protocols (telnet, SMTP, POP, IMAP, and SNMP) from the Internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Protocol in ( "*", "TCP" ) and ( Destination . PortRange with [ ( FromPort lte 23 and ToPort gte 23 ) or ( FromPort lte 25 and ToPort gte 25 ) or ( FromPort lte 110 and ToPort gte 110 ) or ( FromPort lte 143 and ToPort gte 143 ) or ( FromPort lte 162 and ToPort gte 161 ) ] ) ) or ( Protocol in ( "*" , "UDP" ) and ( Destination . PortRange with [ ( FromPort lte 162 and ToPort gte 161 ) ] ) ) ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0") ] ) ) ] </td>
          </tr>
          
          <tr num="747">
            <!-- <td>747</td> -->
            <td>Ensure that commonly-attacked ports access are restricted from the Internet</td>
            <td>Prevent inbound access from the Internet to commonly attacked ports (TCP 0, 19, 135-139, 445, 1080, 5900) and (UDP 67, 520, 547, 1900).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Protocol in ( "*", "TCP" ) and ( Destination . PortRange with [ ( FromPort lte 0 and ToPort gte 0 ) or ( FromPort lte 19 and ToPort gte 19 ) or ( FromPort lte 139 and ToPort gte 135 ) or ( FromPort lte 445 and ToPort gte 445 ) or ( FromPort lte 1080 and ToPort gte 1080 ) or ( FromPort lte 5800 and ToPort gte 5800 ) or ( FromPort lte 5900 and ToPort gte 5900) ] ) ) or ( Protocol in ( "*", "UDP" ) and ( Destination . PortRange with [ ( FromPort lte 19 and ToPort gte 19 ) or ( FromPort lte 123 and ToPort gte 123 ) or ( FromPort lte 67 and ToPort gte 67 ) or ( FromPort lte 139 and ToPort gte 135 ) or ( FromPort lte 445 and ToPort gte 445 ) or ( FromPort lte 520 and ToPort gte 520 ) or ( FromPort lte 547 and ToPort gte 547 ) or ( FromPort lte 1900 and ToPort gte 1900 ) ] ) ) ) and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] </td>
          </tr>
          
          <tr num="748">
            <!-- <td>748</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="749">
            <!-- <td>749</td> -->
            <td>Prevent inbound traffic from the Internet that has spoofed or invalid src IP addresses</td>
            <td>Prevent any inbound traffic from the internet that has unroutable, reserved, or invalid source IP addresses.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Source . Type eq "Any" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/8", "100.64.0.0/10", "127.0.0.0/8", "169.254.0.0/16", "192.0.0.0/24", "192.0.2.0/24", "192.88.99.0/24", "198.18.0.0/15", "198.51.100.0/25", "203.0.113.0/24", "224.0.0.0/4", "240.0.0.0/4", "255.255.255.255/32", "0.0.0.0/0" ) ] ) ) ] </td>
          </tr>
          
          <tr num="750">
            <!-- <td>750</td> -->
            <td>Ensure that all inbound traffic from the Internet is restricted</td>
            <td>Check Network Security Groups for rules allowing any inbound traffic from the Internet.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkSecurityGroup should not have SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and ( Source . Addresses with [ Prefix isPublic() or Prefix in ( "<nw>/0", "/0") ] ) ) ) ] </td>
          </tr>
          
          <tr num="751">
            <!-- <td>751</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="752">
            <!-- <td>752</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="753">
            <!-- <td>753</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Databases</td>
            <td> SQL Database Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="754">
            <!-- <td>754</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="755">
            <!-- <td>755</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="756">
            <!-- <td>756</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="757">
            <!-- <td>757</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="758">
            <!-- <td>758</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="759">
            <!-- <td>759</td> -->
            <td>Ensure that Data encryption is set to On on a SQL Database</td>
            <td>Enable Transparent Data Encryption on every SQL Database</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have DataEncryption.TransparentDataEncryptionStatus eq "Enabled" </td>
          </tr>
          
          <tr num="760">
            <!-- <td>760</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="761">
            <!-- <td>761</td> -->
            <td>Ensure that the expiry date is set on all Keys</td>
            <td>Ensure that all Keys in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Keys with [ Expires eq False ] </td>
          </tr>
          
          <tr num="762">
            <!-- <td>762</td> -->
            <td>Ensure that the expiry date is set on all Secrets</td>
            <td>Ensure that all Secrets in Azure Key Vault have an expiry time set.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should not have Secrets with [ Expires eq False ] </td>
          </tr>
          
          <tr num="763">
            <!-- <td>763</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="764">
            <!-- <td>764</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="765">
            <!-- <td>765</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
          <tr num="766">
            <!-- <td>766</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="767">
            <!-- <td>767</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="768">
            <!-- <td>768</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="769">
            <!-- <td>769</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="770">
            <!-- <td>770</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="771">
            <!-- <td>771</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="772">
            <!-- <td>772</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="773">
            <!-- <td>773</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Databases</td>
            <td>Enable auditing on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="774">
            <!-- <td>774</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="775">
            <!-- <td>775</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="776">
            <!-- <td>776</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="777">
            <!-- <td>777</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="778">
            <!-- <td>778</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="779">
            <!-- <td>779</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="780">
            <!-- <td>780</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="781">
            <!-- <td>781</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="782">
            <!-- <td>782</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="783">
            <!-- <td>783</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="784">
            <!-- <td>784</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="785">
            <!-- <td>785</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="786">
            <!-- <td>786</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="787">
            <!-- <td>787</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="788">
            <!-- <td>788</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="789">
            <!-- <td>789</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="790">
            <!-- <td>790</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="791">
            <!-- <td>791</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="792">
            <!-- <td>792</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="793">
            <!-- <td>793</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="794">
            <!-- <td>794</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="795">
            <!-- <td>795</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="796">
            <!-- <td>796</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="797">
            <!-- <td>797</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="798">
            <!-- <td>798</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="799">
            <!-- <td>799</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="800">
            <!-- <td>800</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="801">
            <!-- <td>801</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="802">
            <!-- <td>802</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="803">
            <!-- <td>803</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="804">
            <!-- <td>804</td> -->
            <td>Ensure that 'Send Alerts to' is set for SQL Databases</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAddresses len() gt 0 </td>
          </tr>
          
          <tr num="805">
            <!-- <td>805</td> -->
            <td>Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Databases</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="806">
            <!-- <td>806</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="807">
            <!-- <td>807</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="808">
            <!-- <td>808</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="809">
            <!-- <td>809</td> -->
            <td>Ensure that 'Threat Detection' is set to 'On' for SQL Databases</td>
            <td>Enable threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="810">
            <!-- <td>810</td> -->
            <td>Ensure that 'Threat Detection Types' is set to 'All' for SQL Databases</td>
            <td>Enable all types of threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="SOC2">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="811">
            <!-- <td>811</td> -->
            <td>Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL Servers</td>
            <td> SQL Server Audit Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( AuditPolicy . RetentionDays gte 90 or AuditPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="812">
            <!-- <td>812</td> -->
            <td>Audit/log records: Ensure that 'Threat Detection' Retention is 'greater than 90 days' for SQL Servers</td>
            <td>SQL Server Threat Detection Retention should be configured to be greater than 90 days.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ( ThreatPolicy . RetentionDays gte 90 or ThreatPolicy . RetentionDays lte 0 ) </td>
          </tr>
          
          <tr num="813">
            <!-- <td>813</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Endpoint Protection' is not 'Disabled'</td>
            <td>Enable Endpoint protection recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMEndpointProtection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="814">
            <!-- <td>814</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Disk Encryption' is not 'Disabled' </td>
            <td>Enable Disk encryption recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMDiskEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="815">
            <!-- <td>815</td> -->
            <td>Ensure that 'Storage Encryption' is set to 'On'</td>
            <td>Enable Storage Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have StorageEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="816">
            <!-- <td>816</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Encryption' is not 'Disabled' </td>
            <td>Enable SQL Encryption recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLEncryption in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="817">
            <!-- <td>817</td> -->
            <td>Ensure that 'Secure transfer required' is set to 'Enabled'</td>
            <td>Enable data encryption is transit.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have EnableHttpsTrafficOnly </td>
          </tr>
          
          <tr num="818">
            <!-- <td>818</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for Blob Service</td>
            <td>Enable data encryption at rest for blobs.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have BlobEncryptionEnabled </td>
          </tr>
          
          <tr num="819">
            <!-- <td>819</td> -->
            <td>Ensure that 'Storage service encryption' is set to Enabled for File Service</td>
            <td>Enable data encryption at rest for file service.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have FileEncryptionEnabled </td>
          </tr>
          
          <tr num="820">
            <!-- <td>820</td> -->
            <td>Data-at-rest is protected: Ensure that 'OS disk' are encrypted</td>
            <td>Ensure that OS disks (boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . OSDisk </td>
          </tr>
          
          <tr num="821">
            <!-- <td>821</td> -->
            <td>Ensure that 'Data disks' are encrypted</td>
            <td>Ensure that Data disks (non-boot volumes) are encrypted, where possible</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have DiskEncryptionStatus . DataDisk </td>
          </tr>
          
          <tr num="822">
            <!-- <td>822</td> -->
            <td>Identities and credentials: Ensure that there are no guest users</td>
            <td>Do not add guest users if not needed.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">User should not have Type eq "Guest" </td>
          </tr>
          
          <tr num="823">
            <!-- <td>823</td> -->
            <td>Identities and credentials: Ensure that no custom subscription owner roles are created</td>
            <td>Do not create custom roles with subscription ownership. It is recommended to use the principle of least privilege, assigning only needed privileges instead of allowing full administrative access.</td>
            <td>
            
              Auth<br>
            
            </td>
            <td class="code">Role should not have ( Type eq "CustomRole" and Permissions with [ Actions has ( "*" ) ] ) </td>
          </tr>
          
          <tr num="824">
            <!-- <td>824</td> -->
            <td>Identities and credentials: Ensure that Azure Active Directory Admin is configured for SQL Servers</td>
            <td>Use Azure Active Directory Authentication for authentication with SQL Database.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ADAdmin . Status </td>
          </tr>
          
          <tr num="825">
            <!-- <td>825</td> -->
            <td>Ensure that a Log Profile exists</td>
            <td>Enable log profile for exporting activity logs.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have ActivityLogProfile len () > 0 </td>
          </tr>
          
          <tr num="826">
            <!-- <td>826</td> -->
            <td>Ensure that Activity Log Retention is set 365 days or greater</td>
            <td>Ensure Activity Log Retention is set for 365 days or greater</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">ActivityLogProfile should have (RetentionEnabled and RetentionDays gte 365) or (RetentionEnabled eq False and RetentionDays eq 0) </td>
          </tr>
          
          <tr num="827">
            <!-- <td>827</td> -->
            <td>Ensure that Activity Log Alert exists for Create Policy Assignment</td>
            <td>Create an activity log alert for the Create Policy Assignment event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Authorization/policyAssignments/write" ] ] </td>
          </tr>
          
          <tr num="828">
            <!-- <td>828</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group</td>
            <td>Create an activity log alert for Create or Update Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/write" ] ] </td>
          </tr>
          
          <tr num="829">
            <!-- <td>829</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Network Security Group</td>
            <td>Create an activity log alert for Delete Network Security Group event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/delete" ] ] </td>
          </tr>
          
          <tr num="830">
            <!-- <td>830</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Network Security Group Rule</td>
            <td>Create an activity log alert for the Create or Update Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/write" ] ] </td>
          </tr>
          
          <tr num="831">
            <!-- <td>831</td> -->
            <td>Ensure that activity log alert exists for the Delete Network Security Group Rule</td>
            <td>Create an activity log alert for the Delete Network Security Group Rule event</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Network/networkSecurityGroups/securityRules/delete" ] ] </td>
          </tr>
          
          <tr num="832">
            <!-- <td>832</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update Security Solution</td>
            <td>Create an activity log alert for the Create or Update Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/write" ] ] </td>
          </tr>
          
          <tr num="833">
            <!-- <td>833</td> -->
            <td>Ensure that Activity Log Alert exists for Delete Security Solution</td>
            <td>Create an activity log alert for the Delete Security Solution event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/securitySolutions/delete" ] ] </td>
          </tr>
          
          <tr num="834">
            <!-- <td>834</td> -->
            <td>Ensure that Activity Log Alert exists for Create or Update or Delete SQL Server Firewall Rule</td>
            <td>Create an activity log alert for the Create or Update or Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Sql/servers/firewallRules/write" ] ] </td>
          </tr>
          
          <tr num="835">
            <!-- <td>835</td> -->
            <td>Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule</td>
            <td>Create an Activity Log Alert for the Delete SQL Server Firewall Rule event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ Conditions with [ Value like "microsoft.sql/servers/firewallrules/delete" ] ] </td>
          </tr>
          
          <tr num="836">
            <!-- <td>836</td> -->
            <td>Ensure that Activity Log Alert exists for Update Security Policy</td>
            <td>Create an activity log alert for the Update Security Policy event.</td>
            <td>
            
              Monitor<br>
            
            </td>
            <td class="code">Azure should have atleast one ActivityLogAlert with [ SubscriptionScope and RegionName eq "global" and Enabled and ActionGroupId len () gt 0 and Conditions with [ Field eq "operationName" and Value like "Microsoft.Security/policies/write" ] ] </td>
          </tr>
          
          <tr num="837">
            <!-- <td>837</td> -->
            <td>Ensure that logging for Azure KeyVault is 'Enabled'</td>
            <td>Enable AuditEvent logging for Key Vault instances to ensure interactions with key vaults are logged and available.</td>
            <td>
            
              KeyVault<br>
            
            </td>
            <td class="code">KeyVault should have DiagnosticSettings with [ StorageAccountId len ( ) gt 0 and Logs with [ Category len ( ) gt 0 and LogEnabled and ( RetentionPolicy . Days gte 180 or RetentionPolicy . Days eq 0 ) ] ] </td>
          </tr>
          
          <tr num="838">
            <!-- <td>838</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Vulnerability Assessment' is not 'Disabled'</td>
            <td>Enable Vulnerability assessment recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMVulnerabilityAssessment in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="839">
            <!-- <td>839</td> -->
            <td>Vulnerability management plan: Ensure that VM agent is installed</td>
            <td>Install VM agent on Virtual Machines</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType eq "MicrosoftMonitoringAgent" and ProvisioningState eq "Succeeded" ] </td>
          </tr>
          
          <tr num="840">
            <!-- <td>840</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Network Security Groups' is not 'Disabled'</td>
            <td>Enable Network security groups recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNetworkSecurityGroups in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="841">
            <!-- <td>841</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Web Application Firewall' is not 'Disabled'</td>
            <td>Enable Web application firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMWebApplicationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="842">
            <!-- <td>842</td> -->
            <td>Ensure ASC Default policy setting 'Enable Next Generation Firewall(NGFW) Monitoring' is not 'Disabled'</td>
            <td>Enable Next generation firewall recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMNextGenerationFirewall in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="843">
            <!-- <td>843</td> -->
            <td>Ensure ASC Default policy setting 'Monitor JIT Network Access' is not 'Disabled'</td>
            <td>Enable JIT Network Access for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMJITNetworkAccess in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="844">
            <!-- <td>844</td> -->
            <td>Ensure ASC Default policy setting 'Monitor Adaptive Application Whitelisting' is not 'Disabled'</td>
            <td>Enable adaptive application controls.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AdaptiveApplicationControls in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="845">
            <!-- <td>845</td> -->
            <td>Ensure that RDP access is restricted from the internet</td>
            <td>Check Network Security Groups for any inbound access from the Internet to RDP port 3389 (UDP or TCP).</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 3389 and ToPort gte 3389 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="846">
            <!-- <td>846</td> -->
            <td>Ensure that SSH access is restricted from the internet</td>
            <td>Disable SSH access on Network Security Groups from Internet</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">VirtualMachine should not have NetworkInterfaces with [ SecurityGroup . SecurityRules with [ Access eq "Allow" and Direction eq "Inbound" and Protocol in ("*", "TCP") and Destination . PortRange with [ FromPort lte 22 and ToPort gte 22 ] and ( ( Source . Type eq "Any" ) or ( Source . Type eq "Service Tag" and Source . ServiceTag eq "Internet" ) or ( Source . Type eq "IP Addresses" and Source . Addresses with [ Prefix in ( "0.0.0.0/0", "::/0", "<nw>/0", "/0" ) ] ) ) ] ] </td>
          </tr>
          
          <tr num="847">
            <!-- <td>847</td> -->
            <td>Communications and control network protection: Ensure that SQL server access is restricted from the internet</td>
            <td>Ensure that no SQL Databases allow ingress from the internet.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should not have FirewallRule with [ StartIP eq 0.0.0.0 and EndIP eq 0.0.0.0 ] </td>
          </tr>
          
          <tr num="848">
            <!-- <td>848</td> -->
            <td>Baseline network operations and data flows: Ensure that Network Watcher is 'Enabled'</td>
            <td>Enable Network Watcher for your Azure Subscriptions</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">Subscription should have NetworkWatcherEnabled </td>
          </tr>
          
          <tr num="849">
            <!-- <td>849</td> -->
            <td>Data-at-rest is protected: Ensure that 'Public access level' is set to Private for blob containers</td>
            <td>Disable anonymous access to blob containers.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">StorageAccount should have every BlobContainers with [ Access eq "None" ] or not AllowBlobPublic </td>
          </tr>
          
          <tr num="850">
            <!-- <td>850</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Security contact emails' is set</td>
            <td>Provide a security contact email address.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactEmails len() > 0 </td>
          </tr>
          
          <tr num="851">
            <!-- <td>851</td> -->
            <td>Personnel know response roles/operations: Ensure that security contact 'Phone number' is set</td>
            <td>Provide a security contact phone number.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SecurityContactPhoneNumber neq "" </td>
          </tr>
          
          <tr num="852">
            <!-- <td>852</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send me emails about alerts' is set to 'On'</td>
            <td>Enable security alerts emailing to security contact.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailAboutAlerts </td>
          </tr>
          
          <tr num="853">
            <!-- <td>853</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Also send email to subscription owners' is set to 'On'</td>
            <td>Enable security alerts emailing to subscription owners.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SendEmailToSubscriptionOwners </td>
          </tr>
          
          <tr num="854">
            <!-- <td>854</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAddresses </td>
          </tr>
          
          <tr num="855">
            <!-- <td>855</td> -->
            <td>Personnel know response roles/operations: Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Servers</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Server.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="856">
            <!-- <td>856</td> -->
            <td>Ensure that 'Send Alerts to' is set for SQL Databases</td>
            <td>Provide the email address to which alerts will be sent upon detection of anomalous activities on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAddresses len() gt 0 </td>
          </tr>
          
          <tr num="857">
            <!-- <td>857</td> -->
            <td>Ensure that 'Email service and co-administrators' is 'Enabled' for SQL Databases</td>
            <td>Enable service and co-administrators to receive security alerts from SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . EmailAccountAdmins eq "Enabled" </td>
          </tr>
          
          <tr num="858">
            <!-- <td>858</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that standard pricing tier is selected in Azure Security Center</td>
            <td>Standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SelectedPricingTier eq "Standard" </td>
          </tr>
          
          <tr num="859">
            <!-- <td>859</td> -->
            <td>Ensure That Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'</td>
            <td>Enable Automatic provisioning of monitoring agent to collect security data.</td>
            <td>
            
              AAD<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have AutomaticProvisioningOfMonitoringAgent eq "On" </td>
          </tr>
          
          <tr num="860">
            <!-- <td>860</td> -->
            <td>Ensure ASC Default policy setting 'Monitor System Updates' is not 'Disabled'</td>
            <td>Enable system updates recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSystemUpdates in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="861">
            <!-- <td>861</td> -->
            <td> Ensure ASC Default policy setting 'Monitor OS Vulnerabilities' is not 'Disabled'</td>
            <td>Enable OS vulnerabilities recommendations for virtual machines.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have VMSecurityConfigurations in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="862">
            <!-- <td>862</td> -->
            <td>Ensure ASC Default policy setting 'Monitor SQL Auditing' is not 'Disabled'</td>
            <td>Enable SQL auditing & Threat detection recommendations.</td>
            <td>
            
              SecurityCenter<br>
            
            </td>
            <td class="code">SecurityCenterPolicy should have SQLAuditingAndThreatDetection in ( "AuditIfNotExists", "Audit" ) </td>
          </tr>
          
          <tr num="863">
            <!-- <td>863</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Servers</td>
            <td>Enable auditing on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="864">
            <!-- <td>864</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection' is set to 'On' for SQL Servers</td>
            <td>Enable threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="865">
            <!-- <td>865</td> -->
            <td>Monitor network to detect potential cybersecurity events: Ensure that 'Threat Detection Types' is set to 'All' for SQL Servers</td>
            <td>Enable all types of threat detection on SQL Servers.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLServer should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="866">
            <!-- <td>866</td> -->
            <td>Ensure that 'Auditing' is set to 'On' for SQL Databases</td>
            <td>Enable auditing on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have AuditPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="867">
            <!-- <td>867</td> -->
            <td>Ensure that 'Threat Detection' is set to 'On' for SQL Databases</td>
            <td>Enable threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" </td>
          </tr>
          
          <tr num="868">
            <!-- <td>868</td> -->
            <td>Ensure that 'Threat Detection Types' is set to 'All' for SQL Databases</td>
            <td>Enable all types of threat detection on SQL Databases.</td>
            <td>
            
              SQL<br>
            
            </td>
            <td class="code">SQLDatabase should have ThreatPolicy . State eq "Enabled" and not ( ThreatPolicy . DisabledAlerts like "Sql" or ThreatPolicy . DisabledAlerts like "Anomaly" ) </td>
          </tr>
          
          <tr num="869">
            <!-- <td>869</td> -->
            <td>Ensure that the endpoint protection for all Virtual Machines is installed</td>
            <td>Install Endpoint Protection for all Virtual Machines.</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">VirtualMachine should have Extensions with [ ExtensionType in ( "EndpointSecurity", "TrendMicroDSA*", "Antimalware" , "EndpointProtection" , "SCWPAgent", "PortalProtectExtension*" , "FileSecurity*" ) ] </td>
          </tr>
          
        </table>
      
      &nbsp;
      <br><br>
      <br><br>
      <br><br>
      &nbsp;
    </div>
  </div>
  <script>

  // Sort
  const getCellValue = (tr, idx) => (idx == 0 ) ? tr.getAttribute("num") : ( tr.children[idx].innerText || tr.children[idx].textContent);
  const comparer = (idx, asc) => (a, b) => ((v1, v2) =>
      v1 !== '' && v2 !== '' && !isNaN(v1) && !isNaN(v2) ? v1 - v2 : v1.toString().localeCompare(v2)
      )(getCellValue(asc ? a : b, idx), getCellValue(asc ? b : a, idx));
  document.querySelectorAll('th').forEach(th => th.addEventListener('click', (() => {
      this.asc = !this.asc;
      const table = th.closest('table');
      Array.from(table.querySelectorAll('tr:nth-child(n+2)'))
          .sort(comparer(Array.from(th.parentNode.children).indexOf(th), this.asc))
          .forEach(tr => table.appendChild(tr) );
      $('th').removeClass('headerSortDown').removeClass('headerSortUp')
      if (this.asc) {
        $(th).addClass('headerSortUp')
      } else {
        $(th).addClass('headerSortDown')
      }
  })));

  // Search
  var $rows = $('table.rule_table tr[num]');
  $('#search').keyup(debounce(function() {

    var val = '^(?=.*\\b' + $.trim($(this).val()).split(/\s+/).join('\\b)(?=.*\\b') + ').*$',
      reg = RegExp(val, 'i'),
      text;

    $rows.show().filter(function() {
      text = $(this).text().replace(/\s+/g, ' ');
      return !reg.test(text);
    }).hide();
  }, 300));

  function debounce(func, wait, immediate) {
    var timeout;
    return function() {
      var context = this,
        args = arguments;
      var later = function() {
        timeout = null;
        if (!immediate) func.apply(context, args);
      };
      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) func.apply(context, args);
    };
  };

  // Nav Menu Show/Hide
  function hideRuleTables() {
    $('.rule_table').hide()
    $('.rule_key').removeClass('active')
  }

  function showRuleTable(name) {
    // c) show this table
    if (name == 'ALL') { 
        $('.rule_table').show()
    } else {
        $('.rule_table[data-profile-name="'+name+'"]').show()
    }
  }

  function activateRule(profile_name) {
    // a) hide all the tables with the class 'rule_table'
    hideRuleTables()
    // b) find the table in '.rule_table' with the same 'profile-name' data attribute
    showRuleTable(profile_name)
    if (name == "ALL") { 
        $('.rule_key').addClass('active')
    } else {
        $('.rule_key[data-profile-name="'+profile_name+'"]').addClass('active')
    }
  }

  function initListeners(){
    // 1. iterate over each Rule list item   
    $('.rule_key').each(function(i, obj) {
      var ruleKey = $(obj)
      var ruleName = ruleKey.data('profile-name')
      console.log('adding click listener to ' + ruleName);
      // 2. add a click listener
      ruleKey.click(function(event){
        console.log('received click event for ' + ruleName)
        activateRule(ruleName)
      })
    })
  }
  (function(){
    hideRuleTables()
    var firstRule = $($('.rule_key')[0]).data('profile-name')
    console.log('activating first rule: ', firstRule)
    activateRule(firstRule)
    initListeners()
  })()
  </script>
</body>
</html>