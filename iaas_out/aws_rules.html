<html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!--
<script src="jquery-3.3.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="rules_styles.css"> 
-->
<style>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
*/
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}

/* Start Netskope styles */

h1 {font-size: 1.8em; font-family: Arial,sans-serif; margin: 1.2rem}
h2 {font-size: 1.6em; font-family: Arial,sans-serif; margin: 1.2rem}
body {font-family: Arial,sans-serif;}

table.rule_table {font-size: 90%}
td.code {font-family: monospace}
th {font-weight: bold; cursor: pointer; }
input { margin-left: 2px; margin-bottom: 5px; padding: 2px 3px; width: 300; }
.headerSortDown:after,
.headerSortUp:after{
    content: ' ';
    position: relative;
    left: 10px;
    border: 7px solid transparent;
}
.headerSortDown:after{
    top: 10px;
    border-top-color: silver;
}
.headerSortUp:after{
    bottom: 15px;
    border-bottom-color: silver;
}
.headerSortDown,
.headerSortUp{
    padding-left: 20px;
}

img[alt="Netskope"] {display:block; margin:1.2rem;}
.container {display: flex; flex-direction: row; padding: 1.5rem;}
._TAB{ display: inline-block; width: 0.4rem; height: 0.1rem; border-top: 0.5rem solid transparent; border-bottom: 0.5rem solid transparent; border-left: 0.5rem solid rgba(125,125,125,0.40); margin-left: 1.4rem; margin-right: 0.1rem;}
.rule_keys {display:inline-block; margin:0.7rem; margin-top:0; padding-right:2.0rem}
.rule_keys>.rule_category:first-child{margin-top:0;}
.rule_keys ul {list-style: none;}
.rule_keys li {cursor: pointer;}
.rule_keys li:hover {background-color: rgba(255,131,0,0.39); }

.rule_keys {position: fixed; top:135}
img {position: fixed; top: 0}
h1 {position: fixed; top: 75}

.rule_tables {flex:3 1 0px;display:inline-block;}
.rule_tables table, .rule_tables th, .rule_tables td { border: 1px solid rgba(150,150,100,0.5);  }
.rule_tables table {table-layout: fixed; width:100%;}
.rule_tables th {background-color: rgba(180,180,180,0.2); padding:0.2rem;}
.rule_tables td {padding: 0.2rem;}
.rule_tables {position: absolute; left: 400; top: 135}

/* rule styles */
.rule_category, .rule_name {display:inline-block;float:none; padding-right:0.2rem;}
.rule_category {font-size:1.3em;width: 100%;background-color: rgba(180,180,180,0.2); margin:0.5rem 0 0.2rem 0;padding:0;}
.rule_category:before, .rule_category:after {display:inline-block; content:''; width:0.4rem;}
.rule_key {padding:0.3rem;padding-left: 1.5rem;}
.rule_key.active {background-color: #ff8300; color:#ffffff;}
.rule_name {width:100%; text-align: left;}
</style>

<title>AWS Predefined Rules</title>
</head>
<body>
  <img src="logo.png" alt="Netskope"/>
  <h1>AWS Predefined Rules</h1>
  <div class="container">
    <div class="rule_keys">
        <ul>
            
            <li class="rule_key" data-profile-name="BPR">
              <span class="rule_name">AWS Best Practices v1.0.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CCM">
              <span class="rule_name">CSA CCM v3.0.1</span>
            </li>
            
            <li class="rule_key" data-profile-name="CIS">
              <span class="rule_name">CIS AWS Foundations Benchmark v1.2.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="GDPR">
              <span class="rule_name">GDPR 1996/679 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="HIPAA">
              <span class="rule_name">HIPAA 1996 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="ISO27K">
              <span class="rule_name">ISO 27002 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST">
              <span class="rule_name">NIST CSF v1.1 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST800-53">
              <span class="rule_name">NIST 800-53 r4 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="PCI">
              <span class="rule_name">PCI-DSS v3.2.1 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="SOC2">
              <span class="rule_name">AICPA SOC2 TSC 2017 (AWS)</span>
            </li>
            
            <!--
            <li class="rule_key" data-profile-name="ALL">
              <span class="rule_name">All Rules</span>
            </li>
            -->
        </ul>
        <br><br>
        <!-- 
        -->
        &#x1F50D;<input type="text" id="search" placeholder="Type to search"> 
    </div>
    <div class="rule_tables">
      
        <table id="table" class="rule_table" data-profile-name="BPR">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="1">
            <!-- <td>1</td> -->
            <td>Ensure EC2 Instance does not have open DNS port</td>
            <td>DNS Port 53, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1", "udp") and ( FromPort lte 53 and ToPort gte 53 ) ] ] </td>
          </tr>
          
          <tr num="2">
            <!-- <td>2</td> -->
            <td>Ensure EC2 Instance does not have open MongoDB port</td>
            <td>MongoDB Port 27017, 27018, 27019 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1", "tcp") and ( (FromPort lte 27019 and ToPort gte 27017) ) ] ] </td>
          </tr>
          
          <tr num="3">
            <!-- <td>3</td> -->
            <td>Communications and control network protection: Ensure no rule exists which allows all ingress traffic in default Network ACL</td>
            <td>Network ACLs are designed to provide a secondary layer of security. Adding a rule that allows all network traffic (all protocols, IPs, and source) prior to any deny rule defeats the purpose of network ACLs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL should not have IsDefault eq true and Rules with [ RuleAction eq "allow" and Protocol eq "-1" and Egress eq False and CidrBlock eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="4">
            <!-- <td>4</td> -->
            <td>Ensure EC2 Instance does not have open NFS port</td>
            <td>NFS Port 2049, 111 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1","udp","tcp") and ( (FromPort lte 2049 and ToPort gte 2049) or (FromPort lte 111 and ToPort gte 111)) ] ] </td>
          </tr>
          
          <tr num="5">
            <!-- <td>5</td> -->
            <td>Ensure EC2 Instance does not have open SMTP port</td>
            <td>SMTP Port 25, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1","tcp") and ( (FromPort lte 25 and ToPort gte 25) ) ] ] </td>
          </tr>
          
          <tr num="6">
            <!-- <td>6</td> -->
            <td>Communications and control network protection: Ensure no rule exists which allows all ingress traffic in Network ACL which is associated with a subnet</td>
            <td>Network ACLs are designed to provide a secondary layer of security. Adding a rule that allows all network traffic (all protocols, IPs, and source) prior to any deny rule defeats the purpose of network ACLs. Network ACLs associated with subnets and VPCs should not allow all ingress traffic.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL where Subnets len( ) gt 0 should not have Rules with [ Egress eq False and RuleAction eq "allow" and Protocol eq "-1" and CidrBlock eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="7">
            <!-- <td>7</td> -->
            <td>Ensure EC2 Instance does not have open UDP ports</td>
            <td>UDP Ports 22, 80, 443, 1433, 1521, 3306, 3389, 5432, 27017, 27018, 27019 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1", "udp") and ( ( FromPort lte 22 and ToPort gte 22) or ( FromPort lte 80 and ToPort gte 80) or ( FromPort lte 443 and ToPort gte 443) or ( FromPort lte 1433 and ToPort gte 1433) or ( FromPort lte 1521 and ToPort gte 1521) or ( FromPort lte 3306 and ToPort gte 3306) or ( FromPort lte 3389 and ToPort gte 3389) or ( FromPort lte 5432 and ToPort gte 5432) or ( FromPort lte 27019 and ToPort gte 27017) ) ] ] </td>
          </tr>
          
          <tr num="8">
            <!-- <td>8</td> -->
            <td>Ensure SNS Topics do not have Policies containing AddPermission Action to all principals</td>
            <td>SNS Topic should not have Policy with Add Permission Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action has ( "SNS:AddPermission" ) or Action has ( "sns:AddPermission" ) or Action has ( "SNS:*" ) or Action has ( "sns:*" ) ) and Principal has ( "*" ) and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="9">
            <!-- <td>9</td> -->
            <td>Ensure CloudWatch alarm has at least one Action</td>
            <td>Each CloudWatch alarm should have at least one action</td>
            <td>
            
              CloudWatch<br>
            
            </td>
            <td class="code">MetricAlarm should have AlarmActions with [ SNSTopic . id ] </td>
          </tr>
          
          <tr num="10">
            <!-- <td>10</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect Allow and NotActions</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Effect eq "Allow" and ( NotAction len ( ) gt 0 or Action with [ value eq "*" ] ) ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="11">
            <!-- <td>11</td> -->
            <td>Ensure ChangeMessageVisibility Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have ChangeMessageVisibility action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action has ( "SQS:ChangeMessageVisibility" ) or Action has ( "SQS:*" ) or Action has ( "sqs:ChangeMessageVisibility" ) or Action has ( "sqs:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="12">
            <!-- <td>12</td> -->
            <td>Access permissions and authorizations: Ensure Redshift Clusters are not Publicly accessible</td>
            <td>Redshift Clusters should not be accessible to the public.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should not have Access eq "Public" </td>
          </tr>
          
          <tr num="13">
            <!-- <td>13</td> -->
            <td>Ensure Delete Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have Delete action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action has ( "s3:Delete*" ) or Action has ("S3:Delete*") or Action has ("S3:*") or Action has ("s3:*") ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="14">
            <!-- <td>14</td> -->
            <td>Ensure Delete Message Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have DeleteMessage action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action has ( "SQS:DeleteMessage" ) or Action has ( "SQS:*" ) or Action has ( "sqs:DeleteMessage" ) or Action has ( "sqs:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="15">
            <!-- <td>15</td> -->
            <td>Ensure SNS Topics do not have Policies containing Delete Topic Action to all principals</td>
            <td>SNS Topic should not have Policy with Delete Topic Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action has ( "SNS:DeleteTopic" ) or Action has ( "sns:DeleteTopic" ) or Action has ( "SNS:*" ) or Action has ( "sns:*" ) ) and Principal has ( "*" ) and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="16">
            <!-- <td>16</td> -->
            <td>Ensure Domain Auto Renew is enabled</td>
            <td>To ensure that the domain is always up, enable Auto Domain Renewal</td>
            <td>
            
              Route53<br>
            
            </td>
            <td class="code">Route53Domain should have AutoRenew </td>
          </tr>
          
          <tr num="17">
            <!-- <td>17</td> -->
            <td>Ensure Domain Transfer Lock is enabled</td>
            <td>To lock a domain to prevent unauthorized transfer to another registrar.</td>
            <td>
            
              Route53<br>
            
            </td>
            <td class="code">Route53Domain should have TransferLock </td>
          </tr>
          
          <tr num="18">
            <!-- <td>18</td> -->
            <td>Ensure Get Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have Get action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action has ( "s3:GetObject*" ) or Action has ( "S3:GetObject*" ) or Action has ( "s3:*" ) or Action has ( "S3:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="19">
            <!-- <td>19</td> -->
            <td>Ensure Get Queue Attribute Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have GetQueueAttribute action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action has ( "SQS:GetQueueAttributes" ) or Action has ( "SQS:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="20">
            <!-- <td>20</td> -->
            <td>Ensure Get Queue URL Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have GetQueueURL action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action has ( "SQS:GetQueueUrl" ) or Action has ( "sqs:GetQueueUrl" ) or Action has ( "SQS:*" ) or Action has ( "sqs:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="21">
            <!-- <td>21</td> -->
            <td>Ensure Deletion Protection is enabled on Elastic Load Balancer</td>
            <td>Enabling deletion protection on load balancers mitigates risks of accidental deletion.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer should have DeletionProtection </td>
          </tr>
          
          <tr num="22">
            <!-- <td>22</td> -->
            <td>Ensure List Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have List action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action has ("s3:ListBucket*" ) or Action has ("S3:ListBucket*" ) or Action has ("s3:*" ) or Action has ("S3:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="23">
            <!-- <td>23</td> -->
            <td>Ensure Manage Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have Manage action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action has ("s3:Put*" ) or Action has ("S3:Put*" ) or Action has ("s3:*" ) or Action has ("S3:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="24">
            <!-- <td>24</td> -->
            <td>Ensure default security groups of EC2Instances contain rules</td>
            <td>Non-empty rule sets for default security groups should not exist.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance where SecurityGroups with [ Name eq "default" ] should not have SecurityGroups with [ InboundRules len ( ) neq 0 or OutboundRules len ( ) neq 0 ] </td>
          </tr>
          
          <tr num="25">
            <!-- <td>25</td> -->
            <td>Data-in-transit is protected: Ensure older SSL/TLS policies are not used with Elastic Load Balancers</td>
            <td>Older SSL/TLS policy should not be used with Elastic Load Balancer Security Policy.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer should have SslPolicy in ( "ELBSecurityPolicy-2016-08", "ELBSecurityPolicy-TLS-1-2-2017-01", "ELBSecurityPolicy-TLS-1-1-2017-01" ) </td>
          </tr>
          
          <tr num="26">
            <!-- <td>26</td> -->
            <td>Access permissions and authorizations: Ensure RDS Instances do not have Publicly Accessible Snapshots</td>
            <td>RDS Instances should not have publicly accessible snapshots.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have Snapshots with [ PubliclyAccessible ] </td>
          </tr>
          
          <tr num="27">
            <!-- <td>27</td> -->
            <td>Ensure SNS Topics do not have Policies containing Publish Action to all principals</td>
            <td>SNS Topic should not have Policy with Publish Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action has ( "SNS:Publish" ) or Action has ( "sns:Publish" ) or Action has ( "SNS:*" ) or Action has ( "sns:*" ) ) and Principal has ( "*" ) and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="28">
            <!-- <td>28</td> -->
            <td>Ensure PurgeQueue Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue should not have Policy with PurgeQueue Action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action has ( "SQS:PurgeQueue" ) or Action has ( "sqs:PurgeQueue" ) or Action has ( "SQS:*" ) or Action has ( "sqs:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="29">
            <!-- <td>29</td> -->
            <td>Ensure Put Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have Put action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action has ("s3:PutObject*" ) or Action has ("S3:PutObject*" ) or Action has ("s3:*" ) or Action has ("S3:*" )) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="30">
            <!-- <td>30</td> -->
            <td>Ensure SNS Topics do not have Policies containing Receive Action to all principals</td>
            <td>SNS Topic should not have Policy with Receive Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action has ( "SNS:Receive" ) or Action has ( "sns:Receive" ) or Action has ( "SNS:*" ) or Action has ( "sns:*" ) ) and Principal has ( "*" ) and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="31">
            <!-- <td>31</td> -->
            <td>Ensure ReceiveMessage Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have ReceiveMessage action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action has ( "SQS:ReceiveMessage" ) or Action has ( "sqs:ReceiveMessage" ) or Action has ( "SQS:*" ) or Action has ( "sqs:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="32">
            <!-- <td>32</td> -->
            <td>Ensure SNS Topics do not have Policies containing Remove Permission Action to all principals</td>
            <td>SNS Topic should not have Policy with Remove Permission Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action has ( "SNS:RemovePermission" ) or Action has ( "sns:RemovePermission" ) or Action has ( "SNS:*" ) or Action has ( "sns:*" ) ) and Principal has ( "*" ) and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="33">
            <!-- <td>33</td> -->
            <td>Ensure roles are not passed to CloudFormation stacks</td>
            <td>Passing a role to CloudFormation stacks may result in privilege escalation because IAM users with privileges, within the CloudFormation scope, implicitly inherit the stack's role's permissions.</td>
            <td>
            
              CloudFormation<br>
            
            </td>
            <td class="code">CloudFormation where Status in ("CREATE_COMPLETE", "UPDATE_COMPLETE") should not have StackRole . id </td>
          </tr>
          
          <tr num="34">
            <!-- <td>34</td> -->
            <td>Ensure SendEmail Action in SES Policy is not authorized to all principals</td>
            <td>SES should not have Policy with action as SendEmail, authorized to all principals</td>
            <td>
            
              SES<br>
            
            </td>
            <td class="code">SESIdentity should not have Policy with [ Statement with [ Effect eq "Allow" and ( Action has ( "ses:SendEmail" ) or Action has ( "ses:SendRawEmail" ) )and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="35">
            <!-- <td>35</td> -->
            <td>Ensure SendMessage Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have SendMessage action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action has ( "SQS:SendMessage" ) or Action has ( "sqs:SendMessage" ) or Action has ( "SQS:*" ) or Action has ( "sqs:*" ) ) and Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="36">
            <!-- <td>36</td> -->
            <td>Ensure SNS Topics do not have Policies containing Set Topic Attribute Action to all principals</td>
            <td>SNS Topic should not have Policy with Set Topic Attribute Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action has ( "SNS:SetTopicAttributes" ) or Action has ( "sns:SetTopicAttributes" ) or Action has ( "SNS:*" ) or Action has ( "sns:*" ) ) and Principal has ( "*" ) and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="37">
            <!-- <td>37</td> -->
            <td>Backups of information: Ensure Backup Retention Period is set greater than or equal to 30 days.</td>
            <td>Setting Backup Retention Period of RDS Instance to a value greater than or equal to 30 ensures safety of data.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have BackupRetentionPeriod lt 30 </td>
          </tr>
          
          <tr num="38">
            <!-- <td>38</td> -->
            <td>Ensure SNS Topics do not have Policies containing Subscribe Action to all principals</td>
            <td>SNS Topic should not have Policy with Subscribe Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action has ( "SNS:Subscribe" ) or Action has ( "sns:Subscribe" ) or Action has ( "SNS:*" ) or Action has ( "sns:*" ) ) and Principal has ( "*" ) and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="39">
            <!-- <td>39</td> -->
            <td>Ensure unused role for EC2Instance does not exist</td>
            <td>IAMRoles which are not attached to any EC2Instance should not exist.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have InstanceProfile with [ InstanceCount eq 0 ] </td>
          </tr>
          
          <tr num="40">
            <!-- <td>40</td> -->
            <td>Ensure that no inline policy is attached to an IAMUser</td>
            <td>IAMUsers should not have any Inline policy attached to them.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have Policies . Inline len ( ) > 0 </td>
          </tr>
          
          <tr num="41">
            <!-- <td>41</td> -->
            <td>Ensure that an IAMUser has no more than 1 Active API Key</td>
            <td>IAMUsers should not have multiple active API keys</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have every AccessKey with [ Active eq true] </td>
          </tr>
          
          <tr num="42">
            <!-- <td>42</td> -->
            <td>Vulnerability management plan: Ensure Allow Version Upgrade is set to yes for Redshift Cluster</td>
            <td>Redshift Clusters should have Version Upgrade set to avoid missing important security updates.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should have AllowVersionUpgrade </td>
          </tr>
          
          <tr num="43">
            <!-- <td>43</td> -->
            <td>Ensure EC2 Instance does not have open MySQL port</td>
            <td>MySQL Port 3306, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1", "tcp") and ( (FromPort lte 3306 and ToPort gte 3306) ) ] ] </td>
          </tr>
          
          <tr num="44">
            <!-- <td>44</td> -->
            <td>Ensure EC2 Instance does not have open SQL Server port</td>
            <td>MySQL Port 1433, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1", "tcp") and ( (FromPort lte 1433 and ToPort gte 1433) ) ] ] </td>
          </tr>
          
          <tr num="45">
            <!-- <td>45</td> -->
            <td>Ensure EC2 Instance does not have open OracleDb port</td>
            <td>OracleDb Port 1521, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1","tcp") and ( (FromPort lte 1521 and ToPort gte 1521) ) ] ] </td>
          </tr>
          
          <tr num="46">
            <!-- <td>46</td> -->
            <td>Ensure EC2 Instance does not have open PostgreSQL port</td>
            <td>PostgreSQL Port 5432, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1","tcp") and ( (FromPort lte 5432 and ToPort gte 5432) ) ] ] </td>
          </tr>
          
          <tr num="47">
            <!-- <td>47</td> -->
            <td>Ensure EC2 Instance does not have open RDP port</td>
            <td>RDP Port 3389, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1","udp","tcp") and ( (FromPort lte 3389 and ToPort gte 3389) ) ] ] </td>
          </tr>
          
          <tr num="48">
            <!-- <td>48</td> -->
            <td>Ensure EC2 Instance does not have open SSH port</td>
            <td>SSH Port 22, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1","tcp") and ( (FromPort lte 22 and ToPort gte 22) ) ] ] </td>
          </tr>
          
          <tr num="49">
            <!-- <td>49</td> -->
            <td>Data-at-rest is protected: Ensure RDS encryption is enabled</td>
            <td>Ensure RDS encryption is enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have StorageEncrypted eq true </td>
          </tr>
          
          <tr num="50">
            <!-- <td>50</td> -->
            <td>Communications and control network protection: Ensure RDS instances are not in public subnets</td>
            <td>Ensure RDS instances are not in public subnets.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code"> RDSInstance should not have Access eq "Public" </td>
          </tr>
          
          <tr num="51">
            <!-- <td>51</td> -->
            <td>Ensure RDS database instances have detailed monitoring enabled</td>
            <td>Ensure RDS database instances have detailed monitoring enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have MonitoringInterval eq 0 </td>
          </tr>
          
          <tr num="52">
            <!-- <td>52</td> -->
            <td>Data-at-rest is protected: Ensure RDS instance snapshots are encrypted</td>
            <td>Ensure RDS instance snapshots are encrypted.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have every Snapshots with [ Encrypted eq true ] </td>
          </tr>
          
          <tr num="53">
            <!-- <td>53</td> -->
            <td>Backups of information: Ensure DynamoDB tables are backed up</td>
            <td>Ensure DynamoDB tables are backed up.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have BackedUp eq true </td>
          </tr>
          
          <tr num="54">
            <!-- <td>54</td> -->
            <td>Backups of information: Ensure DynamoDB tables have point in time recovery enabled</td>
            <td>Ensure DynamoDB tables have point in time recovery enabled.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have PointInTimeRecovery eq "ENABLED" </td>
          </tr>
          
          <tr num="55">
            <!-- <td>55</td> -->
            <td>Data-at-rest is protected: Ensure DynamoDB tables are encrypted at rest</td>
            <td>Ensure DynamoDB tables are encrypted at rest.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have SSEDescription . Status eq "ENABLED" </td>
          </tr>
          
          <tr num="56">
            <!-- <td>56</td> -->
            <td>Ensure Amazon Redshift clusters are launched within a Virtual Private Cloud (VPC)</td>
            <td>Ensure Amazon Redshift clusters are launched within a Virtual Private Cloud (VPC).</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have VPC len ( ) gt 0 </td>
          </tr>
          
          <tr num="57">
            <!-- <td>57</td> -->
            <td>Ensure automated snapshots are enabled for Redshift clusters</td>
            <td>Ensure automated snapshots are enabled for Redshift clusters.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have AutomatedSnapshotRetentionPeriod gt 0 </td>
          </tr>
          
          <tr num="58">
            <!-- <td>58</td> -->
            <td>Ensure Amazon Redshift clusters are not using port 5439 (default port) for database access.</td>
            <td>Ensure Amazon Redshift clusters are not using port 5439 (default port) for database access.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should not have Port eq 5439 </td>
          </tr>
          
          <tr num="59">
            <!-- <td>59</td> -->
            <td>Data-in-transit is protected: Ensure encryption in transit is enabled for lambda functions using environmental variables.</td>
            <td>Ensure encryption in transit is enabled for lambda functions using environmental variables.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda where ( Environment len() > 0 ) should have KMSKey.id </td>
          </tr>
          
          <tr num="60">
            <!-- <td>60</td> -->
            <td>Ensure Lambda functions do not have administrative level execution privileges.</td>
            <td>Ensure Lambda functions do not have administrative level execution privileges</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have AdminPrivileges eq True </td>
          </tr>
          
          <tr num="61">
            <!-- <td>61</td> -->
            <td>Ensure EKS Clusters have logging enabled.</td>
            <td>Ensure EKS Clusters have logging enabled</td>
            <td>
            
              EKSCluster<br>
            
            </td>
            <td class="code">EKSCluster should have Logging . ClusterLogging with [ Type has ( "api", "audit", "authenticator", "controllerManager", "scheduler") and Enabled eq true ] </td>
          </tr>
          
          <tr num="62">
            <!-- <td>62</td> -->
            <td>Ensure unattached EBS volumes are removed.</td>
            <td>Ensure unattached EBS volumes are removed.</td>
            <td>
            
              EC2Instance<br>
            
            </td>
            <td class="code">Volume should not have Attachments len ( ) eq 0 </td>
          </tr>
          
          <tr num="63">
            <!-- <td>63</td> -->
            <td>Ensure EBS Snapshots are encrypted.</td>
            <td>Ensure EBS Snapshots are encrypted</td>
            <td>
            
              EC2Instance<br>
            
            </td>
            <td class="code">Volume should have Snapshot . Encrypted eq true </td>
          </tr>
          
          <tr num="64">
            <!-- <td>64</td> -->
            <td>Ensure Lambda functions have an associated Tag.</td>
            <td>Ensure Lambda functions have an associated Tag.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have Tags len( ) eq 0 </td>
          </tr>
          
          <tr num="65">
            <!-- <td>65</td> -->
            <td>Ensure Lambda execution role has permissions to log to CloudWatch.</td>
            <td>Ensure Lambda execution role has permissions to log to CloudWatch.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should have IAMRole . Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "logs:CreateLogGroup" ] and Action with [ value eq "logs:CreateLogStream" ] and Action with [ value eq "logs:PutLogEvents" ] ] ] or IAMRole . Policies . Managed with [ id like "AWSLambdaBasicExecutionRole" ] </td>
          </tr>
          
          <tr num="66">
            <!-- <td>66</td> -->
            <td>Ensure Lambda execution role does not have IAM admin permissions.</td>
            <td>Ensure Lambda execution role does not have IAM admin permissions.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have IAMRole . Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "iam:*" ] ] ] or IAMRole . Policies . Managed with [ id like "IAMFullAccess" ] </td>
          </tr>
          
          <tr num="67">
            <!-- <td>67</td> -->
            <td>Ensure Lambda execution role does not have full admin permissions.</td>
            <td>Ensure Lambda execution role does not have full admin permissions.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have IAMRole . Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "*" ] ] ] or IAMRole . Policies . Managed with [ id like "AdministratorAccess" ] </td>
          </tr>
          
          <tr num="68">
            <!-- <td>68</td> -->
            <td>Ensure CloudTrail logs to S3Bucket without any failures.</td>
            <td>Alert if any Error is encountered by CloudTrail while logging to the designated S3Bucket.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LatestDeliveryError eq "None" </td>
          </tr>
          
          <tr num="69">
            <!-- <td>69</td> -->
            <td>Ensure CloudTrail sends SNS notifications without any failures.</td>
            <td>Alert if any Error is encountered by CloudTrail when attempting to send a SNS notification.</td>
            <td>
            
              SNS<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LatestNotificationError eq "None" </td>
          </tr>
          
          <tr num="70">
            <!-- <td>70</td> -->
            <td>Ensure CloudTrail logging bucket has Multi-Factor Authentication (MFA) Enabled.</td>
            <td>Ensure that your AWS CloudTrail logging bucket use Multi-Factor Authentication (MFA) Delete feature in order to prevent the deletion of any versioned log files.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . BucketVersioning . MFADelete eq "Enabled" </td>
          </tr>
          
          <tr num="71">
            <!-- <td>71</td> -->
            <td>Ensure VPC Flow Log records are successfully published to a CloudWatch log group or an Amazon S3 bucket.</td>
            <td>Ensure VPC Flow Log records are successfully published to a CloudWatch log group or an Amazon S3 bucket.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPCFlow where Status eq "ACTIVE" should have DeliverLogsStatus eq "SUCCESS" </td>
          </tr>
          
          <tr num="72">
            <!-- <td>72</td> -->
            <td>Ensure S3 Bucket is not publicly accessible.</td>
            <td>Ensure S3 Bucket is not publicly accessible</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have Access eq "Public" </td>
          </tr>
          
          <tr num="73">
            <!-- <td>73</td> -->
            <td>Ensure no user has the AdministratorAccess policy</td>
            <td>Ensure users are not attached to the overly-privileged AdministratorAccess IAM policy.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have Policies . Managed with [ id eq "arn:aws:iam::aws:policy/AdministratorAccess" ] </td>
          </tr>
          
          <tr num="74">
            <!-- <td>74</td> -->
            <td>Ensure EC2 Instance does not have open TCP ports</td>
            <td>TCP Ports 22, 80, 443, 1433, 1521, 3306, 3389, 5432, 27017, 27018, 27019 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ Protocol in ("-1", "tcp") and ( ( FromPort lte 22 and ToPort gte 22) or ( FromPort lte 80 and ToPort gte 80) or ( FromPort lte 443 and ToPort gte 443) or ( FromPort lte 1433 and ToPort gte 1433) or ( FromPort lte 1521 and ToPort gte 1521) or ( FromPort lte 3306 and ToPort gte 3306) or ( FromPort lte 3389 and ToPort gte 3389) or ( FromPort lte 5432 and ToPort gte 5432) or ( FromPort lte 27019 and ToPort gte 27017) ) ] ] </td>
          </tr>
          
          <tr num="75">
            <!-- <td>75</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">AWS should have atleast one IAMPolicies with [ id eq "arn:aws:iam::aws:policy/AWSSupportAccess" and ( AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 or AttachedEntities . Groups len ( ) gt 0 ) ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CCM">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="76">
            <!-- <td>76</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="77">
            <!-- <td>77</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="78">
            <!-- <td>78</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="79">
            <!-- <td>79</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="80">
            <!-- <td>80</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="81">
            <!-- <td>81</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="82">
            <!-- <td>82</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="83">
            <!-- <td>83</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="84">
            <!-- <td>84</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="85">
            <!-- <td>85</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="86">
            <!-- <td>86</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="87">
            <!-- <td>87</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="88">
            <!-- <td>88</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="89">
            <!-- <td>89</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="90">
            <!-- <td>90</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="91">
            <!-- <td>91</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="92">
            <!-- <td>92</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="93">
            <!-- <td>93</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="94">
            <!-- <td>94</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="95">
            <!-- <td>95</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="96">
            <!-- <td>96</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="97">
            <!-- <td>97</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="98">
            <!-- <td>98</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="99">
            <!-- <td>99</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="100">
            <!-- <td>100</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="101">
            <!-- <td>101</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="102">
            <!-- <td>102</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="103">
            <!-- <td>103</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*" and FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="104">
            <!-- <td>104</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*" and FilterPattern like "\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="105">
            <!-- <td>105</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*" and FilterPattern like "\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*" and FilterPattern like "\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="106">
            <!-- <td>106</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="107">
            <!-- <td>107</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StartLogging\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StopLogging\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="108">
            <!-- <td>108</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*" and FilterPattern like "\s*\(\$\.errorMessage\s*=\s*\"Failed authentication\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="109">
            <!-- <td>109</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableKey\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*ScheduleKeyDeletion\)\s*" ) and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="110">
            <!-- <td>110</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketAcl\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="111">
            <!-- <td>111</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*StopConfigurationRecorder\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutConfigurationRecorder\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="112">
            <!-- <td>112</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="113">
            <!-- <td>113</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="114">
            <!-- <td>114</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="115">
            <!-- <td>115</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="116">
            <!-- <td>116</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="117">
            <!-- <td>117</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="118">
            <!-- <td>118</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="119">
            <!-- <td>119</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CIS">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="120">
            <!-- <td>120</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="121">
            <!-- <td>121</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="122">
            <!-- <td>122</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="123">
            <!-- <td>123</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="124">
            <!-- <td>124</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="125">
            <!-- <td>125</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="126">
            <!-- <td>126</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="127">
            <!-- <td>127</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="128">
            <!-- <td>128</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="129">
            <!-- <td>129</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="130">
            <!-- <td>130</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="131">
            <!-- <td>131</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="132">
            <!-- <td>132</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="133">
            <!-- <td>133</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="134">
            <!-- <td>134</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="135">
            <!-- <td>135</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="136">
            <!-- <td>136</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
          <tr num="137">
            <!-- <td>137</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="138">
            <!-- <td>138</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="139">
            <!-- <td>139</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="140">
            <!-- <td>140</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="141">
            <!-- <td>141</td> -->
            <td>Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . Access eq "Public" </td>
          </tr>
          
          <tr num="142">
            <!-- <td>142</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="143">
            <!-- <td>143</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="144">
            <!-- <td>144</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="145">
            <!-- <td>145</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="146">
            <!-- <td>146</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="147">
            <!-- <td>147</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="148">
            <!-- <td>148</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*" and FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="149">
            <!-- <td>149</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*" and FilterPattern like "\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="150">
            <!-- <td>150</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*" and FilterPattern like "\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*" and FilterPattern like "\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="151">
            <!-- <td>151</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="152">
            <!-- <td>152</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StartLogging\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StopLogging\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="153">
            <!-- <td>153</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*" and FilterPattern like "\s*\(\$\.errorMessage\s*=\s*\"Failed authentication\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="154">
            <!-- <td>154</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableKey\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*ScheduleKeyDeletion\)\s*" ) and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="155">
            <!-- <td>155</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketAcl\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="156">
            <!-- <td>156</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*StopConfigurationRecorder\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutConfigurationRecorder\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="157">
            <!-- <td>157</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="158">
            <!-- <td>158</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="159">
            <!-- <td>159</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="160">
            <!-- <td>160</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="161">
            <!-- <td>161</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="162">
            <!-- <td>162</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="163">
            <!-- <td>163</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GDPR">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="164">
            <!-- <td>164</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="165">
            <!-- <td>165</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="166">
            <!-- <td>166</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="167">
            <!-- <td>167</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="168">
            <!-- <td>168</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="169">
            <!-- <td>169</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="170">
            <!-- <td>170</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="171">
            <!-- <td>171</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="172">
            <!-- <td>172</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="173">
            <!-- <td>173</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="174">
            <!-- <td>174</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="175">
            <!-- <td>175</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="176">
            <!-- <td>176</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="177">
            <!-- <td>177</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="178">
            <!-- <td>178</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="179">
            <!-- <td>179</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="180">
            <!-- <td>180</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="181">
            <!-- <td>181</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="182">
            <!-- <td>182</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="183">
            <!-- <td>183</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="184">
            <!-- <td>184</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="185">
            <!-- <td>185</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="186">
            <!-- <td>186</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="187">
            <!-- <td>187</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="188">
            <!-- <td>188</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="189">
            <!-- <td>189</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="190">
            <!-- <td>190</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="191">
            <!-- <td>191</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="192">
            <!-- <td>192</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="HIPAA">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="193">
            <!-- <td>193</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="194">
            <!-- <td>194</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="195">
            <!-- <td>195</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="196">
            <!-- <td>196</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="197">
            <!-- <td>197</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="198">
            <!-- <td>198</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="199">
            <!-- <td>199</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="200">
            <!-- <td>200</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="201">
            <!-- <td>201</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="202">
            <!-- <td>202</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="203">
            <!-- <td>203</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="204">
            <!-- <td>204</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="205">
            <!-- <td>205</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="206">
            <!-- <td>206</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="207">
            <!-- <td>207</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="208">
            <!-- <td>208</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="209">
            <!-- <td>209</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="210">
            <!-- <td>210</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="211">
            <!-- <td>211</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="212">
            <!-- <td>212</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="213">
            <!-- <td>213</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="214">
            <!-- <td>214</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="215">
            <!-- <td>215</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="216">
            <!-- <td>216</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="217">
            <!-- <td>217</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="218">
            <!-- <td>218</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="219">
            <!-- <td>219</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="220">
            <!-- <td>220</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="ISO27K">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="221">
            <!-- <td>221</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="222">
            <!-- <td>222</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="223">
            <!-- <td>223</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="224">
            <!-- <td>224</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="225">
            <!-- <td>225</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="226">
            <!-- <td>226</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="227">
            <!-- <td>227</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="228">
            <!-- <td>228</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="229">
            <!-- <td>229</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="230">
            <!-- <td>230</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="231">
            <!-- <td>231</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="232">
            <!-- <td>232</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="233">
            <!-- <td>233</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="234">
            <!-- <td>234</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="235">
            <!-- <td>235</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="236">
            <!-- <td>236</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="237">
            <!-- <td>237</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="238">
            <!-- <td>238</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="239">
            <!-- <td>239</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="240">
            <!-- <td>240</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="241">
            <!-- <td>241</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="242">
            <!-- <td>242</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="243">
            <!-- <td>243</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="244">
            <!-- <td>244</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="245">
            <!-- <td>245</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="246">
            <!-- <td>246</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="247">
            <!-- <td>247</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="248">
            <!-- <td>248</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*" and FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="249">
            <!-- <td>249</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*" and FilterPattern like "\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="250">
            <!-- <td>250</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*" and FilterPattern like "\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*" and FilterPattern like "\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="251">
            <!-- <td>251</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="252">
            <!-- <td>252</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StartLogging\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StopLogging\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="253">
            <!-- <td>253</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*" and FilterPattern like "\s*\(\$\.errorMessage\s*=\s*\"Failed authentication\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="254">
            <!-- <td>254</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableKey\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*ScheduleKeyDeletion\)\s*" ) and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="255">
            <!-- <td>255</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketAcl\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="256">
            <!-- <td>256</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*StopConfigurationRecorder\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutConfigurationRecorder\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="257">
            <!-- <td>257</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="258">
            <!-- <td>258</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="259">
            <!-- <td>259</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="260">
            <!-- <td>260</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="261">
            <!-- <td>261</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="262">
            <!-- <td>262</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="263">
            <!-- <td>263</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="264">
            <!-- <td>264</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="265">
            <!-- <td>265</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="266">
            <!-- <td>266</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="267">
            <!-- <td>267</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="268">
            <!-- <td>268</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="269">
            <!-- <td>269</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="270">
            <!-- <td>270</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="271">
            <!-- <td>271</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="272">
            <!-- <td>272</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="273">
            <!-- <td>273</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="274">
            <!-- <td>274</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*" and FilterPattern like "\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="275">
            <!-- <td>275</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*" and FilterPattern like "\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*" and FilterPattern like "\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="276">
            <!-- <td>276</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="277">
            <!-- <td>277</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*" and FilterPattern like "\s*\(\$\.errorMessage\s*=\s*\"Failed authentication\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="278">
            <!-- <td>278</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="279">
            <!-- <td>279</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="280">
            <!-- <td>280</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="281">
            <!-- <td>281</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="282">
            <!-- <td>282</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*" and FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="283">
            <!-- <td>283</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="284">
            <!-- <td>284</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="285">
            <!-- <td>285</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with iam:PassRole for All Roles</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "iam:PassRole" ] and Resource with [ value eq "*" ] ] </td>
          </tr>
          
          <tr num="286">
            <!-- <td>286</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with sts:AssumeRole for All Roles</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have AssumeRolePolicy . Statement with [ Action eq "sts:AssumeRole" and Principal . AWS has ("*") ] </td>
          </tr>
          
          <tr num="287">
            <!-- <td>287</td> -->
            <td>Establish an access control system(s) : S3 Bucket ACLs with Grant Access to All Users</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee . URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] </td>
          </tr>
          
          <tr num="288">
            <!-- <td>288</td> -->
            <td>Establish an access control system(s) : S3 Bucket ACLs with Grant Access to Authenticated Users</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee . Type eq "Group" and Grantee . URI eq "http://acs.amazonaws.com/groups/global/AuthenticatedUsers" ] </td>
          </tr>
          
          <tr num="289">
            <!-- <td>289</td> -->
            <td>Access permissions and authorizations: Ensure Redshift Clusters are not Publicly accessible</td>
            <td>Redshift Clusters should not be accessible to the public.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should not have Access eq "Public" </td>
          </tr>
          
          <tr num="290">
            <!-- <td>290</td> -->
            <td>Access permissions and authorizations: Ensure RDS Instances do not have Publicly Accessible Snapshots</td>
            <td>RDS Instances should not have publicly accessible snapshots.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have Snapshots with [ PubliclyAccessible ] </td>
          </tr>
          
          <tr num="291">
            <!-- <td>291</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="292">
            <!-- <td>292</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="293">
            <!-- <td>293</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="294">
            <!-- <td>294</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="295">
            <!-- <td>295</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="296">
            <!-- <td>296</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="297">
            <!-- <td>297</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="298">
            <!-- <td>298</td> -->
            <td>Establish an access control system(s) : Inadequate Access Controls on S3 Buckets</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket where BucketVersioning . Status eq "Enabled" should not have BucketVersioning . MFADelete eq "Disabled" </td>
          </tr>
          
          <tr num="299">
            <!-- <td>299</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="300">
            <!-- <td>300</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableKey\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*ScheduleKeyDeletion\)\s*" ) and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="301">
            <!-- <td>301</td> -->
            <td>Data-at-rest is protected: Ensure RDS encryption is enabled</td>
            <td>Ensure RDS encryption is enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have StorageEncrypted eq true </td>
          </tr>
          
          <tr num="302">
            <!-- <td>302</td> -->
            <td>Data-at-rest is protected: Ensure RDS instance snapshots are encrypted</td>
            <td>Ensure RDS instance snapshots are encrypted.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have every Snapshots with [ Encrypted eq true ] </td>
          </tr>
          
          <tr num="303">
            <!-- <td>303</td> -->
            <td>Data-at-rest is protected: Ensure DynamoDB tables are encrypted at rest</td>
            <td>Ensure DynamoDB tables are encrypted at rest.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have SSEDescription . Status eq "ENABLED" </td>
          </tr>
          
          <tr num="304">
            <!-- <td>304</td> -->
            <td>Render PAN unreadable anywhere it is stored : Redshift Cluster Not Encrypted At Rest</td>
            <td>Render PAN unreadable anywhere it is stored (including on portable digital media, backup media, and in logs) by using any of the following approaches: One-way hashes based on strong cryptography, (hash must be of the entire PAN). ; Truncation (hashing cannot be used to replace the truncated segment of PAN). ; Index tokens and pads (pads must be securely stored). ; Strong cryptography with associated key-management processes and procedures. ; Note: It is a relatively trivial effort for a malicious individual to reconstruct original PAN date if they have access to both the truncated and hashed version of a PAN. Where hashed and truncated versions of the same PAN are present in an entity’s environment, additional controls must be in place to ensure that the hashed and truncated versions cannot be correlated to reconstruct the original PAN</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have Encrypted eq true </td>
          </tr>
          
          <tr num="305">
            <!-- <td>305</td> -->
            <td>Data-in-transit is protected: Ensure older SSL/TLS policies are not used with Elastic Load Balancers</td>
            <td>Older SSL/TLS policy should not be used with Elastic Load Balancer Security Policy.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer should have SslPolicy in ( "ELBSecurityPolicy-2016-08", "ELBSecurityPolicy-TLS-1-2-2017-01", "ELBSecurityPolicy-TLS-1-1-2017-01" ) </td>
          </tr>
          
          <tr num="306">
            <!-- <td>306</td> -->
            <td>Data-in-transit is protected: Ensure encryption in transit is enabled for lambda functions using environmental variables.</td>
            <td>Ensure encryption in transit is enabled for lambda functions using environmental variables.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda where ( Environment len() > 0 ) should have KMSKey.id </td>
          </tr>
          
          <tr num="307">
            <!-- <td>307</td> -->
            <td>Use strong cryptography and security protocols to safeguard sensitive cardholder data during transmission: Redshift Cluster has require_ssl disabled</td>
            <td>Sensitive information must be encrypted during transmission over public networks, because it is easy and common for a malicious individual to intercept and/or divert data while in transit.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have ClusterParameterGroups with [ ClusterParameterGroup with [ ParameterName eq "require_ssl" and ParameterValue eq "true" ] ] </td>
          </tr>
          
          <tr num="308">
            <!-- <td>308</td> -->
            <td>Backups of information: Ensure Backup Retention Period is set greater than or equal to 30 days.</td>
            <td>Setting Backup Retention Period of RDS Instance to a value greater than or equal to 30 ensures safety of data.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have BackupRetentionPeriod lt 30 </td>
          </tr>
          
          <tr num="309">
            <!-- <td>309</td> -->
            <td>Backups of information: Ensure DynamoDB tables are backed up</td>
            <td>Ensure DynamoDB tables are backed up.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have BackedUp eq true </td>
          </tr>
          
          <tr num="310">
            <!-- <td>310</td> -->
            <td>Backups of information: Ensure DynamoDB tables have point in time recovery enabled</td>
            <td>Ensure DynamoDB tables have point in time recovery enabled.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have PointInTimeRecovery eq "ENABLED" </td>
          </tr>
          
          <tr num="311">
            <!-- <td>311</td> -->
            <td>Install critical security patches within one month of release. : Auto Minor Version Upgrade Disabled for RDS Instances</td>
            <td>Ensure that all system components and software are protected from known vulnerabilities by installing applicable AWS RDSInstance security patches. Install critical security patches within one month of release.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have AutoMinorVersionUpgrade eq true </td>
          </tr>
          
          <tr num="312">
            <!-- <td>312</td> -->
            <td>Vulnerability management plan: Ensure Allow Version Upgrade is set to yes for Redshift Cluster</td>
            <td>Redshift Clusters should have Version Upgrade set to avoid missing important security updates.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should have AllowVersionUpgrade </td>
          </tr>
          
          <tr num="313">
            <!-- <td>313</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="314">
            <!-- <td>314</td> -->
            <td>Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . Access eq "Public" </td>
          </tr>
          
          <tr num="315">
            <!-- <td>315</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="316">
            <!-- <td>316</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="317">
            <!-- <td>317</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="318">
            <!-- <td>318</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="319">
            <!-- <td>319</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StartLogging\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StopLogging\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="320">
            <!-- <td>320</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*StopConfigurationRecorder\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutConfigurationRecorder\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="321">
            <!-- <td>321</td> -->
            <td>Implement automated audit trails for all system components :  CloudTrail - Lack of Global Service Event Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have GlobalServiceEvents eq true </td>
          </tr>
          
          <tr num="322">
            <!-- <td>322</td> -->
            <td>Implement automated audit trails for all system components : Lack of Logging For Access to S3 Buckets</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should have LoggingEnabled </td>
          </tr>
          
          <tr num="323">
            <!-- <td>323</td> -->
            <td>Implement automated audit trails for all system components : S3 Buckets Lack Versioning</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketVersioning . Status eq "Suspended" or BucketVersioning . Status eq "Disabled" </td>
          </tr>
          
          <tr num="324">
            <!-- <td>324</td> -->
            <td>Implement automated audit trails for all system components : Redshift Parameter Groups Disable Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have LoggingEnabled eq true </td>
          </tr>
          
          <tr num="325">
            <!-- <td>325</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="326">
            <!-- <td>326</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="327">
            <!-- <td>327</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="328">
            <!-- <td>328</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="329">
            <!-- <td>329</td> -->
            <td>Review firewall and router rule sets at least every six months : Numerous Unused EC2 Security Groups</td>
            <td>Establish and implement firewall and router configuration standards that include the requirement to review firewall and router rule sets at least every six months.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name neq "default" should have NetworkInterfaces len ( ) neq 0 </td>
          </tr>
          
          <tr num="330">
            <!-- <td>330</td> -->
            <td>Restrict inbound and outbound traffic to that which is necessary for the cardholder data environment, and specifically deny all other traffic : Do not use the default security group.</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ Name eq "default" ] </td>
          </tr>
          
          <tr num="331">
            <!-- <td>331</td> -->
            <td>Do not allow unauthorized outbound traffic from the cardholder data environment to the Internet : Outbound Internet unrestricted is not allowed.</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ OutboundRules with [ IPv6Ranges with [ IPv6 in ( "::/0" ) ] or IPRanges with [ IP in ( "0.0.0.0/0" ) ] ] ] </td>
          </tr>
          
          <tr num="332">
            <!-- <td>332</td> -->
            <td>Communications and control network protection: Ensure no rule exists which allows all ingress traffic in default Network ACL</td>
            <td>Network ACLs are designed to provide a secondary layer of security. Adding a rule that allows all network traffic (all protocols, IPs, and source) prior to any deny rule defeats the purpose of network ACLs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL should not have IsDefault eq true and Rules with [ RuleAction eq "allow" and Protocol eq "-1" and Egress eq False and CidrBlock eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="333">
            <!-- <td>333</td> -->
            <td>Communications and control network protection: Ensure no rule exists which allows all ingress traffic in Network ACL which is associated with a subnet</td>
            <td>Network ACLs are designed to provide a secondary layer of security. Adding a rule that allows all network traffic (all protocols, IPs, and source) prior to any deny rule defeats the purpose of network ACLs. Network ACLs associated with subnets and VPCs should not allow all ingress traffic.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL where Subnets len( ) gt 0 should not have Rules with [ Egress eq False and RuleAction eq "allow" and Protocol eq "-1" and CidrBlock eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="334">
            <!-- <td>334</td> -->
            <td>Communications and control network protection: Ensure RDS instances are not in public subnets</td>
            <td>Ensure RDS instances are not in public subnets.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code"> RDSInstance should not have Access eq "Public" </td>
          </tr>
          
          <tr num="335">
            <!-- <td>335</td> -->
            <td>Implement an incident response plan : Lack of Multi-AZ Deployment for RDS Instances</td>
            <td>Create the incident response plan to be implemented in the event of system breach. Ensure the plan addresses the following, at a minimum: Roles, responsibilities, and communication and contact strategies in the event of a compromise including notification of the payment brands, at a minimum. ; Specific incident response procedures. ; Business recovery and continuity procedures. ; Data backup processes. ; Analysis of legal requirements for reporting compromises. ; Coverage and responses of all critical system components. ;  Reference or inclusion of incident response procedures from the payment brands</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have MultiAZ eq true </td>
          </tr>
          
          <tr num="336">
            <!-- <td>336</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="337">
            <!-- <td>337</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST800-53">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="338">
            <!-- <td>338</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="339">
            <!-- <td>339</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="340">
            <!-- <td>340</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="341">
            <!-- <td>341</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="342">
            <!-- <td>342</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="343">
            <!-- <td>343</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="344">
            <!-- <td>344</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="345">
            <!-- <td>345</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="346">
            <!-- <td>346</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="347">
            <!-- <td>347</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="348">
            <!-- <td>348</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="349">
            <!-- <td>349</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="350">
            <!-- <td>350</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="351">
            <!-- <td>351</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="352">
            <!-- <td>352</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="353">
            <!-- <td>353</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="354">
            <!-- <td>354</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="355">
            <!-- <td>355</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="356">
            <!-- <td>356</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="357">
            <!-- <td>357</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="358">
            <!-- <td>358</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="359">
            <!-- <td>359</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="360">
            <!-- <td>360</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="361">
            <!-- <td>361</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="362">
            <!-- <td>362</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="363">
            <!-- <td>363</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="364">
            <!-- <td>364</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="365">
            <!-- <td>365</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*" and FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="366">
            <!-- <td>366</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*" and FilterPattern like "\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="367">
            <!-- <td>367</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*" and FilterPattern like "\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*" and FilterPattern like "\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="368">
            <!-- <td>368</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="369">
            <!-- <td>369</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StartLogging\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StopLogging\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="370">
            <!-- <td>370</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*" and FilterPattern like "\s*\(\$\.errorMessage\s*=\s*\"Failed authentication\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="371">
            <!-- <td>371</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableKey\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*ScheduleKeyDeletion\)\s*" ) and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="372">
            <!-- <td>372</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketAcl\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="373">
            <!-- <td>373</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*StopConfigurationRecorder\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutConfigurationRecorder\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="374">
            <!-- <td>374</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="375">
            <!-- <td>375</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="376">
            <!-- <td>376</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="377">
            <!-- <td>377</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="378">
            <!-- <td>378</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="379">
            <!-- <td>379</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="380">
            <!-- <td>380</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="381">
            <!-- <td>381</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="PCI">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="382">
            <!-- <td>382</td> -->
            <td>Review firewall and router rule sets at least every six months : Numerous Unused EC2 Security Groups</td>
            <td>Establish and implement firewall and router configuration standards that include the requirement to review firewall and router rule sets at least every six months.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name neq "default" should have NetworkInterfaces len ( ) neq 0 </td>
          </tr>
          
          <tr num="383">
            <!-- <td>383</td> -->
            <td>Restrict inbound and outbound traffic to that which is necessary for the cardholder data environment, and specifically deny all other traffic : Do not use the default security group.</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ Name eq "default" ] </td>
          </tr>
          
          <tr num="384">
            <!-- <td>384</td> -->
            <td>Inbound Internet traffic is not allowed</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage. This rule specifically checks for public IPs in inbound rules of Security Group.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ InboundRules with [ IPv6Ranges with [ IPv6 isPublic ( ) ] or IPRanges with [ IP isPublic ( ) ] ] ] </td>
          </tr>
          
          <tr num="385">
            <!-- <td>385</td> -->
            <td>Inbound All ports/protocols is not allowed</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage. This rule specifically checks for security group inbound rule with all ports open.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ Protocol eq "-1" and ( FromPort eq 0 and ToPort eq 65535 ) ] </td>
          </tr>
          
          <tr num="386">
            <!-- <td>386</td> -->
            <td>Do not allow unauthorized outbound traffic from the cardholder data environment to the Internet : Outbound Internet unrestricted is not allowed.</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ OutboundRules with [ IPv6Ranges with [ IPv6 in ( "::/0" ) ] or IPRanges with [ IP in ( "0.0.0.0/0" ) ] ] ] </td>
          </tr>
          
          <tr num="387">
            <!-- <td>387</td> -->
            <td>Render PAN unreadable anywhere it is stored : Weak RDS backup policy</td>
            <td>Render PAN unreadable anywhere it is stored (including on portable digital media, backup media, and in logs) by using any of the following approaches: One-way hashes based on strong cryptography, (hash must be of the entire PAN). ; Truncation (hashing cannot be used to replace the truncated segment of PAN). ; Index tokens and pads (pads must be securely stored). ; Strong cryptography with associated key-management processes and procedures. ; Note: It is a relatively trivial effort for a malicious individual to reconstruct original PAN date if they have access to both the truncated and hashed version of a PAN. Where hashed and truncated versions of the same PAN are present in an entity’s environment, additional controls must be in place to ensure that the hashed and truncated versions cannot be correlated to reconstruct the original PAN</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have BackupRetentionPeriod neq 0 </td>
          </tr>
          
          <tr num="388">
            <!-- <td>388</td> -->
            <td>Render PAN unreadable anywhere it is stored : Redshift Cluster Not Encrypted At Rest</td>
            <td>Render PAN unreadable anywhere it is stored (including on portable digital media, backup media, and in logs) by using any of the following approaches: One-way hashes based on strong cryptography, (hash must be of the entire PAN). ; Truncation (hashing cannot be used to replace the truncated segment of PAN). ; Index tokens and pads (pads must be securely stored). ; Strong cryptography with associated key-management processes and procedures. ; Note: It is a relatively trivial effort for a malicious individual to reconstruct original PAN date if they have access to both the truncated and hashed version of a PAN. Where hashed and truncated versions of the same PAN are present in an entity’s environment, additional controls must be in place to ensure that the hashed and truncated versions cannot be correlated to reconstruct the original PAN</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have Encrypted eq true </td>
          </tr>
          
          <tr num="389">
            <!-- <td>389</td> -->
            <td>Fully document and implement all key-management processes and procedures for cryptographic keys used for encryption of cardholder data : Lack of Access Key Rotation</td>
            <td>Cryptographic key changes for keys that have reached the end of their cryptoperiod  (for example, after a defined period of time has passed and/or after a certain amount of cipher-text has been produced by a given key), as defined by the AWS or key owner, and based on industry best practices and guidelines (for example, NIST Special Publication 800-57).</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and CreatedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="390">
            <!-- <td>390</td> -->
            <td>Use strong cryptography and security protocols to safeguard sensitive cardholder data during transmission: Redshift Cluster has require_ssl disabled</td>
            <td>Sensitive information must be encrypted during transmission over public networks, because it is easy and common for a malicious individual to intercept and/or divert data while in transit.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have ClusterParameterGroups with [ ClusterParameterGroup with [ ParameterName eq "require_ssl" and ParameterValue eq "true" ] ] </td>
          </tr>
          
          <tr num="391">
            <!-- <td>391</td> -->
            <td>Install critical security patches within one month of release. : Auto Minor Version Upgrade Disabled for RDS Instances</td>
            <td>Ensure that all system components and software are protected from known vulnerabilities by installing applicable AWS RDSInstance security patches. Install critical security patches within one month of release.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have AutoMinorVersionUpgrade eq true </td>
          </tr>
          
          <tr num="392">
            <!-- <td>392</td> -->
            <td>Restrict access to cardholder data : IAM Policies with Effect as Allow and Action with iam:PassRole for All Roles</td>
            <td>Limit access to system components and cardholder data to only those individuals whose job requires such access.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have Policies . Inline with [ PolicyDocument . Statements with [ Action with [ value eq "iam:PassRole" ]]] </td>
          </tr>
          
          <tr num="393">
            <!-- <td>393</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with iam:PassRole for All Roles</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "iam:PassRole" ] and Resource with [ value eq "*" ] ] </td>
          </tr>
          
          <tr num="394">
            <!-- <td>394</td> -->
            <td>Establish an access control system(s) : Inadequate Access Controls on S3 Buckets</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket where BucketVersioning . Status eq "Enabled" should not have BucketVersioning . MFADelete eq "Disabled" </td>
          </tr>
          
          <tr num="395">
            <!-- <td>395</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with sts:AssumeRole for All Roles</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have AssumeRolePolicy . Statement with [ Action eq "sts:AssumeRole" and Principal . AWS has ("*") ] </td>
          </tr>
          
          <tr num="396">
            <!-- <td>396</td> -->
            <td>Establish an access control system(s) : IAM Headless User Account with Password</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have ( atleast one AccessKey with [ Active eq true ] and Password . Enabled eq True ) </td>
          </tr>
          
          <tr num="397">
            <!-- <td>397</td> -->
            <td>Establish an access control system(s) : S3 Bucket ACLs with Grant Access to All Users</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee . URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] </td>
          </tr>
          
          <tr num="398">
            <!-- <td>398</td> -->
            <td>Establish an access control system(s) : S3 Bucket ACLs with Grant Access to Authenticated Users</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee . Type eq "Group" and Grantee . URI eq "http://acs.amazonaws.com/groups/global/AuthenticatedUsers" ] </td>
          </tr>
          
          <tr num="399">
            <!-- <td>399</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect Allow and NotActions</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Effect eq "Allow" and ( NotAction len ( ) gt 0 or Action with [ value eq "*" ] ) ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="400">
            <!-- <td>400</td> -->
            <td>Remove/disable inactive user accounts within 90 days</td>
            <td>Define and implement policies and procedures to ensure proper user identification management for non-consumer users and administrators on all system components.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq false should not have ( ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) or ( AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] ) ) </td>
          </tr>
          
          <tr num="401">
            <!-- <td>401</td> -->
            <td>Ensure proper user-authentication management for non-consumer users and administrators : IAM Weak Password Policy</td>
            <td>Passwords/passphrases must meet the following: Require a minimum length of at least seven characters. Contain both numeric and alphabetic characters. Alternatively, the passwords/passphrases must have complexity and strength at least equivalent to the parameters specified above</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have RequireUppercaseCharacters and RequireLowercaseCharacters and (MinimumPasswordLength gte 8 or RequireSymbols ) </td>
          </tr>
          
          <tr num="402">
            <!-- <td>402</td> -->
            <td>Secure all individual non-console administrative access and all remote access using multi-factor authentication : IAM Users Lack Multi-Factor Authentication</td>
            <td>Incorporate multi-factor authentication for all remote network access (both user and administrator, and including third party access for support or maintenance) originating from outside the entity’s network</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should have MFAActive eq true </td>
          </tr>
          
          <tr num="403">
            <!-- <td>403</td> -->
            <td>Implement automated audit trails for all system components :  CloudTrail - Lack of Global Service Event Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have GlobalServiceEvents eq true </td>
          </tr>
          
          <tr num="404">
            <!-- <td>404</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="405">
            <!-- <td>405</td> -->
            <td>Implement automated audit trails for all system components : Lack of Logging For Access to S3 Buckets</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should have LoggingEnabled </td>
          </tr>
          
          <tr num="406">
            <!-- <td>406</td> -->
            <td>Implement automated audit trails for all system components : S3 Buckets Lack Versioning</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketVersioning . Status eq "Suspended" or BucketVersioning . Status eq "Disabled" </td>
          </tr>
          
          <tr num="407">
            <!-- <td>407</td> -->
            <td>Implement automated audit trails for all system components : Redshift Parameter Groups Disable Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have LoggingEnabled eq true </td>
          </tr>
          
          <tr num="408">
            <!-- <td>408</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="409">
            <!-- <td>409</td> -->
            <td>Implement an incident response plan : Lack of Multi-AZ Deployment for RDS Instances</td>
            <td>Create the incident response plan to be implemented in the event of system breach. Ensure the plan addresses the following, at a minimum: Roles, responsibilities, and communication and contact strategies in the event of a compromise including notification of the payment brands, at a minimum. ; Specific incident response procedures. ; Business recovery and continuity procedures. ; Data backup processes. ; Analysis of legal requirements for reporting compromises. ; Coverage and responses of all critical system components. ;  Reference or inclusion of incident response procedures from the payment brands</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have MultiAZ eq true </td>
          </tr>
          
          <tr num="410">
            <!-- <td>410</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="411">
            <!-- <td>411</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="412">
            <!-- <td>412</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="413">
            <!-- <td>413</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="414">
            <!-- <td>414</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="415">
            <!-- <td>415</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="416">
            <!-- <td>416</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="417">
            <!-- <td>417</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="418">
            <!-- <td>418</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="419">
            <!-- <td>419</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="420">
            <!-- <td>420</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="421">
            <!-- <td>421</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="422">
            <!-- <td>422</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="423">
            <!-- <td>423</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="424">
            <!-- <td>424</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="425">
            <!-- <td>425</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="426">
            <!-- <td>426</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="427">
            <!-- <td>427</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="428">
            <!-- <td>428</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="429">
            <!-- <td>429</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="430">
            <!-- <td>430</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="431">
            <!-- <td>431</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="432">
            <!-- <td>432</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="433">
            <!-- <td>433</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="434">
            <!-- <td>434</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="435">
            <!-- <td>435</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*" and FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="436">
            <!-- <td>436</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*" and FilterPattern like "\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="437">
            <!-- <td>437</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*" and FilterPattern like "\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*" and FilterPattern like "\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="438">
            <!-- <td>438</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="439">
            <!-- <td>439</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StartLogging\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StopLogging\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="440">
            <!-- <td>440</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*" and FilterPattern like "\s*\(\$\.errorMessage\s*=\s*\"Failed authentication\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="441">
            <!-- <td>441</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableKey\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*ScheduleKeyDeletion\)\s*" ) and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="442">
            <!-- <td>442</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketAcl\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="443">
            <!-- <td>443</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*StopConfigurationRecorder\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutConfigurationRecorder\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="444">
            <!-- <td>444</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="445">
            <!-- <td>445</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="446">
            <!-- <td>446</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="447">
            <!-- <td>447</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="448">
            <!-- <td>448</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="449">
            <!-- <td>449</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="450">
            <!-- <td>450</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="451">
            <!-- <td>451</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="SOC2">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="452">
            <!-- <td>452</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="453">
            <!-- <td>453</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="454">
            <!-- <td>454</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="455">
            <!-- <td>455</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="456">
            <!-- <td>456</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="457">
            <!-- <td>457</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="458">
            <!-- <td>458</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="459">
            <!-- <td>459</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="460">
            <!-- <td>460</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="461">
            <!-- <td>461</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="462">
            <!-- <td>462</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="463">
            <!-- <td>463</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="464">
            <!-- <td>464</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="465">
            <!-- <td>465</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="466">
            <!-- <td>466</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="467">
            <!-- <td>467</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="468">
            <!-- <td>468</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="469">
            <!-- <td>469</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="470">
            <!-- <td>470</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="471">
            <!-- <td>471</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="472">
            <!-- <td>472</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal has ( "*" ) and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="473">
            <!-- <td>473</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup </td>
          </tr>
          
          <tr num="474">
            <!-- <td>474</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              Config<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="475">
            <!-- <td>475</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="476">
            <!-- <td>476</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len ( ) > 0 </td>
          </tr>
          
          <tr num="477">
            <!-- <td>477</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="478">
            <!-- <td>478</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ id ] </td>
          </tr>
          
          <tr num="479">
            <!-- <td>479</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*" and FilterPattern like "\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="480">
            <!-- <td>480</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*" and FilterPattern like "\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="481">
            <!-- <td>481</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*" and FilterPattern like "\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*" and FilterPattern like "\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="482">
            <!-- <td>482</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="483">
            <!-- <td>483</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StartLogging\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*StopLogging\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="484">
            <!-- <td>484</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup.MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*" and FilterPattern like "\s*\(\$\.errorMessage\s*=\s*\"Failed authentication\"\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="485">
            <!-- <td>485</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableKey\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*ScheduleKeyDeletion\)\s*" ) and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="486">
            <!-- <td>486</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketAcl\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="487">
            <!-- <td>487</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*" and ( FilterPattern like "\s*\(\$\.eventName\s*=\s*StopConfigurationRecorder\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutDeliveryChannel\)\s*" or FilterPattern like "\s*\(\$\.eventName\s*=\s*PutConfigurationRecorder\)\s*") and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="488">
            <!-- <td>488</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="489">
            <!-- <td>489</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="490">
            <!-- <td>490</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="491">
            <!-- <td>491</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . MetricFilters with [ FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*" and FilterPattern like "\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] </td>
          </tr>
          
          <tr num="492">
            <!-- <td>492</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="493">
            <!-- <td>493</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="494">
            <!-- <td>494</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="495">
            <!-- <td>495</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
      &nbsp;
      <br><br>
      <br><br>
      <br><br>
      &nbsp;
    </div>
  </div>
  <script>

  // Sort
  const getCellValue = (tr, idx) => (idx == 0 ) ? tr.getAttribute("num") : ( tr.children[idx].innerText || tr.children[idx].textContent);
  const comparer = (idx, asc) => (a, b) => ((v1, v2) =>
      v1 !== '' && v2 !== '' && !isNaN(v1) && !isNaN(v2) ? v1 - v2 : v1.toString().localeCompare(v2)
      )(getCellValue(asc ? a : b, idx), getCellValue(asc ? b : a, idx));
  document.querySelectorAll('th').forEach(th => th.addEventListener('click', (() => {
      this.asc = !this.asc;
      const table = th.closest('table');
      Array.from(table.querySelectorAll('tr:nth-child(n+2)'))
          .sort(comparer(Array.from(th.parentNode.children).indexOf(th), this.asc))
          .forEach(tr => table.appendChild(tr) );
      $('th').removeClass('headerSortDown').removeClass('headerSortUp')
      if (this.asc) {
        $(th).addClass('headerSortUp')
      } else {
        $(th).addClass('headerSortDown')
      }
  })));

  // Search
  var $rows = $('table.rule_table tr[num]');
  $('#search').keyup(debounce(function() {

    var val = '^(?=.*\\b' + $.trim($(this).val()).split(/\s+/).join('\\b)(?=.*\\b') + ').*$',
      reg = RegExp(val, 'i'),
      text;

    $rows.show().filter(function() {
      text = $(this).text().replace(/\s+/g, ' ');
      return !reg.test(text);
    }).hide();
  }, 300));

  function debounce(func, wait, immediate) {
    var timeout;
    return function() {
      var context = this,
        args = arguments;
      var later = function() {
        timeout = null;
        if (!immediate) func.apply(context, args);
      };
      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) func.apply(context, args);
    };
  };

  // Nav Menu Show/Hide
  function hideRuleTables() {
    $('.rule_table').hide()
    $('.rule_key').removeClass('active')
  }

  function showRuleTable(name) {
    // c) show this table
    if (name == 'ALL') { 
        $('.rule_table').show()
    } else {
        $('.rule_table[data-profile-name="'+name+'"]').show()
    }
  }

  function activateRule(profile_name) {
    // a) hide all the tables with the class 'rule_table'
    hideRuleTables()
    // b) find the table in '.rule_table' with the same 'profile-name' data attribute
    showRuleTable(profile_name)
    if (name == "ALL") { 
        $('.rule_key').addClass('active')
    } else {
        $('.rule_key[data-profile-name="'+profile_name+'"]').addClass('active')
    }
  }

  function initListeners(){
    // 1. iterate over each Rule list item   
    $('.rule_key').each(function(i, obj) {
      var ruleKey = $(obj)
      var ruleName = ruleKey.data('profile-name')
      console.log('adding click listener to ' + ruleName);
      // 2. add a click listener
      ruleKey.click(function(event){
        console.log('received click event for ' + ruleName)
        activateRule(ruleName)
      })
    })
  }
  (function(){
    hideRuleTables()
    var firstRule = $($('.rule_key')[0]).data('profile-name')
    console.log('activating first rule: ', firstRule)
    activateRule(firstRule)
    initListeners()
  })()
  </script>
</body>
</html>