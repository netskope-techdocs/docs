<!DOCTYPE html>

<head>
    <title>Predefined Rules</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" integrity="sha512-w+rY1+DOo63621/y/1p3520iQnQ2p9on1sJ9/aSKh1M79aa7/Fibd34MnJjLpuEgDxKg/vQLAP887SDXUhcVxg==" crossorigin="anonymous">
    <link rel="stylesheet" href="predefined_rules.css">
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js" integrity="sha512-RgOCmhg9TZLNsMn33HnOg2++rNE1KVKJNmRvm36/PgHQumnQ/TCEGn5IHDnZU7DhFE1X9vhOzsH4XDpN3hDhLg==" crossorigin="anonymous"></script>
    <script src="https://semantic-ui.com/javascript/library/tablesort.js" integrity="sha512-lVeO88bta+CM1eV2gVGyeaGlDlMkuyC4x2HIxsRfJ1AWhtC5jmO3tydE1+NrYM0CgeW4tSgrV53/dGDxIhDqIA==" crossorigin="anonymous"></script>
</head>

<body>
<div class="ui divided grid ngl_doc">
    
    <div class="six wide mobile six wide tablet five wide computer column four wide large screen three wide widescreen leftInfo">
        
        <div class="ntsp_logo">
            <img src="logo.svg" alt="Netskope" />
            
            <div class="ui fluid selection dropdown">
                <i class="dropdown icon"></i>
                <div class="default text">Select Friend</div>
                <div class="menu">
                    <div class="item" data-value="aws">
                        <img class="ui mini avatar image" src="microsoft365.png">
                        Microsoft 365
                    </div>
                </div>
            </div>
            
        </div>
        
        <div class="ui divider"></div>
        
        <div class="rules">
            
            <div class="left heading">Predefined Rules</div>
            
            <div class="ui accordion">
                <div class="title">
                    <i class="dropdown icon"></i>
                    <a tableName="microsoft365">Microsoft 365 Predefined Rules</a>
                </div>
                <div class="content">

                        
                        
                        <div class="links">

                            <a tableName="AICPA-SOC-TSC-2017">AICPA-SOC-TSC-2017</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="CIS-MICROSOFT365-1-2-0">CIS-MICROSOFT365-1.2.0</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="CSA-CCM-4-0">CSA-CCM-4.0</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="GDPR-2016-679">GDPR-2016-679</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="HIPAA-1996">HIPAA-1996</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="ISO-27002-2013">ISO-27002-2013</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="NIST-800-53-4">NIST-800-53-4</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="NIST-CSF-1-1">NIST-CSF-1.1</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="PCI-DSS-3-0">PCI-DSS-3.0</a>
                        </div>
                        
                        

                </div>
            </div>
        </div>
    </div>
    
    <div class="ten wide mobile ten wide tablet eleven wide computer column twelve wide large screen thirteen wide widescreen rightInfo">
        <h1 class="ut_margin_left_40 ut_margin_top_32 ut_margin_bottom_0 main title"></h1>
        <div class="ui divider"></div>
        <div class="ui search ut_margin_left_40 ut_margin_top_18">
            <div class="ui left icon input">
                <input class="prompt" type="text" placeholder="Search">
                <i class="search icon"></i>
            </div>
        </div>
        <table class="ui table sortable ntsp_table microsoft365">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
                <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
                <td>PolicyAndCompliance, transportrule</td>
                <td class="rule"><span>microsoft365 PolicyAndCompliance should-have
  any transportrule as t with-attribute {
    t.state = &#34;Enabled&#34; and
    t.priority = 0 and
    t.senttoscope = &#34;NotInOrganization&#34; and
    t.fromscope = &#34;InOrganization&#34; and
    t.messagetypematches = &#34;AutoForward&#34; and
    t.rejectmessageenhancedstatuscode = &#34;5.7.1&#34;
  }</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
                <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
                <td>dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 dkimsigningconfig should-have enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
                <td>AntiSpamAntiMalware, dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 AntiSpamAntiMalware should-have dkimsigningconfig exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure Exchange Online outbound spam filter policies are properly configured</td>
                <td>Ensure the Exchange Online outbound spam filter policy is properly configured. Set your Exchange Online Spam Policies to copy emails and notify someone when a sender in your tenant has been blocked for sending spam emails.</td>
                <td>hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 hostedoutboundspamfilterpolicy should-have
  bccsuspiciousoutboundmail = true and
  notifyoutboundspam = true and
  enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Facebook contact synchronization is disabled</td>
                <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have facebookenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that LinkedIn contact synchronization is disabled</td>
                <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have linkedinenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an Outlook on the web mailbox policy exists</td>
                <td>Ensure an Outlook on the web mailbox policy exists.</td>
                <td>clientaccess, owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 clientaccess should-have owamailboxpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 passwords are not set to expire</td>
                <td>Ensure that Office 365 passwords are not set to expire.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PWAgePolicyNew&#34; and
    scoreinpercentage = 100 and
    isapplicable = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Advanced Threat Protection Safe Attachments policy is enabled</td>
                <td>Enabling the Advanced Threat Protection Safe Attachments policy extends malware protections to include routing all messages and attachments without a known malware signature to a special hypervisor environment. In that environment, a behavior analysis is performed using a variety of machine learning and analysis techniques to detect malicious intent.</td>
                <td>safeattachmentpolicy</td>
                <td class="rule"><span>microsoft365 safeattachmentpolicy should-have enable = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure self-service password reset is enabled</td>
                <td>Ensure self-service password reset is enabled.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SelfServicePasswordReset&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure SPF records are published for all Exchange domains</td>
                <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have spfrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a transport rule exists</td>
                <td>Ensure a transport rule exists.</td>
                <td>policyandcompliance, transportrule</td>
                <td class="rule"><span>microsoft365 policyandcompliance should-have transportrule exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        
        <table class="ui table sortable ntsp_table AICPA-SOC-TSC-2017">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
                <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
                <td>PolicyAndCompliance, transportrule</td>
                <td class="rule"><span>microsoft365 PolicyAndCompliance should-have
  any transportrule as t with-attribute {
    t.state = &#34;Enabled&#34; and
    t.priority = 0 and
    t.senttoscope = &#34;NotInOrganization&#34; and
    t.fromscope = &#34;InOrganization&#34; and
    t.messagetypematches = &#34;AutoForward&#34; and
    t.rejectmessageenhancedstatuscode = &#34;5.7.1&#34;
  }</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
                <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
                <td>dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 dkimsigningconfig should-have enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
                <td>AntiSpamAntiMalware, dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 AntiSpamAntiMalware should-have dkimsigningconfig exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 passwords are not set to expire</td>
                <td>Ensure that Office 365 passwords are not set to expire.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PWAgePolicyNew&#34; and
    scoreinpercentage = 100 and
    isapplicable = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure SPF records are published for all Exchange domains</td>
                <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have spfrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a transport rule exists</td>
                <td>Ensure a transport rule exists.</td>
                <td>policyandcompliance, transportrule</td>
                <td class="rule"><span>microsoft365 policyandcompliance should-have transportrule exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table CIS-MICROSOFT365-1-2-0">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
                <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
                <td>PolicyAndCompliance, transportrule</td>
                <td class="rule"><span>microsoft365 PolicyAndCompliance should-have
  any transportrule as t with-attribute {
    t.state = &#34;Enabled&#34; and
    t.priority = 0 and
    t.senttoscope = &#34;NotInOrganization&#34; and
    t.fromscope = &#34;InOrganization&#34; and
    t.messagetypematches = &#34;AutoForward&#34; and
    t.rejectmessageenhancedstatuscode = &#34;5.7.1&#34;
  }</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
                <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
                <td>dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 dkimsigningconfig should-have enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure Exchange Online outbound spam filter policies are properly configured</td>
                <td>Ensure the Exchange Online outbound spam filter policy is properly configured. Set your Exchange Online Spam Policies to copy emails and notify someone when a sender in your tenant has been blocked for sending spam emails.</td>
                <td>hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 hostedoutboundspamfilterpolicy should-have
  bccsuspiciousoutboundmail = true and
  notifyoutboundspam = true and
  enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Facebook contact synchronization is disabled</td>
                <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have facebookenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that LinkedIn contact synchronization is disabled</td>
                <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have linkedinenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 passwords are not set to expire</td>
                <td>Ensure that Office 365 passwords are not set to expire.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PWAgePolicyNew&#34; and
    scoreinpercentage = 100 and
    isapplicable = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Advanced Threat Protection Safe Attachments policy is enabled</td>
                <td>Enabling the Advanced Threat Protection Safe Attachments policy extends malware protections to include routing all messages and attachments without a known malware signature to a special hypervisor environment. In that environment, a behavior analysis is performed using a variety of machine learning and analysis techniques to detect malicious intent.</td>
                <td>safeattachmentpolicy</td>
                <td class="rule"><span>microsoft365 safeattachmentpolicy should-have enable = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure self-service password reset is enabled</td>
                <td>Ensure self-service password reset is enabled.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SelfServicePasswordReset&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure SPF records are published for all Exchange domains</td>
                <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have spfrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table CSA-CCM-4-0">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
                <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
                <td>PolicyAndCompliance, transportrule</td>
                <td class="rule"><span>microsoft365 PolicyAndCompliance should-have
  any transportrule as t with-attribute {
    t.state = &#34;Enabled&#34; and
    t.priority = 0 and
    t.senttoscope = &#34;NotInOrganization&#34; and
    t.fromscope = &#34;InOrganization&#34; and
    t.messagetypematches = &#34;AutoForward&#34; and
    t.rejectmessageenhancedstatuscode = &#34;5.7.1&#34;
  }</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
                <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
                <td>dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 dkimsigningconfig should-have enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
                <td>AntiSpamAntiMalware, dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 AntiSpamAntiMalware should-have dkimsigningconfig exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Facebook contact synchronization is disabled</td>
                <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have facebookenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that LinkedIn contact synchronization is disabled</td>
                <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have linkedinenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an Outlook on the web mailbox policy exists</td>
                <td>Ensure an Outlook on the web mailbox policy exists.</td>
                <td>clientaccess, owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 clientaccess should-have owamailboxpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 passwords are not set to expire</td>
                <td>Ensure that Office 365 passwords are not set to expire.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PWAgePolicyNew&#34; and
    scoreinpercentage = 100 and
    isapplicable = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure SPF records are published for all Exchange domains</td>
                <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have spfrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a transport rule exists</td>
                <td>Ensure a transport rule exists.</td>
                <td>policyandcompliance, transportrule</td>
                <td class="rule"><span>microsoft365 policyandcompliance should-have transportrule exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table GDPR-2016-679">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
                <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
                <td>PolicyAndCompliance, transportrule</td>
                <td class="rule"><span>microsoft365 PolicyAndCompliance should-have
  any transportrule as t with-attribute {
    t.state = &#34;Enabled&#34; and
    t.priority = 0 and
    t.senttoscope = &#34;NotInOrganization&#34; and
    t.fromscope = &#34;InOrganization&#34; and
    t.messagetypematches = &#34;AutoForward&#34; and
    t.rejectmessageenhancedstatuscode = &#34;5.7.1&#34;
  }</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
                <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
                <td>dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 dkimsigningconfig should-have enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
                <td>AntiSpamAntiMalware, dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 AntiSpamAntiMalware should-have dkimsigningconfig exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 passwords are not set to expire</td>
                <td>Ensure that Office 365 passwords are not set to expire.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PWAgePolicyNew&#34; and
    scoreinpercentage = 100 and
    isapplicable = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure SPF records are published for all Exchange domains</td>
                <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have spfrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a transport rule exists</td>
                <td>Ensure a transport rule exists.</td>
                <td>policyandcompliance, transportrule</td>
                <td class="rule"><span>microsoft365 policyandcompliance should-have transportrule exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table HIPAA-1996">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
                <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
                <td>PolicyAndCompliance, transportrule</td>
                <td class="rule"><span>microsoft365 PolicyAndCompliance should-have
  any transportrule as t with-attribute {
    t.state = &#34;Enabled&#34; and
    t.priority = 0 and
    t.senttoscope = &#34;NotInOrganization&#34; and
    t.fromscope = &#34;InOrganization&#34; and
    t.messagetypematches = &#34;AutoForward&#34; and
    t.rejectmessageenhancedstatuscode = &#34;5.7.1&#34;
  }</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Facebook contact synchronization is disabled</td>
                <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have facebookenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that LinkedIn contact synchronization is disabled</td>
                <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have linkedinenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an Outlook on the web mailbox policy exists</td>
                <td>Ensure an Outlook on the web mailbox policy exists.</td>
                <td>clientaccess, owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 clientaccess should-have owamailboxpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 passwords are not set to expire</td>
                <td>Ensure that Office 365 passwords are not set to expire.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PWAgePolicyNew&#34; and
    scoreinpercentage = 100 and
    isapplicable = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure self-service password reset is enabled</td>
                <td>Ensure self-service password reset is enabled.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SelfServicePasswordReset&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a transport rule exists</td>
                <td>Ensure a transport rule exists.</td>
                <td>policyandcompliance, transportrule</td>
                <td class="rule"><span>microsoft365 policyandcompliance should-have transportrule exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table ISO-27002-2013">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
                <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
                <td>dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 dkimsigningconfig should-have enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
                <td>AntiSpamAntiMalware, dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 AntiSpamAntiMalware should-have dkimsigningconfig exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure SPF records are published for all Exchange domains</td>
                <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have spfrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table NIST-800-53-4">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
                <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
                <td>PolicyAndCompliance, transportrule</td>
                <td class="rule"><span>microsoft365 PolicyAndCompliance should-have
  any transportrule as t with-attribute {
    t.state = &#34;Enabled&#34; and
    t.priority = 0 and
    t.senttoscope = &#34;NotInOrganization&#34; and
    t.fromscope = &#34;InOrganization&#34; and
    t.messagetypematches = &#34;AutoForward&#34; and
    t.rejectmessageenhancedstatuscode = &#34;5.7.1&#34;
  }</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
                <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
                <td>dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 dkimsigningconfig should-have enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
                <td>AntiSpamAntiMalware, dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 AntiSpamAntiMalware should-have dkimsigningconfig exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure Exchange Online outbound spam filter policies are properly configured</td>
                <td>Ensure the Exchange Online outbound spam filter policy is properly configured. Set your Exchange Online Spam Policies to copy emails and notify someone when a sender in your tenant has been blocked for sending spam emails.</td>
                <td>hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 hostedoutboundspamfilterpolicy should-have
  bccsuspiciousoutboundmail = true and
  notifyoutboundspam = true and
  enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Facebook contact synchronization is disabled</td>
                <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have facebookenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that LinkedIn contact synchronization is disabled</td>
                <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have linkedinenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an Outlook on the web mailbox policy exists</td>
                <td>Ensure an Outlook on the web mailbox policy exists.</td>
                <td>clientaccess, owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 clientaccess should-have owamailboxpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 passwords are not set to expire</td>
                <td>Ensure that Office 365 passwords are not set to expire.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PWAgePolicyNew&#34; and
    scoreinpercentage = 100 and
    isapplicable = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure SPF records are published for all Exchange domains</td>
                <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have spfrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a transport rule exists</td>
                <td>Ensure a transport rule exists.</td>
                <td>policyandcompliance, transportrule</td>
                <td class="rule"><span>microsoft365 policyandcompliance should-have transportrule exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table NIST-CSF-1-1">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
                <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
                <td>PolicyAndCompliance, transportrule</td>
                <td class="rule"><span>microsoft365 PolicyAndCompliance should-have
  any transportrule as t with-attribute {
    t.state = &#34;Enabled&#34; and
    t.priority = 0 and
    t.senttoscope = &#34;NotInOrganization&#34; and
    t.fromscope = &#34;InOrganization&#34; and
    t.messagetypematches = &#34;AutoForward&#34; and
    t.rejectmessageenhancedstatuscode = &#34;5.7.1&#34;
  }</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure expiration time for external sharing links is set</td>
                <td>Restrict the length of time that anonymous access links are valid.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have requireanonymouslinksexpireindays &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Facebook contact synchronization is disabled</td>
                <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have facebookenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that LinkedIn contact synchronization is disabled</td>
                <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have linkedinenabled = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not forward email to external domains</td>
                <td>Ensure mail transport rules do not forward email to external domains.</td>
                <td>exchange</td>
                <td class="rule"><span>microsoft365 exchange should-not-have anymailtransportruleredirectmessagetoexternaldomain = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mail transport rules do not whitelist specific domains</td>
                <td>Ensure mail transport rules do not whitelist specific domains.</td>
                <td>transportrule</td>
                <td class="rule"><span>microsoft365 transportrule should-not-have setscl = -1 and len(senderdomainis) &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an Outlook on the web mailbox policy exists</td>
                <td>Ensure an Outlook on the web mailbox policy exists.</td>
                <td>clientaccess, owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 clientaccess should-have owamailboxpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 passwords are not set to expire</td>
                <td>Ensure that Office 365 passwords are not set to expire.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PWAgePolicyNew&#34; and
    scoreinpercentage = 100 and
    isapplicable = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a transport rule exists</td>
                <td>Ensure a transport rule exists.</td>
                <td>policyandcompliance, transportrule</td>
                <td class="rule"><span>microsoft365 policyandcompliance should-have transportrule exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table PCI-DSS-3-0">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>All users should be registered and signed up for MFA</td>
                <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;MFARegistrationV2&#34;
    and scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure at least one anti-phishing policy exists</td>
                <td>Ensure that at least one anti-phishing policy exists.</td>
                <td>defenderforoffice365, antiphishpolicy</td>
                <td class="rule"><span>microsoft365 defenderforoffice365 should-have antiphishpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure an authentication policy exists</td>
                <td>Ensure an authentication policy exists.</td>
                <td>organization, authenticationpolicy</td>
                <td class="rule"><span>microsoft365 organization should-have authenticationpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure automatic forwarding options are disabled</td>
                <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
                <td>remotedomain</td>
                <td class="rule"><span>microsoft365 remotedomain should-have autoforwardenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection sign-in risk policies</td>
                <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;SigninRiskPolicy&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Azure AD Identity Protection user risk policies</td>
                <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
 controlscores with-any-element [
   controlname = &#34;UserRiskPolicy&#34; and
   scoreinpercentage = 100
 ]</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure basic authentication for Exchange Online is disabled</td>
                <td>Ensure basic authentication for Exchange Online is disabled.</td>
                <td>authenticationpolicy</td>
                <td class="rule"><span>microsoft365 authenticationpolicy should-have 
  allowbasicauthactivesync = false and
  allowbasicauthautodiscover = false and
  allowbasicauthimap = false and
  allowbasicauthmapi = false and
  allowbasicauthofflineaddressbook = false and
  allowbasicauthoutlookservice = false and
  allowbasicauthpop = false and
  allowbasicauthpowershell = false and
  allowbasicauthreportingwebservices = false and
  allowbasicauthrest = false and
  allowbasicauthrpc = false and
  allowbasicauthsmtp = false and
  allowbasicauthwebservices = false</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Block OneDrive for Business sync from unmanaged devices</td>
                <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have isunmanagedsyncclientfortenantrestricted = true 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that sharing full calendar details with external users is disabled</td>
                <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
                <td>sharingpolicy</td>
                <td class="rule"><span>microsoft365 sharingpolicy should-have
  sharingenabled = false or
  domains with-element [
    sharingalloweddetails = &#34;ContactsSharing&#34;
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
                <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
                <td>dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 dkimsigningconfig should-have enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
                <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
                <td>AntiSpamAntiMalware, dkimsigningconfig</td>
                <td class="rule"><span>microsoft365 AntiSpamAntiMalware should-have dkimsigningconfig exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure DMARC Records for all Exchange Online domains are published</td>
                <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have dmarcrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Do not allow users to grant consent to unmanaged applications</td>
                <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;IntegratedApps&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
                <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have sharingdomainrestrictionmode != 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure audit log search is enabled</td>
                <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
                <td>adminauditlogconfig</td>
                <td class="rule"><span>microsoft365 adminauditlogconfig should-have
  adminauditlogenabled = true and
  unifiedauditlogingestionenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure the Common Attachment Types Filter is enabled</td>
                <td>Ensure the Common Attachment Types Filter is enabled.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enablefilefilter = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mailbox auditing for all users is enabled</td>
                <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have usermailboxauditenabled = true and nonusermailboxauditenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure Exchange Online outbound spam filter policies are properly configured</td>
                <td>Ensure the Exchange Online outbound spam filter policy is properly configured. Set your Exchange Online Spam Policies to copy emails and notify someone when a sender in your tenant has been blocked for sending spam emails.</td>
                <td>hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 hostedoutboundspamfilterpolicy should-have
  bccsuspiciousoutboundmail = true and
  notifyoutboundspam = true and
  enabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
                <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have preventexternalusersfromresharing = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>Ensure a hosted outbound spam filter policy exists.</td>
                <td>antispamantimalware, hostedoutboundspamfilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have hostedoutboundspamfilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure MailTips are enabled for end users</td>
                <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have
  mailtipsalltipsenabled = true and
  mailtipsexternalrecipientstipsenabled = true and
  mailtipsgroupmetricsenabled = true and
  mailtipslargeaudiencethreshold &gt; 0
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a malware filter policy exists</td>
                <td>Ensure a malware filter policy exists.</td>
                <td>antispamantimalware, malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 antispamantimalware should-have malwarefilterpolicy exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for Exchange Online is enabled</td>
                <td>Ensure modern authentication for Exchange Online is enabled.</td>
                <td>organizationconfig</td>
                <td class="rule"><span>microsoft365 organizationconfig should-have oauth2clientprofileenabled = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Notify the administrator when internal users send malware</td>
                <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
                <td>malwarefilterpolicy</td>
                <td class="rule"><span>microsoft365 malwarefilterpolicy should-have enableinternalsenderadminnotifications = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
                <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization&#39;s security team.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have disallowinfectedfiledownload = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
                <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
                <td>owamailboxpolicy</td>
                <td class="rule"><span>microsoft365 owamailboxpolicy should-have additionalstorageprovidersavailable = false
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
                <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;PasswordHashSync&#34; and
    on = true
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure modern authentication for SharePoint applications is required</td>
                <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
                <td>sharepointtenant</td>
                <td class="rule"><span>microsoft365 sharepointtenant should-have legacyauthprotocolsenabled = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure SPF records are published for all Exchange domains</td>
                <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
                <td>accepteddomain</td>
                <td class="rule"><span>microsoft365 accepteddomain should-have spfrecordpublished = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure a transport rule exists</td>
                <td>Ensure a transport rule exists.</td>
                <td>policyandcompliance, transportrule</td>
                <td class="rule"><span>microsoft365 policyandcompliance should-have transportrule exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Use limited administrative roles</td>
                <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
                <td>securescore</td>
                <td class="rule"><span>microsoft365 securescore should-have
  controlscores with-any-element [
    controlname = &#34;RoleOverlap&#34; and
    scoreinpercentage = 100
  ]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot install Outlook add-ins</td>
                <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users&#39; ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
                <td>roleassignmentpolicy</td>
                <td class="rule"><span>microsoft365 roleassignmentpolicy should-not-have
    assignedroles with-any-element [&#34;My Custom Apps&#34;] or
    assignedroles with-any-element [&#34;My Marketplace Apps&#34;] or
    assignedroles with-any-element [&#34;My ReadWriteMailbox Apps&#34;]
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        
    </div>
</div>


<script>
    function copyToClipboard(element) {
        var $temp = $("<input>");
        $("body").append($temp);
        $temp.val($(element).text()).select();
        document.execCommand("copy");
        $temp.remove();
    };
    function removeRow(searchText) {
        $("table.active tr").not(".fixed.header").each(
            function () {
                var tableRowText = $(this)[0].innerText.toLowerCase();
                console.log(tableRowText)
                console.log(searchText);
                if(tableRowText.indexOf(searchText) != -1){
                    $(this).css({"display": "table-row"});
                }
                else{
                    $(this).css({"display": "none"});
                }
            });
    };

    $(document).ready(function () {
        $(".sortable.table").tablesort();

        $("td.rule").hover(
            function () {
                $(this).find("div.tooltip").attr("data-tooltip", "Click to copy");
                $(this).find("div.tooltip").css({ "display": "inline-block" });
                $(this).addClass("current");
            },
            function () {
                $(this).find("div.tooltip").css({ "display": "none" });
                $(this).removeClass("current");
            });

        $("td.rule div.tooltip").click(
            function () {
                $(this).attr("data-tooltip", "Copied");
                copyToClipboard("td.rule.current span");
            }
        );

        $(".ntsp_logo .ui.dropdown")
            .dropdown("set selected", "aws");

        $(".ntsp_logo .ui.buttons .button")
            .click(
                function () {
                    $(".ntsp_logo .ui.buttons .button").removeClass("active");
                    $(this).addClass("active");
                }
            );

        $('.ui.accordion').accordion({
            exclusive: false,
            active: 1
        });

        $("a").click(
            function () {
                $("a").each(function () {
                    $(this).removeClass("active");
                });
                $(this).addClass("active");
                $(".ntsp_table.table").css("display", "none");
                $(".ntsp_table.table").removeClass("active");

                $("." + $(this).attr("tableName")).css("display", "table");
                $("." + $(this).attr("tableName")).addClass("active");
                $(".main.title").text("Predefined Rules - " + $(this)[0].innerText);
                removeRow($(".input > .prompt")[0].value.toLowerCase());
            }
        );
        
        $(".accordion .title").first().trigger("click");
        
        $('.ngl_doc .ui.accordion .dropdown.icon~a').click(function (e) {
            e.preventDefault();
            e.stopPropagation();
        });
        $(".accordion .title>a").first().trigger("click");

        
        $(".input > .prompt").keyup(function () {
            removeRow($(this)[0].value.toLowerCase());
        });
    });
</script>
</body>

</html>